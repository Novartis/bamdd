<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Björn Holzhauer - bjoern.holzhauer@novartis.com">
<meta name="author" content="Sebastian Weber - sebastian.weber@novartis.com">

<title>8&nbsp; Probability of success from a single arm trial – Applied Modelling in Drug Development</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../src/02b_dose_finding.html" rel="next">
<link href="../src/02k_nuisance.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b2070c71598b148a05ee0727b4df650f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="../resources/mathjax/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../bamdd.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../src/02_case_studies.html">Case studies</a></li><li class="breadcrumb-item"><a href="../src/02l_single_arm_pos.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability of success from a single arm trial</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../bamdd_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Applied Modelling in Drug Development</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Novartis/bamdd/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01a_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01b_basic_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01c_priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model setup &amp; priors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../src/02_case_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case studies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02a_meta_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Use of historical control data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02ab_meta_analysis_trtdiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis to estimate treatment effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02ac_meta_analysis_strata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Use of historical control data with stratification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02k_nuisance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nuisance parameters, expected power and the “significance threshold”</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02l_single_arm_pos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability of success from a single arm trial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02b_dose_finding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dose finding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02c_dose_escalation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Oncology dose escalation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02cb_tte_dose_escalation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time-to-event modelling in Oncology dose escalation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02e_multiple_imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiple imputation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02g_longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Longitudinal data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02h_mmrm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Mixed effects Model for Repeated Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02i_time_to_event.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Time-to-event data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02j_network_meta_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Network meta-analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02m_proportion_difference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Difference in proportions from a fitted logistic regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/03a_stan_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Exposing stan code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/03b_parallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Parallel computation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">8.1</span> Background</a>
  <ul class="collapse">
  <li><a href="#probability-of-success" id="toc-probability-of-success" class="nav-link" data-scroll-target="#probability-of-success"><span class="header-section-number">8.1.1</span> Probability of success</a></li>
  <li><a href="#assurance" id="toc-assurance" class="nav-link" data-scroll-target="#assurance"><span class="header-section-number">8.1.2</span> Assurance</a></li>
  <li><a href="#background-of-the-hypothetical-example" id="toc-background-of-the-hypothetical-example" class="nav-link" data-scroll-target="#background-of-the-hypothetical-example"><span class="header-section-number">8.1.3</span> Background of the hypothetical example</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">8.2</span> Data</a></li>
  <li><a href="#model-description" id="toc-model-description" class="nav-link" data-scroll-target="#model-description"><span class="header-section-number">8.3</span> Model description</a>
  <ul class="collapse">
  <li><a href="#idea" id="toc-idea" class="nav-link" data-scroll-target="#idea"><span class="header-section-number">8.3.1</span> Idea</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><span class="header-section-number">8.3.2</span> Model specification</a></li>
  <li><a href="#specification-of-prior-distributions" id="toc-specification-of-prior-distributions" class="nav-link" data-scroll-target="#specification-of-prior-distributions"><span class="header-section-number">8.3.3</span> Specification of prior distributions</a></li>
  <li><a href="#model-fitting-and-predictions" id="toc-model-fitting-and-predictions" class="nav-link" data-scroll-target="#model-fitting-and-predictions"><span class="header-section-number">8.3.4</span> Model fitting and predictions</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">8.4</span> Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8.5</span> Conclusion</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">8.6</span> Exercises</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Novartis/bamdd/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../src/02_case_studies.html">Case studies</a></li><li class="breadcrumb-item"><a href="../src/02l_single_arm_pos.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability of success from a single arm trial</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-pos" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability of success from a single arm trial</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Björn Holzhauer - <a href="mailto:bjoern.holzhauer@novartis.com" class="email">bjoern.holzhauer@novartis.com</a> </p>
             <p>Sebastian Weber - <a href="mailto:sebastian.weber@novartis.com" class="email">sebastian.weber@novartis.com</a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>This case study:</p>
<ul>
<li>discusses probability of success for drug development projects (and introduces the related concept of assurance) when the available data come from a single arm trial without a control group</li>
<li>shows how to specify mixture priors with <code>brms</code> using helper functions from the <code>RBesT</code> package such as <code>RBesT::mixnorm()</code> and <code>RBesT::mixstanvar()</code> (used with the <code>stanvars</code> option of <code>brms::brm()</code></li>
<li>gives examples of how to choose prior distributions including how to obtain useful visualizations and other helpful information using the <code>ggdist</code> and <code>distributional</code> packages</li>
</ul>
<p>To run the R code of this section please ensure to load these libraries first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RBesT)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co"># Great ggplo2 extension package for visualizing distributions/priors/posteriors</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional) <span class="co"># Defines distribution (that we then use in via ggdist)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># instruct brms to use cmdstanr as backend and cache all Stan binaries</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>, <span class="at">cmdstanr_write_stan_file_dir=</span><span class="fu">here</span>(<span class="st">"_brms-cache"</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create cache directory if not yet available</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">"_brms-cache"</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">678571</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># default controls args passed to Stan</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>control_args <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">adapt_delta=</span><span class="fl">0.99</span>, <span class="at">step_size=</span><span class="fl">0.1</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># nice common ggplot2 theme</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="background" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="background"><span class="header-section-number">8.1</span> Background</h2>
<section id="probability-of-success" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="probability-of-success"><span class="header-section-number">8.1.1</span> Probability of success</h3>
<p>For pharmaceutical companies it is important to realistically assess the probability of success (PoS) for drug development projects. Together with other information and considerations (e.g.&nbsp;costs of trials, projected timelines, unmet need for new therapies for an indication, competitive landscape, …) this allows for informed decision making about things such as which projects to pursue at all and how much at-risk investment to make into each of them.</p>
<p>There are a number of ways to define success for PoS calculations, but <a href="https://doi.org/10.1002/pst.2179">at Novartis the definition of success</a> is to get approval meeting a target product profile (TPP). It is assumed that if the drug is approved with a label as good or better than the TPP targets, it will meet an important unmet need for patients, be successful on the market and the sales forecasts (obtained assuming this TPP) would be achieved. <a href="https://doi.org/10.1002/pst.2179">The Novartis PoS framework</a> combines industry benchmark information with data on a drug and team assessments of other risks. This is most easily done when we have directly relevant data, e.g.&nbsp;with a Phase 2 study that is very similar (in terms of population, endpoint, duration and treatment groups) to the planned Phase 3 trial(s). On the other hand, this is harder based on a single arm study that differs from Phase 3 (or worse without Phase 2 data).</p>
</section>
<section id="assurance" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="assurance"><span class="header-section-number">8.1.2</span> Assurance</h3>
<p><a href="https://doi.org/10.1002/pst.175">Assurance</a> is a <a href="https://doi.org/10.1002/pst.1856">popular</a> related concept to PoS. It describes the probability of a successful trial.</p>
</section>
<section id="background-of-the-hypothetical-example" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="background-of-the-hypothetical-example"><span class="header-section-number">8.1.3</span> Background of the hypothetical example</h3>
<p>A hypothetical drug called NVS101 is already approved as a treatment for some systemic diseases. In a single arm trial in patients with a different systemic disease that leads to anemia, most patients that received NVS101 for 12 weeks were able to achieve an acceptable red blood cell count without needing a blood transfusion. We are now considering to start a pivotal randomized placebo controlled Phase III trial, where the primary endpoint would be having an acceptable red blood cell count without needing a blood transfusion over a 1-year period.</p>
<p>We wish to assess the PoS of such a pivotal study. I.e. the probability to get approval meeting the TPP of an odds ratio of 8.5 (given an assumed placebo responder rate of 15% this corresponds to a targeted 60% for the drug).</p>
</section>
</section>
<section id="data" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="data"><span class="header-section-number">8.2</span> Data</h2>
<p>The <a href="https://doi.org/10.1002/pst.2179">Novartis PoS framework</a> provides us with a prior for the log-odds ratio of response on drug compared with a placebo given a number of project features. For a drug that is past its first approval (a so-called “life-cycle management” situation) such as NVS101, a TPP target of a odds ratio of 8.5 (given an assumed placebo responder rate of 15% this corresponds to a targeted 60% for the drug), we obtain a mixture prior for the log-odds ratio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mixture_prior <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">mixnorm</span>(<span class="st">"Null component"</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.08289228</span>, <span class="dv">0</span>, <span class="fl">0.91992526</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"TPP component"</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.91710772</span>, <span class="fl">2.14006616</span>, <span class="fl">0.91992526</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mixture_prior[,] <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Property =</span> <span class="fu">c</span>(<span class="st">"Mixture weight"</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Mean of mixture component"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SD of mixture component"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Property) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns=</span><span class="fu">c</span>(<span class="st">"Null component"</span>, <span class="st">"TPP component"</span>), </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">label=</span><span class="st">"Components of the mixture prior"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="lkudzuwlkr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lkudzuwlkr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lkudzuwlkr thead, #lkudzuwlkr tbody, #lkudzuwlkr tfoot, #lkudzuwlkr tr, #lkudzuwlkr td, #lkudzuwlkr th {
  border-style: none;
}

#lkudzuwlkr p {
  margin: 0;
  padding: 0;
}

#lkudzuwlkr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lkudzuwlkr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lkudzuwlkr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lkudzuwlkr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lkudzuwlkr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkudzuwlkr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkudzuwlkr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkudzuwlkr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lkudzuwlkr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lkudzuwlkr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lkudzuwlkr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lkudzuwlkr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lkudzuwlkr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lkudzuwlkr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lkudzuwlkr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lkudzuwlkr .gt_from_md > :first-child {
  margin-top: 0;
}

#lkudzuwlkr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lkudzuwlkr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lkudzuwlkr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lkudzuwlkr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lkudzuwlkr .gt_row_group_first td {
  border-top-width: 2px;
}

#lkudzuwlkr .gt_row_group_first th {
  border-top-width: 2px;
}

#lkudzuwlkr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkudzuwlkr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lkudzuwlkr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lkudzuwlkr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkudzuwlkr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkudzuwlkr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lkudzuwlkr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lkudzuwlkr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lkudzuwlkr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkudzuwlkr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkudzuwlkr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkudzuwlkr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkudzuwlkr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkudzuwlkr .gt_left {
  text-align: left;
}

#lkudzuwlkr .gt_center {
  text-align: center;
}

#lkudzuwlkr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lkudzuwlkr .gt_font_normal {
  font-weight: normal;
}

#lkudzuwlkr .gt_font_bold {
  font-weight: bold;
}

#lkudzuwlkr .gt_font_italic {
  font-style: italic;
}

#lkudzuwlkr .gt_super {
  font-size: 65%;
}

#lkudzuwlkr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lkudzuwlkr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lkudzuwlkr .gt_indent_1 {
  text-indent: 5px;
}

#lkudzuwlkr .gt_indent_2 {
  text-indent: 10px;
}

#lkudzuwlkr .gt_indent_3 {
  text-indent: 15px;
}

#lkudzuwlkr .gt_indent_4 {
  text-indent: 20px;
}

#lkudzuwlkr .gt_indent_5 {
  text-indent: 25px;
}

#lkudzuwlkr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lkudzuwlkr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Property" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Property</th>
<th colspan="2" id="Components of the mixture prior" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Components of the mixture prior
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Null-component" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Null component</th>
<th id="TPP-component" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">TPP component</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Property">Mixture weight</td>
<td class="gt_row gt_right" headers="Null component">0.083</td>
<td class="gt_row gt_right" headers="TPP component">0.917</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Property">Mean of mixture component</td>
<td class="gt_row gt_right" headers="Null component">0.000</td>
<td class="gt_row gt_right" headers="TPP component">2.140</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Property">SD of mixture component</td>
<td class="gt_row gt_right" headers="Null component">0.920</td>
<td class="gt_row gt_right" headers="TPP component">0.920</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Novartis associates can obtain this using the Novartis internal <code>pos</code> R package using the <code>pos::benchmark_prior()</code> function and applying the <code>pos::as_rbest_mixnorm()</code> function to the result, which converts the prior to a mixture prior object in the <code>RBesT</code> package.</p>
<p>When we plot this mixture distribution, it looks as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mixture_prior) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log-odds ratio for response</span><span class="sc">\n</span><span class="st">on drug compared with placebo"</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/plot_mixture-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The hypothetical single arm trial data for NVS101 are given below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nvs101_singlearm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"NVS101 Proof of Concept"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">treatment=</span><span class="st">"NVS101"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">trial duration</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"12 weeks"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">responders=</span><span class="dv">8</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patients=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion=</span>responders<span class="sc">/</span>patients,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">long_study=</span><span class="dv">0</span>L)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>nvs101_singlearm <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="hfqughyqwh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hfqughyqwh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hfqughyqwh thead, #hfqughyqwh tbody, #hfqughyqwh tfoot, #hfqughyqwh tr, #hfqughyqwh td, #hfqughyqwh th {
  border-style: none;
}

#hfqughyqwh p {
  margin: 0;
  padding: 0;
}

#hfqughyqwh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hfqughyqwh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hfqughyqwh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hfqughyqwh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hfqughyqwh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hfqughyqwh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfqughyqwh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hfqughyqwh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hfqughyqwh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hfqughyqwh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hfqughyqwh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hfqughyqwh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hfqughyqwh .gt_spanner_row {
  border-bottom-style: hidden;
}

#hfqughyqwh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hfqughyqwh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hfqughyqwh .gt_from_md > :first-child {
  margin-top: 0;
}

#hfqughyqwh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hfqughyqwh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hfqughyqwh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hfqughyqwh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hfqughyqwh .gt_row_group_first td {
  border-top-width: 2px;
}

#hfqughyqwh .gt_row_group_first th {
  border-top-width: 2px;
}

#hfqughyqwh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfqughyqwh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hfqughyqwh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hfqughyqwh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfqughyqwh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfqughyqwh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hfqughyqwh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hfqughyqwh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hfqughyqwh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfqughyqwh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hfqughyqwh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfqughyqwh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hfqughyqwh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfqughyqwh .gt_left {
  text-align: left;
}

#hfqughyqwh .gt_center {
  text-align: center;
}

#hfqughyqwh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hfqughyqwh .gt_font_normal {
  font-weight: normal;
}

#hfqughyqwh .gt_font_bold {
  font-weight: bold;
}

#hfqughyqwh .gt_font_italic {
  font-style: italic;
}

#hfqughyqwh .gt_super {
  font-size: 65%;
}

#hfqughyqwh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hfqughyqwh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hfqughyqwh .gt_indent_1 {
  text-indent: 5px;
}

#hfqughyqwh .gt_indent_2 {
  text-indent: 10px;
}

#hfqughyqwh .gt_indent_3 {
  text-indent: 15px;
}

#hfqughyqwh .gt_indent_4 {
  text-indent: 20px;
}

#hfqughyqwh .gt_indent_5 {
  text-indent: 25px;
}

#hfqughyqwh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hfqughyqwh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="trial" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial</th>
<th id="treatment" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">treatment</th>
<th id="trial-duration" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial duration</th>
<th id="responders" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">responders</th>
<th id="patients" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">patients</th>
<th id="proportion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">proportion</th>
<th id="long_study" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">long_study</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="trial">NVS101 Proof of Concept</td>
<td class="gt_row gt_left" headers="treatment">NVS101</td>
<td class="gt_row gt_left" headers="trial duration">12 weeks</td>
<td class="gt_row gt_right" headers="responders">8</td>
<td class="gt_row gt_right" headers="patients">10</td>
<td class="gt_row gt_right" headers="proportion">0.80</td>
<td class="gt_row gt_right" headers="long_study">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let us assume that there has been a placebo controlled Phase 3 trial in this indication for another drug EG-999, but no other trials with the same endpoint. The data for the hypothetical other drug are given below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eg999_ph3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"EG-999 Phase 3"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">trial duration</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"52 weeks"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">treatment=</span><span class="fu">c</span>(<span class="st">"EG-999"</span>, <span class="st">"placebo"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">responders=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">2</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">patients=</span><span class="fu">c</span>(<span class="dv">26</span>, <span class="dv">13</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion=</span>responders<span class="sc">/</span>patients,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">long_study=</span><span class="dv">1</span>L)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>eg999_ph3 <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="uuecfrhdxk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uuecfrhdxk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uuecfrhdxk thead, #uuecfrhdxk tbody, #uuecfrhdxk tfoot, #uuecfrhdxk tr, #uuecfrhdxk td, #uuecfrhdxk th {
  border-style: none;
}

#uuecfrhdxk p {
  margin: 0;
  padding: 0;
}

#uuecfrhdxk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uuecfrhdxk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uuecfrhdxk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uuecfrhdxk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uuecfrhdxk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uuecfrhdxk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uuecfrhdxk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uuecfrhdxk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uuecfrhdxk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uuecfrhdxk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uuecfrhdxk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uuecfrhdxk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uuecfrhdxk .gt_spanner_row {
  border-bottom-style: hidden;
}

#uuecfrhdxk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uuecfrhdxk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uuecfrhdxk .gt_from_md > :first-child {
  margin-top: 0;
}

#uuecfrhdxk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uuecfrhdxk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uuecfrhdxk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uuecfrhdxk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uuecfrhdxk .gt_row_group_first td {
  border-top-width: 2px;
}

#uuecfrhdxk .gt_row_group_first th {
  border-top-width: 2px;
}

#uuecfrhdxk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uuecfrhdxk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uuecfrhdxk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uuecfrhdxk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uuecfrhdxk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uuecfrhdxk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uuecfrhdxk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uuecfrhdxk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uuecfrhdxk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uuecfrhdxk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uuecfrhdxk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uuecfrhdxk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uuecfrhdxk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uuecfrhdxk .gt_left {
  text-align: left;
}

#uuecfrhdxk .gt_center {
  text-align: center;
}

#uuecfrhdxk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uuecfrhdxk .gt_font_normal {
  font-weight: normal;
}

#uuecfrhdxk .gt_font_bold {
  font-weight: bold;
}

#uuecfrhdxk .gt_font_italic {
  font-style: italic;
}

#uuecfrhdxk .gt_super {
  font-size: 65%;
}

#uuecfrhdxk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uuecfrhdxk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uuecfrhdxk .gt_indent_1 {
  text-indent: 5px;
}

#uuecfrhdxk .gt_indent_2 {
  text-indent: 10px;
}

#uuecfrhdxk .gt_indent_3 {
  text-indent: 15px;
}

#uuecfrhdxk .gt_indent_4 {
  text-indent: 20px;
}

#uuecfrhdxk .gt_indent_5 {
  text-indent: 25px;
}

#uuecfrhdxk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uuecfrhdxk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="trial" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial</th>
<th id="trial-duration" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial duration</th>
<th id="treatment" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">treatment</th>
<th id="responders" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">responders</th>
<th id="patients" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">patients</th>
<th id="proportion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">proportion</th>
<th id="long_study" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">long_study</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="trial">EG-999 Phase 3</td>
<td class="gt_row gt_left" headers="trial duration">52 weeks</td>
<td class="gt_row gt_left" headers="treatment">EG-999</td>
<td class="gt_row gt_right" headers="responders">19</td>
<td class="gt_row gt_right" headers="patients">26</td>
<td class="gt_row gt_right" headers="proportion">0.73</td>
<td class="gt_row gt_right" headers="long_study">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="trial">EG-999 Phase 3</td>
<td class="gt_row gt_left" headers="trial duration">52 weeks</td>
<td class="gt_row gt_left" headers="treatment">placebo</td>
<td class="gt_row gt_right" headers="responders">2</td>
<td class="gt_row gt_right" headers="patients">13</td>
<td class="gt_row gt_right" headers="proportion">0.15</td>
<td class="gt_row gt_right" headers="long_study">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Superficially, this extra information makes the NVS101 single arm data look promising, because the responder proportion on NVS101 is much higher than on placebo and even higher than on the EG-999 active treatment group. However, this is a non-randomized across trial comparison and it is not immediately clear how to quantify the strength of evidence for the efficacy of NVS101.</p>
<p>Since we are not really interested in EG-999, the data we will use from the EG-999 Phase 3 trial will only be the placebo group. Thus, our the data we will use are the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>our_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(nvs101_singlearm,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                      eg999_ph3 <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment <span class="sc">!=</span> <span class="st">"EG-999"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment=</span><span class="fu">factor</span>(treatment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"placebo"</span>, <span class="st">"NVS101"</span>)))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>our_data <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="dqdkumbsny" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dqdkumbsny table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dqdkumbsny thead, #dqdkumbsny tbody, #dqdkumbsny tfoot, #dqdkumbsny tr, #dqdkumbsny td, #dqdkumbsny th {
  border-style: none;
}

#dqdkumbsny p {
  margin: 0;
  padding: 0;
}

#dqdkumbsny .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dqdkumbsny .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dqdkumbsny .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dqdkumbsny .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dqdkumbsny .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dqdkumbsny .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dqdkumbsny .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dqdkumbsny .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dqdkumbsny .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dqdkumbsny .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dqdkumbsny .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dqdkumbsny .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dqdkumbsny .gt_spanner_row {
  border-bottom-style: hidden;
}

#dqdkumbsny .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dqdkumbsny .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dqdkumbsny .gt_from_md > :first-child {
  margin-top: 0;
}

#dqdkumbsny .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dqdkumbsny .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dqdkumbsny .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dqdkumbsny .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dqdkumbsny .gt_row_group_first td {
  border-top-width: 2px;
}

#dqdkumbsny .gt_row_group_first th {
  border-top-width: 2px;
}

#dqdkumbsny .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dqdkumbsny .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dqdkumbsny .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dqdkumbsny .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dqdkumbsny .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dqdkumbsny .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dqdkumbsny .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dqdkumbsny .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dqdkumbsny .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dqdkumbsny .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dqdkumbsny .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dqdkumbsny .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dqdkumbsny .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dqdkumbsny .gt_left {
  text-align: left;
}

#dqdkumbsny .gt_center {
  text-align: center;
}

#dqdkumbsny .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dqdkumbsny .gt_font_normal {
  font-weight: normal;
}

#dqdkumbsny .gt_font_bold {
  font-weight: bold;
}

#dqdkumbsny .gt_font_italic {
  font-style: italic;
}

#dqdkumbsny .gt_super {
  font-size: 65%;
}

#dqdkumbsny .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dqdkumbsny .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dqdkumbsny .gt_indent_1 {
  text-indent: 5px;
}

#dqdkumbsny .gt_indent_2 {
  text-indent: 10px;
}

#dqdkumbsny .gt_indent_3 {
  text-indent: 15px;
}

#dqdkumbsny .gt_indent_4 {
  text-indent: 20px;
}

#dqdkumbsny .gt_indent_5 {
  text-indent: 25px;
}

#dqdkumbsny .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dqdkumbsny div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="trial" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial</th>
<th id="treatment" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">treatment</th>
<th id="trial-duration" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">trial duration</th>
<th id="responders" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">responders</th>
<th id="patients" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">patients</th>
<th id="proportion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">proportion</th>
<th id="long_study" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">long_study</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="trial">NVS101 Proof of Concept</td>
<td class="gt_row gt_center" headers="treatment">NVS101</td>
<td class="gt_row gt_left" headers="trial duration">12 weeks</td>
<td class="gt_row gt_right" headers="responders">8</td>
<td class="gt_row gt_right" headers="patients">10</td>
<td class="gt_row gt_right" headers="proportion">0.80</td>
<td class="gt_row gt_right" headers="long_study">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="trial">EG-999 Phase 3</td>
<td class="gt_row gt_center" headers="treatment">placebo</td>
<td class="gt_row gt_left" headers="trial duration">52 weeks</td>
<td class="gt_row gt_right" headers="responders">2</td>
<td class="gt_row gt_right" headers="patients">13</td>
<td class="gt_row gt_right" headers="proportion">0.15</td>
<td class="gt_row gt_right" headers="long_study">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="model-description" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="model-description"><span class="header-section-number">8.3</span> Model description</h2>
<section id="idea" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="idea"><span class="header-section-number">8.3.1</span> Idea</h3>
<p>With this available information and data, what do we do to come to a reasonable belief about the efficacy of NVS101 and the PoS of the drug development project? One approach that is <a href="https://doi.org/10.1002/pst.2179">foreseen in the Novartis PoS framework</a> is to conduct an expert elicitation that relies on experts making judgements about the totality of the available evidence.</p>
<p>Another approach is to analyze the available data. However, we do not have direct data on</p>
<ol type="1">
<li><p>how NVS101 compares to a placebo group within the same trial (the proof of concept study was a single arm trial),</p></li>
<li><p>how much the true placebo group responder proportion varies from trial to trial, and</p></li>
<li><p>how much the true responder proportion changes with trial duration (for either NVS101 or placebo).</p></li>
</ol>
<p>Thus, we will still require prior judgements on these questions. However, it could be the case that these questions are easier to make judgements about for experts than if we asked them directly about the efficacy of a drug compared with placebo.</p>
</section>
<section id="model-specification" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="model-specification"><span class="header-section-number">8.3.2</span> Model specification</h3>
<p>we first express a mixed effects logistic regression model ignoring whether we have data to tell us something about all model parameters. We assume a binomial outcome <span class="math inline">\(Y_{ij} \sim \text{Bin}(\pi_{ij}, N_{ij})\)</span> for arm <span class="math inline">\(j\)</span> of trial <span class="math inline">\(i\)</span>. Our model specifies that</p>
<p><span class="math display">\[\begin{align}
\text{logit}(\pi_{ij}) =&amp; \; \beta_0  \\
&amp; + \beta_1 \times 1\{\text{treatment}_{ij} = \text{NVS101}\} \\
&amp; + \beta_2 \times
1\{\text{duration} = \text{52 weeks} \} \\
&amp;+ \beta_3 \times
1\{\text{treatment}_{ij} = \text{NVS101 \&amp; duration} = \text{52 weeks}
\}  \\
&amp; + \theta_i,
\end{align}\]</span></p>
<p>where <span class="math inline">\(\theta_i \sim N(0, \tau^2)\)</span> is a random trial effect. Or to express this as a brms-formula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(responders <span class="sc">|</span> <span class="fu">trials</span>(patients) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> treatment <span class="sc">+</span> long_study <span class="sc">+</span> long_study<span class="sc">:</span>treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> trial),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># short notation for the rhs of this formula is</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 1 + treatment*long_study + (1 | trial)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">center =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note</strong> that we use the option <code>center=FALSE</code> here in order to fully control the parametrization of the linear predictor. By default <code>brms</code> centers the design matrix and treats the intercept separately from the remaining covariates. While this is often desirable to do, this is not appropiate in this case where we want to control all details of the model and intend to set priors deliberately.</p>
</section>
<section id="specification-of-prior-distributions" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="specification-of-prior-distributions"><span class="header-section-number">8.3.3</span> Specification of prior distributions</h3>
<p>Before we saw the EG-999 Phase 3 study, what might we have believed about the placebo group of such a study? To answer this might be a time consuming process that may require a review of the available literature and/or eliciting the judgements of experts. Conveniently, the sample size section of the clinical trial protocol of the EG-999 Phase 3 study contained a statement that the expected placebo responder rate might be in the range of 5% to 40%. We will interpret this to indicate a 80% prediction interval. The authors of the protocol do not really say so clearly, but we speculate that we cannot rely on this being a 95% prediction interval. Thus, if we assume a normal distribution for the predictive distribution, we get a normal distribution on the logit-scale with mean <code>( logit(0.4) + logit(0.05) )/2</code> <span class="math inline">\(\approx\)</span> -1.67 and standard deviation <code>( logit(0.4) - logit(0.05) ) / 2 / qnorm(0.9)</code> <span class="math inline">\(\approx\)</span> 1.</p>
<div class="alert alert-info">
<p>Note that the <code>logit</code> and <code>inv_logit</code> are convenient functions from the <code>RBesT</code> package for converting from probabilities to logit-probabilities and vice versa (in base R you can use <code>qlogis</code> and <code>plogis</code> instead).</p>
</div>
<p>The resulting prior distribution looks as shown in the figure below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="sc">-</span><span class="fl">1.67</span>, <span class="at">sd=</span><span class="fl">1.0</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"darkorange"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">(="</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">round</span>(<span class="fu">inv_logit</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Average placebo log-odds"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="alert alert-info">
<p><strong>NOTE</strong>: The <code>ggdist</code> and <code>distributional</code> packages are an amazing combo for understanding distributions. <code>ggdist</code> extends <code>ggplot2</code> to help us with visualizing distributions (see <a href="https://mjskay.github.io/ggdist/">here</a> for more information). <code>distributional</code> lets us work with distributions including many commonly used ones, truncated distributions (e.g.&nbsp;half-normal as <code>dist_truncated(dist_normal(mu = 0, sigma=2.5), lower=0)</code>), distributions of transformed random variables (e.g. <code>dist_transformed(dist=dist_normal(0, 0.5), transform=exp, inverse=log) |&gt; mean()</code>) and mixture distributions (e.g. <code>dist_mixture(dist_normal(0, 1), dist_normal(1.5, 5), weights = c(0.5, 0.5))</code>). With the <code>distributional</code> package, we can also obtain information on distributions such as their mean, median, quantiles, variance, skewness and so on (e.g.&nbsp;<code>dist_student_t(df=3, mu = 0, sigma = 1) |&gt; median()</code>).</p>
</div>
<p>Now that we have a prior for the average true response proportion, we consider how much the true proportion might vary from study to study. To set a prior distribution on the between trial SD, we asked experts about the narrowest and widest random effects distributions they consider plausible. When discussing with our experts, we fixed the random effects mean to a plausible value to make it easier for them to express their prior belief on a scale they are comfortable on. We then assumed that the same distribution width is approximately plausible for other mean values, too.</p>
<p>For a hypothetical scenario with an average true reponse proportion of 15%, clinical experts expressed that it would be unlikely that a few studies would not end up having a true responder proportion of 20% and that it is possible that variability could be so high that some could reach 40%.</p>
<p>Thus, we considered that for the narrowest plausible random effects distribution (conditional on the the middle of the distribution being 15%), there should be 2.5% probability that studies could vary to 20% or higher. Similarly, for the widest plausible distribution, we assigned 2.5% probability that studies would vary to 40% or more. Normal distributions on the logit scale that fulfill these criteria are shown in the figure below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mu=</span><span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.68</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res=</span><span class="fu">map2</span>(mu, sigma, \(mu,sigma) <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>), <span class="at">y=</span><span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>), mu, sigma)))) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouping =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    (sigma<span class="sc">==</span><span class="fl">0.18</span> <span class="sc">&amp;</span> x<span class="sc">&gt;</span><span class="fu">qlogis</span>(<span class="fl">0.2</span>)) <span class="sc">~</span> <span class="dv">1</span>L,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    sigma<span class="sc">==</span><span class="fl">0.18</span> <span class="sc">~</span> <span class="dv">2</span>L,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    (x<span class="sc">&gt;</span><span class="fu">qlogis</span>(<span class="fl">0.4</span>)) <span class="sc">~</span> <span class="dv">3</span>L,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">4</span>L), <span class="at">levels=</span><span class="fu">rev</span>(<span class="dv">1</span>L<span class="sc">:</span><span class="dv">4</span>L))) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>y, <span class="at">col=</span>grouping,  <span class="at">fill=</span>grouping)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#stat_slab(slab_alpha=0.5, n=10000) +</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.2</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">qlogis</span>(<span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>)),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">round</span>(<span class="fu">qlogis</span>(<span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">="</span>, <span class="dv">100</span><span class="sc">*</span><span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.62</span>, <span class="sc">-</span><span class="fl">1.4</span>, <span class="sc">-</span><span class="fl">1.1</span>, <span class="sc">-</span><span class="fl">0.9</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>), </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="fu">c</span>(<span class="st">"SD of 0.18"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste0</span>(<span class="st">"P(probability&gt;=20%)="</span>,<span class="fu">round</span>(<span class="dv">100-100</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="at">q=</span><span class="fu">qlogis</span>(<span class="fl">0.2</span>), <span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="fl">0.18</span>),<span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"SD of 0.68"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste0</span>(<span class="st">"P(probability&gt;=40%)="</span>,<span class="fu">round</span>(<span class="dv">100-100</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="at">q=</span><span class="fu">qlogis</span>(<span class="fl">0.4</span>), <span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="fl">0.68</span>),<span class="dv">1</span>), <span class="st">"%"</span>)),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.68</span>, <span class="fl">0.68</span>), <span class="at">grouping=</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">2</span>L, <span class="dv">1</span>L, <span class="dv">4</span>L, <span class="dv">3</span>L), <span class="at">levels=</span><span class="fu">rev</span>(<span class="dv">1</span>L<span class="sc">:</span><span class="dv">4</span>L))), <span class="at">size=</span><span class="dv">6</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"True logit-response-probability for new trial</span><span class="sc">\n</span><span class="st">given average trial is -1.73 (=15%)"</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"#E69F00"</span>, <span class="st">"darkblue"</span>, <span class="st">"#56B4E9"</span>))) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"#E69F00"</span>, <span class="st">"darkblue"</span>, <span class="st">"#56B4E9"</span>))) <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Narrowest &amp; widest plausible random effects</span><span class="sc">\n</span><span class="st">distribution conditional on a mean of logit(0.15)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, we translate these beliefs into a prior for the between-trial SD. Given that we consider 0.18 and 0.68 as on the edge of what is plausible for the between-trial SD, we pick a log-normal distribution for the between-trial SD that has these two values approximately as its 2.5th and 97.5th percentiles. For such a normal distribution on the logit-scale centered on logit(0.15), this implies a standard deviation of <code>(logit(0.2)-logit(0.15)) / qnorm(0.975)</code> <span class="math inline">\(\approx\)</span> 0.18 to <code>(logit(0.4)-logit(0.15)) / qnorm(0.975)</code> <span class="math inline">\(\approx\)</span> 0.68. This can be described by a log-normal prior distribution on the standard deviation with location -1.06 and scale 0.35, as we can see by observing that <code>dist_lognormal(mu = -1.06, sigma = 0.35) |&gt; quantile(p=c(0.025, 0.975)) |&gt; unlist()</code> = 0.174, 0.688.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mu=</span><span class="sc">-</span><span class="fl">1.06</span>, <span class="at">sigma=</span><span class="fl">0.35</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_lognormal</span>(<span class="at">mu=</span>mu, <span class="at">sigma=</span>sigma))) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.18</span>, <span class="at">col=</span><span class="st">"#E69F00"</span>, <span class="at">linewidth=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.68</span>, <span class="at">col=</span><span class="st">"#56B4E9"</span>, <span class="at">linewidth=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span><span class="fu">tibble</span>(<span class="at">mu=</span><span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.5</span>), </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="fu">c</span>(<span class="st">"SD of 0.18"</span>, <span class="st">"SD of 0.68"</span>)),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>mu, <span class="at">y=</span>sigma, <span class="at">label=</span>label),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="dv">6</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">fill=</span><span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Between trial SD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When asked how much lower the responder proportion over 52 vs.&nbsp;12 weeks would be, the clinicians judge it likely that the proportion would decline a little bit. Their rationale was that while the disease does not progress fast enough to change substantially over 9 months, a longer duration offers additional opportunities for a low red blood cell count to occur (even if by chance) that might lead to a blood transfusion.</p>
<p>The resulting prior distribution looks as shown in the figure below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="sc">-</span><span class="fl">0.1</span>, <span class="at">sd=</span>.<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"#e7298a"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>)), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lower</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"higher</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">2</span>)))) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log-odds of response over 52 compared with 12 weeks"</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, the clinicians were unsure whether a 52 week vs.&nbsp;a 12 week study would result in a higher or lower log-odds-ratio for drug vs.&nbsp;placebo. However, they expressed that the effect would be relatively small, because the drug should not be disease modifying (i.e.&nbsp;treatment effect should not grow over time) and there is no reason to speculate that the effect on red blood cell counts would somehow decline over time, either. On this basis, they expressed the following prior distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>.<span class="dv">1</span><span class="sc">/</span><span class="fl">1.96</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"royalblue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>)), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lower</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"higher</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">2</span>)))) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Change in log-odds ratio of drug vs. placebo</span><span class="sc">\n</span><span class="st">when increasing trial duration from 12 to 52 weeks"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Thus, we can set out prior distributions as below. To see what particular coefficients are named, <code>get_prior(model_formula, our_data)</code> is a useful command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>brms_prior <span class="ot">&lt;-</span> <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span>Intercept, <span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.67</span>, <span class="fl">1.0</span>)) <span class="sc">+</span> <span class="co"># prior average placebo effect </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>sd, <span class="at">coef=</span>Intercept, <span class="at">group=</span>trial, <span class="fu">lognormal</span>( <span class="sc">-</span><span class="fl">1.06</span>, <span class="fl">0.35</span>)) <span class="sc">+</span> <span class="co"># prior on the between-study SD in  placebo log-odds</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span>long_study, <span class="fu">normal</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="co"># prior for effect of long-study (26 vs. 12 weeks) on responder rate</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span><span class="st">"treatmentNVS101:long_study"</span>, <span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.1</span><span class="sc">/</span><span class="fl">1.96</span>)) <span class="sc">+</span> <span class="co"># Prior on the log-odds-ratio for drug vs. placebo when switching from shor to long study</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">mixnorm</span>(map_w, map_m, map_s), <span class="at">class=</span>b, <span class="at">coef=</span>treatmentNVS101) <span class="co">#  Syntax for specifying mixture prior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="alert alert-info">
<p><strong>NOTE</strong>: Thanks to the new functionality in the <code>RBesT</code> package, we were able to just write <code>prior(mixture_prior, class=b, coef=treatmentNVS10)</code> to specify a mixture prior. Alternatively, we could have written <code>prior(mixnorm(map_w, map_m, map_s), class=b, coef=treatmentNovDrug)</code>. <code>map_w</code>, <code>map_m</code> and <code>map_s</code> would specify the weights, means and standard deviations of the mixture components, respectively. If we did not have this <code>RBesT</code> functionality available, we would have to manually write down the log-probability-density-function of the mixture, which involves weighted sums on the probability scale e.g.&nbsp;using the <code>log_sum_exp</code> function. For further details on the <code>mixstanvars</code> feature, please refer to its <a href="https://opensource.nibr.com/RBesT/reference/mixstanvar.html">online manual</a>.</p>
</div>
</section>
<section id="model-fitting-and-predictions" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="model-fitting-and-predictions"><span class="header-section-number">8.3.4</span> Model fitting and predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>brmfit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> our_data,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>               <span class="co"># By doing 11,000 samples per chain (default 4 chains) incl. 1000</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="co"># warmup samples, we'll get 4 * 10,000= 40,000 samples, which is</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="co"># what we'll need in the PoS app.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>               <span class="co">#iter = 11000, warmup=1000, </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Now we specify our prior distributions:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> brms_prior,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Note that we define "map=mixture_prior" below. This</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>               <span class="co"># matches the prefix "map" defined in the previous</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>               <span class="co"># prior definition statement:</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">stanvars =</span> <span class="fu">mixstanvar</span>(<span class="at">map=</span>mixture_prior),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">control =</span> control_args,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">seed =</span> <span class="dv">5674574</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">silent =</span> <span class="dv">2</span>, </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>               )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now generate predictions for a new Phase 3 trial for NVS101 compared with placebo of 52 week duration. While the predictions for each arm of the new trial are by default for the true log-odds of response, we can derive all desired quantities from this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we are using the inv_logit function on rvars for which we need to</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare the funnction to handle rvar arguments</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rvar_inv_logit <span class="ot">&lt;-</span> <span class="fu">rfun</span>(inv_logit)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>new_ph3_trial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"New trial"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">treatment=</span><span class="fu">c</span>(<span class="st">"placebo"</span>, <span class="st">"NVS101"</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">long_study=</span><span class="dv">1</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">patients=</span><span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ph3_predictions <span class="ot">&lt;-</span> new_ph3_trial <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_linpred_rvars</span>(brmfit1,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">value=</span><span class="st">"logodds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion=</span><span class="fu">rvar_inv_logit</span>(logodds))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># One can have tibbles contain columns of rvars, which one can</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># recognize by the reported mean and standard deviation of the</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># sample they represent:</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>ph3_predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  trial     treatment long_study patients      logodds   proportion
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;rvar[1d]&gt;   &lt;rvar[1d]&gt;
1 New trial placebo            1       25  -1.6 ± 0.70  0.19 ± 0.11
2 New trial NVS101             1       50   1.0 ± 0.79  0.71 ± 0.15</code></pre>
</div>
</div>
</section>
</section>
<section id="results" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="results"><span class="header-section-number">8.4</span> Results</h2>
<p>Here is a plot of the predicted Phase 3 placebo and NVS101 responder proportion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ph3_predictions,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tibble</span>(<span class="at">proportion_NVS101  =</span> proportion[<span class="dv">2</span>],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">proportion_placebo =</span> proportion[<span class="dv">1</span>])) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">unnest_rvars</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>proportion_placebo, <span class="at">y=</span>proportion_NVS101)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_continuous</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Additionally, we can look at various measures of a treatment effect:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ph3_predictions <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist=</span>proportion)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment, <span class="at">labeller=</span>label_both, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Proportion"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ph3_predictions,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tibble</span>(<span class="at">measure=</span><span class="fu">c</span>(<span class="st">"logodds"</span>, <span class="st">"lograte"</span>, <span class="st">"proportion_diff"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">posterior=</span><span class="fu">c</span>(<span class="fu">diff</span>(logodds),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">diff</span>(<span class="fu">log</span>(proportion)),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">diff</span>(proportion)),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">ref=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist=</span>posterior)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span>ref), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>measure, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02l_single_arm_pos_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s say the target product profile (TPP) for the drug demands a risk difference of &gt;= 45%. We can simulate Phase III outcomes to find the probability of meeting this TPP and having a significant study, which the Novartis internal PoS app would do for us.</p>
<p>Note that the relativley compact code below does indeed perform a full trial simulation for possible outcomes for every draw of the posterior. The use of <code>rvars</code> hides essentially that we are handling entire posteriors here. However, note that we have to wrap the call to the <code>fisher.test</code> funcntion into <code>rdo</code> such that the expression is automatically evaluated for each draw of the posterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pos_simulations <span class="ot">&lt;-</span> new_ph3_trial <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_predicted_rvars</span>(brmfit1,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">value=</span><span class="st">"pred"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predrate=</span>pred<span class="sc">/</span>patients) <span class="sc">|&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatment, pred, predrate, patients) <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"treatment"</span>, <span class="at">values_from=</span><span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"predrate"</span>, <span class="st">"patients"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">riskdiff_crit =</span> predrate_NVS101 <span class="sc">-</span> predrate_placebo <span class="sc">&gt;=</span> <span class="fl">0.45</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">pvalue =</span> <span class="fu">rdo</span>(<span class="fu">fisher.test</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="fu">c</span>(pred_NVS101,  patients_NVS101  <span class="sc">-</span> pred_NVS101,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                               pred_placebo, patients_placebo <span class="sc">-</span> pred_placebo ),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="dv">2</span>, <span class="dv">2</span> ) )[[<span class="st">"p.value"</span>]] ),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving &gt;= 45% risk difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(riskdiff_crit),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving significance (p&lt;=0.05)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving significance &amp; TPP target</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(riskdiff_crit <span class="sc">*</span> (pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>))</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>pos_simulations <span class="sc">|&gt;</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Achieving"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">everything</span>(), <span class="at">names_to=</span><span class="st">"Outcome"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="xujkhtfixz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xujkhtfixz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xujkhtfixz thead, #xujkhtfixz tbody, #xujkhtfixz tfoot, #xujkhtfixz tr, #xujkhtfixz td, #xujkhtfixz th {
  border-style: none;
}

#xujkhtfixz p {
  margin: 0;
  padding: 0;
}

#xujkhtfixz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xujkhtfixz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xujkhtfixz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xujkhtfixz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xujkhtfixz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xujkhtfixz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujkhtfixz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xujkhtfixz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xujkhtfixz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xujkhtfixz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xujkhtfixz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xujkhtfixz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xujkhtfixz .gt_spanner_row {
  border-bottom-style: hidden;
}

#xujkhtfixz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xujkhtfixz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xujkhtfixz .gt_from_md > :first-child {
  margin-top: 0;
}

#xujkhtfixz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xujkhtfixz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xujkhtfixz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xujkhtfixz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xujkhtfixz .gt_row_group_first td {
  border-top-width: 2px;
}

#xujkhtfixz .gt_row_group_first th {
  border-top-width: 2px;
}

#xujkhtfixz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujkhtfixz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xujkhtfixz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xujkhtfixz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujkhtfixz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujkhtfixz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xujkhtfixz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xujkhtfixz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xujkhtfixz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujkhtfixz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xujkhtfixz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujkhtfixz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xujkhtfixz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujkhtfixz .gt_left {
  text-align: left;
}

#xujkhtfixz .gt_center {
  text-align: center;
}

#xujkhtfixz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xujkhtfixz .gt_font_normal {
  font-weight: normal;
}

#xujkhtfixz .gt_font_bold {
  font-weight: bold;
}

#xujkhtfixz .gt_font_italic {
  font-style: italic;
}

#xujkhtfixz .gt_super {
  font-size: 65%;
}

#xujkhtfixz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xujkhtfixz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xujkhtfixz .gt_indent_1 {
  text-indent: 5px;
}

#xujkhtfixz .gt_indent_2 {
  text-indent: 10px;
}

#xujkhtfixz .gt_indent_3 {
  text-indent: 15px;
}

#xujkhtfixz .gt_indent_4 {
  text-indent: 20px;
}

#xujkhtfixz .gt_indent_5 {
  text-indent: 25px;
}

#xujkhtfixz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xujkhtfixz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Outcome" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Outcome</th>
<th id="Probability" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Probability</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Outcome">Achieving &gt;= 45% risk difference</td>
<td class="gt_row gt_right" headers="Probability">0.676</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Outcome">Achieving significance (p&lt;=0.05)</td>
<td class="gt_row gt_right" headers="Probability">0.944</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Outcome">Achieving significance &amp; TPP target</td>
<td class="gt_row gt_right" headers="Probability">0.676</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As we can see, achieving the TPP risk difference is the greater hurdle than achieving statistical significance.</p>
<p>As part of the Novartis PoS framework, we would now account for the possibility of not obtaining an approval despite a positive Phase 3 study, a failure in Phase 3 due to a safety issue, and other risks (e.g.&nbsp;relating to drug manufacturing or market access).</p>
</section>
<section id="conclusion" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">8.5</span> Conclusion</h2>
<p>In the hypothetical case study, there was not a lot of data, but what there was appeared to be promising. Thus, one would not want to ignore it. In order to make use of it, we had to use informative prior distributions for several parameters of a logistic regression model. In this kind of situation, where we cannot let data inform our prior distributions, there is little choice, if we want an answer using the available data.</p>
<p>Given how our prior judgments directly affect the inference, we want ot ensure that the prior judgements reflect our best understanding of the available scientific evidence. For this purpose a formal prior elicitation (or predictions for some parameters from historical data) are options, but when those are not possibler, we should still try to ensure that prior choices are plausible to the whole team.</p>
<p>Note that in this example, there was also an underlying laboratory measurement (longitudinal measurements of red blood cell counts). It might have been more efficient to work with these directly, but it would have been necessary to translate any results into predictions for the Phase III responder endpoint. Furthermore, the published external competitor data might not report these laboratory outcomes in sufficient detail.</p>
<p>Single arm studies are not ideal. However, when treatment effects are large compared to how much placebo group outcomes vary, we can still learn about drug efficacy from them at the cost of additional assumptions. As part of our case study, we tried to be explicit about our uncertainties and to transparently describe our prior judgements, as well as the rationale behind them. If someone disagrees with some of our prior distributions, they can then do a sensitivity analysis.</p>
<p>A Bayesian approach is also well-suited for PoS calculations, because it lets us easily propagate uncertainties through different steps of a PoS analysis.</p>
</section>
<section id="exercises" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">8.6</span> Exercises</h2>
<p>To be added</p>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allison2012equip" class="csl-entry" role="listitem">
Allison, David B., Kishore M. Gadde, William Timothy Garvey, Craig A.
Peterson, Michael L. Schwiers, Thomas Najarian, Peter Y. Tam, Barbara
Troupin, and Wesley W. Day. 2012. <span>“Controlled-Release
Phentermine/Topiramate in Severely Obese Adults: A Randomized Controlled
Trial (EQUIP).”</span> <em>Obesity</em> 20 (2): 330–42. <a href="https://doi.org/10.1038/oby.2011.330">https://doi.org/10.1038/oby.2011.330</a>.
</div>
<div id="ref-Combescure_2012" class="csl-entry" role="listitem">
Combescure, C, DS Courvoisier, G Haller, and TV Perneger. 2012.
<span>“Meta-Analysis of Two-Arm Studies: Modeling the Intervention
Effect from Survival Probabilities.”</span> <em>Statistical Methods in
Medical Research</em> 25 (2): 857–71. <a href="https://doi.org/10.1177/0962280212469716">https://doi.org/10.1177/0962280212469716</a>.
</div>
<div id="ref-Dias2013evsnth" class="csl-entry" role="listitem">
Dias, Sofia, Alex J Sutton, A E Ades, and Nicky J Welton. 2013.
<span>“Evidence Synthesis for Decision Making 2: A Generalized Linear
Modeling Framework for Pairwise and Network Meta-Analysis of Randomized
Controlled Trials.”</span> <em>Med. Decis. Making</em> 33 (5): 607–17.
</div>
<div id="ref-dias2014" class="csl-entry" role="listitem">
Dias, S., N. J. Welton, A. J. Sutton, and A. Ades. 2014.
<span>“<span>NICE DSU</span> Technical Support Document 2: A Generalised
Linear Modelling Framework for Pairwise and Network Meta-Analysis of
Randomised Controlled Trials.”</span> Technical report. <span>NICE
Decision Support Unit</span>. <a href="http://www.nicedsu.org.uk/TSD2%20General%20meta%20analysis%20corrected%2015April2014.pdf">http://www.nicedsu.org.uk/TSD2%20General%20meta%20analysis%20corrected%2015April2014.pdf</a>.
</div>
<div id="ref-Gelman2014" class="csl-entry" role="listitem">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari,
and Donald B Rubin. 2014. <em>Bayesian Data Analysis</em>. <em>Chapman
Texts in Statistical Science Series</em>. Third edit. <a href="https://doi.org/10.1007/s13398-014-0173-7.2">https://doi.org/10.1007/s13398-014-0173-7.2</a>.
</div>
<div id="ref-Gelman2017" class="csl-entry" role="listitem">
Gelman, Andrew, Daniel Simpson, and Michael Betancourt. 2017. <span>“The
Prior Can Often Only Be Understood in the Context of the
Likelihood.”</span> <em>Entropy</em> 19 (October). <a href="https://doi.org/10.3390/e19100555">https://doi.org/10.3390/e19100555</a>.
</div>
<div id="ref-Grieve2022power" class="csl-entry" role="listitem">
Grieve, Andrew P. 2022. <em>Hybrid Frequentist/Bayesian Power and
Bayesian Power in Planning Clinical Trials</em>. Chapman &amp; Hall/CRC
Biostatistics Series. London, England: Taylor &amp; Francis.
</div>
<div id="ref-Hasselblad1998" class="csl-entry" role="listitem">
Hasselblad, Vic. 1998. <span>“Meta-Analysis of Multitreatment
Studies.”</span> <em>Medical Decision Making</em> 18 (1): 37–43. <a href="https://doi.org/10.1177/0272989x9801800110">https://doi.org/10.1177/0272989x9801800110</a>.
</div>
<div id="ref-Janjigian2021" class="csl-entry" role="listitem">
Janjigian, Yelena Y., Kohei Shitara, Markus Moehler, Marcelo Garrido,
Pamela Salman, Lin Shen, Lucjan Wyrwicz, et al. 2021. <span>“First-Line
Nivolumab Plus Chemotherapy Versus Chemotherapy Alone for Advanced
Gastric, Gastro-Oesophageal Junction, and Oesophageal Adenocarcinoma
(CheckMate 649): A Randomised, Open-Label, Phase 3 Trial.”</span>
<em>The Lancet</em> 398 (July): 27–40. <a href="https://doi.org/10.1016/S0140-6736(21)00797-2">https://doi.org/10.1016/S0140-6736(21)00797-2</a>.
</div>
<div id="ref-Kerman2011" class="csl-entry" role="listitem">
Kerman, Jouni. 2011. <span>“<span class="nocase">Neutral noninformative
and informative conjugate beta and gamma prior
distributions</span>.”</span> <em>Electronic Journal of Statistics</em>
5 (none): 1450–70. <a href="https://doi.org/10.1214/11-EJS648">https://doi.org/10.1214/11-EJS648</a>.
</div>
<div id="ref-Lilienthal2023" class="csl-entry" role="listitem">
Lilienthal, Jona, Sibylle Sturtz, Christoph Schürmann, Matthias Maiworm,
Christian Röver, Tim Friede, and Ralf Bender. 2023. <span>“Bayesian
Random‐effects Meta‐analysis with Empirical Heterogeneity Priors for
Application in Health Technology Assessment with Very Few
Studies.”</span> <em>Research Synthesis Methods</em>, December. <a href="https://doi.org/10.1002/jrsm.1685">https://doi.org/10.1002/jrsm.1685</a>.
</div>
<div id="ref-LuAdes2004" class="csl-entry" role="listitem">
Lu, G., and A. E. Ades. 2004. <span>“Combination of Direct and Indirect
Evidence in Mixed Treatment Comparisons.”</span> <em>Statistics in
Medicine</em> 23 (20): 3105–24. <a href="https://doi.org/10.1002/sim.1875">https://doi.org/10.1002/sim.1875</a>.
</div>
<div id="ref-Moore2009" class="csl-entry" role="listitem">
Moore, K. L., and M. J. van der Laan. 2009. <span>“Covariate Adjustment
in Randomized Trials with Binary Outcomes: Targeted Maximum Likelihood
Estimation.”</span> <em>Statistics in Medicine</em> 28 (1): 39–64. <a href="https://doi.org/10.1002/sim.3445">https://doi.org/10.1002/sim.3445</a>.
</div>
<div id="ref-Neuenschwander2010" class="csl-entry" role="listitem">
Neuenschwander, Beat, Gorana Capkun-Niggli, Michael Branson, and David J
Spiegelhalter. 2010. <span>“Summarizing Historical Information on
Controls in Clinical Trials.”</span> <em>Clinical Trials</em> 7
(February): 5–18. <a href="https://doi.org/10.1177/1740774509356002">https://doi.org/10.1177/1740774509356002</a>.
</div>
<div id="ref-Neuenschwander2020" class="csl-entry" role="listitem">
Neuenschwander, Beat, and Heinz Schmidli. 2020. <span>“Use of Historical
Data.”</span> <a href="https://CRAN.R-project.org/package=RBesT">https://CRAN.R-project.org/package=RBesT</a>.
</div>
<div id="ref-OHagan2005assurance" class="csl-entry" role="listitem">
O’Hagan, Anthony, John W Stevens, and Michael J Campbell. 2005.
<span>“Assurance in Clinical Trial Design.”</span> <em>Pharm. Stat.</em>
4 (3): 187–201. <a href="https://doi.org/10.1002/pst.175">https://doi.org/10.1002/pst.175</a>.
</div>
<div id="ref-Piepho2012" class="csl-entry" role="listitem">
Piepho, H. P., E. R. Williams, and L. V. Madden. 2012. <span>“The Use of
Two-Way Linear Mixed Models in Multitreatment Meta-Analysis.”</span>
<em>Biometrics</em> 68 (4): 1269–77. <a href="https://doi.org/10.1111/j.1541-0420.2012.01786.x">https://doi.org/10.1111/j.1541-0420.2012.01786.x</a>.
</div>
<div id="ref-Piironen2017" class="csl-entry" role="listitem">
Piironen, Juho, and Aki Vehtari. 2017. <span>“Sparsity Information and
Regularization in the Horseshoe and Other Shrinkage Priors.”</span>
<em>Electronic Journal of Statistics</em> 11 (January): 5018–51. <a href="https://doi.org/10.1214/17-EJS1337SI">https://doi.org/10.1214/17-EJS1337SI</a>.
</div>
<div id="ref-Rover2021" class="csl-entry" role="listitem">
Röver, Christian, Ralf Bender, Sofia Dias, Christopher H. Schmid, Heinz
Schmidli, Sibylle Sturtz, Sebastian Weber, and Tim Friede. 2021.
<span>“On Weakly Informative Prior Distributions for the Heterogeneity
Parameter in Bayesian Random-Effects Meta-Analysis.”</span> <em>Research
Synthesis Methods</em> 12 (January): 448–74. <a href="https://doi.org/10.1002/jrsm.1475">https://doi.org/10.1002/jrsm.1475</a>.
</div>
<div id="ref-schmidli2014robust" class="csl-entry" role="listitem">
Schmidli, Heinz, Sandro Gsteiger, Satrajit Roychoudhury, Anthony
O’Hagan, David Spiegelhalter, and Beat Neuenschwander. 2014.
<span>“Robust Meta-Analytic-Predictive Priors in Clinical Trials with
Historical Control Information.”</span> <em>Biometrics</em> 70 (4):
1023–32. <a href="https://doi.org/10.1111/biom.12242">https://doi.org/10.1111/biom.12242</a>.
</div>
<div id="ref-Schmidli2017vrmap" class="csl-entry" role="listitem">
Schmidli, Heinz, Beat Neuenschwander, and Tim Friede. 2017.
<span>“Meta-Analytic-Predictive Use of Historical Variance Data for the
Design and Analysis of Clinical Trials.”</span> <em>Comput. Stat. Data
Anal.</em> 113 (September): 100–110. <a href="https://doi.org/10.1016/j.csda.2016.08.007">https://doi.org/10.1016/j.csda.2016.08.007</a>.
</div>
<div id="ref-Senn2013nma" class="csl-entry" role="listitem">
Senn, Stephen, Francois Gavini, David Magrez, and André Scheen. 2013.
<span>“Issues in Performing a Network Meta-Analysis.”</span> <em>Stat.
Methods Med. Res.</em> 22 (2): 169–89.
</div>
<div id="ref-Simpson2014" class="csl-entry" role="listitem">
Simpson, Daniel P., Håvard Rue, Thiago G. Martins, Andrea Riebler, and
Sigrunn H. Sørbye. 2014. <span>“Penalising Model Component Complexity: A
Principled, Practical Approach to Constructing Priors.”</span>
<em>Statistical Science</em> 32 (February): 1–28. <a href="https://doi.org/10.1214/16-STS576">https://doi.org/10.1214/16-STS576</a>.
</div>
<div id="ref-stanwikiPrior" class="csl-entry" role="listitem">
Stan. 2024. <span>“Prior Choice Recommendations.”</span> 2024. <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations</a>.
</div>
<div id="ref-Steingrimsson201718" class="csl-entry" role="listitem">
Steingrimsson, Jon Arni, Daniel F. Hanley, and Michael Rosenblum. 2017.
<span>“Improving Precision by Adjusting for Prognostic Baseline
Variables in Randomized Trials with Binary Outcomes, Without Regression
Model&nbsp;Assumptions.”</span> <em>Contemporary Clinical Trials</em> 54:
18–24. <a href="https://doi.org/10.1016/j.cct.2016.12.026">https://doi.org/10.1016/j.cct.2016.12.026</a>.
</div>
<div id="ref-Turner2015" class="csl-entry" role="listitem">
Turner, Rebecca M, Dan Jackson, Yinghui Wei, Simon G Thompson, and
Julian P T Higgins. 2015. <span>“Predictive Distributions for
Between-Study Heterogeneity and Simple Methods for Their Application in
Bayesian Meta-Analysis.”</span> <em>Statistics in Medicine</em> 34:
984–98. <a href="https://doi.org/10.1002/sim.6381">https://doi.org/10.1002/sim.6381</a>.
</div>
<div id="ref-Warren2014" class="csl-entry" role="listitem">
Warren, Fiona C., Keith R. Abrams, and Alex J. Sutton. 2014.
<span>“Hierarchical Network Meta-Analysis Models to Address Sparsity of
Events and Differing Treatment Classifications with Regard to Adverse
Outcomes.”</span> <em>Statistics in Medicine</em> 33 (14): 2449–66. <a href="https://doi.org/10.1002/sim.6131">https://doi.org/10.1002/sim.6131</a>.
</div>
<div id="ref-Weber2021" class="csl-entry" role="listitem">
Weber, Sebastian, Yue Li, John W Seaman III, Tomoyuki Kakizume, and
Heinz Schmidli. 2021. <span>“Applying Meta-Analytic-Predictive Priors
with the r Bayesian Evidence Synthesis Tools.”</span> <em>Journal of
Statistical Software</em> 100 (November): 1–32. <a href="https://doi.org/10.18637/jss.v100.i19">https://doi.org/10.18637/jss.v100.i19</a>.
</div>
<div id="ref-Zhang2022" class="csl-entry" role="listitem">
Zhang, Yan Dora, Brian P. Naughton, Howard D. Bondell, and Brian J.
Reich. 2022. <span>“Bayesian Regression Using a Prior on the Model Fit:
The R2-D2 Shrinkage Prior.”</span> <em>Journal of the American
Statistical Association</em> 117: 862–74. <a href="https://doi.org/10.1080/01621459.2020.1825449">https://doi.org/10.1080/01621459.2020.1825449</a>.
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/opensource\.nibr\.com\/bamdd\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../src/02k_nuisance.html" class="pagination-link" aria-label="Nuisance parameters, expected power and the &quot;significance threshold&quot;">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nuisance parameters, expected power and the “significance threshold”</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../src/02b_dose_finding.html" class="pagination-link" aria-label="Dose finding">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dose finding</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">  - Björn Holzhauer - &lt;bjoern.holzhauer@novartis.com&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - Sebastian Weber - &lt;sebastian.weber@novartis.com&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Probability of success from a single arm trial {#sec-pos}</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>This case study:</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>discusses probability of success for drug development projects (and </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>introduces the related concept of assurance) when the available data come</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>from a single arm trial without a control group</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>shows how to specify mixture priors with <span class="in">`brms`</span> using helper functions from</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>the <span class="in">`RBesT`</span> package such as <span class="in">`RBesT::mixnorm()`</span> and <span class="in">`RBesT::mixstanvar()`</span> (used</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>with the <span class="in">`stanvars`</span> option of <span class="in">`brms::brm()`</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>gives examples of how to choose prior distributions including how to obtain</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>useful visualizations and other helpful information using the <span class="in">`ggdist`</span> and </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="in">`distributional`</span> packages</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>To run the R code of this section please ensure to load these libraries first:</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basesetup,eval=TRUE,echo=TRUE,message=FALSE,warning=FALSE,cache=FALSE}</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RBesT)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co"># Great ggplo2 extension package for visualizing distributions/priors/posteriors</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional) <span class="co"># Defines distribution (that we then use in via ggdist)</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># instruct brms to use cmdstanr as backend and cache all Stan binaries</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>, <span class="at">cmdstanr_write_stan_file_dir=</span><span class="fu">here</span>(<span class="st">"_brms-cache"</span>))</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># create cache directory if not yet available</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">"_brms-cache"</span>), <span class="cn">FALSE</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">678571</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co"># default controls args passed to Stan</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>control_args <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">adapt_delta=</span><span class="fl">0.99</span>, <span class="at">step_size=</span><span class="fl">0.1</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># nice common ggplot2 theme</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">18</span>))</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE, echo=FALSE, eval=TRUE}</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible to the reader additional setup steps, which are optional</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="co"># {{&lt; include setup.R &gt;}}</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"setup.R"</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-profile="dummy"}</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview Video</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>{{&lt; video videos/brms3-hq-alt-3-pos.mp4 &gt;}}</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability of success</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>For pharmaceutical companies it is important to realistically assess</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>the probability of success (PoS) for drug development</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>projects. Together with other information and considerations</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>(e.g. costs of trials, projected timelines, unmet need for new</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>therapies for an indication, competitive landscape, ...) this allows</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>for informed decision making about things such as which projects to</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>pursue at all and how much at-risk investment to make into each of</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>them.</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>There are a number of ways to define success for PoS calculations, but </span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">at Novartis the definition of success</span><span class="co">](https://doi.org/10.1002/pst.2179)</span> is to </span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>get approval meeting a target product profile (TPP). It is assumed that if the </span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>drug is approved with a label as good or better than the TPP targets, it will</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>meet an important unmet need for patients, be successful on the market and the </span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>sales forecasts (obtained assuming this TPP) would be achieved. </span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">The Novartis PoS framework</span><span class="co">](https://doi.org/10.1002/pst.2179)</span> combines industry</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>benchmark information with data on a drug and team assessments of other risks. </span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>This is most easily done when we have directly relevant data, e.g. with a </span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>Phase 2 study that is very similar (in terms of population, endpoint, duration </span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>and treatment groups) to the planned Phase 3 trial(s). On the other hand, this </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>is harder based on a single arm study that differs from Phase 3 (or worse</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>without Phase 2 data).</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assurance</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Assurance</span><span class="co">](https://doi.org/10.1002/pst.175)</span> is a </span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">popular</span><span class="co">](https://doi.org/10.1002/pst.1856)</span> related concept to PoS. It describes</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>the probability of a successful trial.</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="fu">### Background of the hypothetical example</span></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>A hypothetical drug called NVS101 is already approved as a treatment for</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>some systemic diseases. In a single arm trial in patients with a</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>different systemic disease that leads to anemia, most patients</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>that received NVS101 for 12 weeks were able to achieve an acceptable red</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>blood cell count without needing a blood transfusion. We are now</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>considering to start a pivotal randomized placebo controlled Phase III</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>trial, where the primary endpoint would be having an acceptable red</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>blood cell count without needing a blood transfusion over a 1-year</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>period.</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>We wish to assess the PoS of such a pivotal study. I.e. the probability to get </span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>approval meeting the TPP of an odds ratio of 8.5 (given an assumed placebo</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>responder rate of 15% this corresponds to a targeted 60% for the drug).</span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Novartis PoS framework</span><span class="co">](https://doi.org/10.1002/pst.2179)</span> provides</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>us with a prior for the log-odds ratio of response on drug compared with</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>a placebo given a number of project features. For a drug that is past</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>its first approval (a so-called "life-cycle management" situation) such</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>as NVS101, a TPP target of a odds ratio of 8.5 (given an assumed placebo</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>responder rate of 15% this corresponds to a targeted 60% for the drug),</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>we obtain a mixture prior for the log-odds ratio:</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>mixture_prior <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">mixnorm</span>(<span class="st">"Null component"</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.08289228</span>, <span class="dv">0</span>, <span class="fl">0.91992526</span>),</span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"TPP component"</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.91710772</span>, <span class="fl">2.14006616</span>, <span class="fl">0.91992526</span>))</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>mixture_prior[,] <span class="sc">|&gt;</span> </span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Property =</span> <span class="fu">c</span>(<span class="st">"Mixture weight"</span>, </span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Mean of mixture component"</span>, </span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SD of mixture component"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Property) <span class="sc">|&gt;</span></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns=</span><span class="fu">c</span>(<span class="st">"Null component"</span>, <span class="st">"TPP component"</span>), </span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>              <span class="at">label=</span><span class="st">"Components of the mixture prior"</span>)</span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>Novartis associates can obtain this using the Novartis internal <span class="in">`pos`</span> R</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>package using the <span class="in">`pos::benchmark_prior()`</span> function and applying the</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a><span class="in">`pos::as_rbest_mixnorm()`</span> function to the result, which converts the</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>prior to a mixture prior object in the <span class="in">`RBesT`</span> package.</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>When we plot this mixture distribution, it looks as follows:</span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot_mixture}</span></span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mixture_prior) <span class="sc">+</span> </span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log-odds ratio for response</span><span class="sc">\n</span><span class="st">on drug compared with placebo"</span>) <span class="sc">+</span></span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>The hypothetical single arm trial data for NVS101 are given below:</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>nvs101_singlearm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"NVS101 Proof of Concept"</span>,</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>                           <span class="at">treatment=</span><span class="st">"NVS101"</span>,</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">trial duration</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"12 weeks"</span>,</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>                           <span class="at">responders=</span><span class="dv">8</span>,</span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patients=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion=</span>responders<span class="sc">/</span>patients,</span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">long_study=</span><span class="dv">0</span>L)</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a>nvs101_singlearm <span class="sc">|&gt;</span></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>Let us assume that there has been a placebo controlled Phase 3 trial in</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>this indication for another drug EG-999, but no other trials with the</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>same endpoint. The data for the hypothetical other drug are given below:</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>eg999_ph3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"EG-999 Phase 3"</span>,</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">trial duration</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"52 weeks"</span>,</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a>                    <span class="at">treatment=</span><span class="fu">c</span>(<span class="st">"EG-999"</span>, <span class="st">"placebo"</span>),</span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>                    <span class="at">responders=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">2</span>),</span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>                    <span class="at">patients=</span><span class="fu">c</span>(<span class="dv">26</span>, <span class="dv">13</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion=</span>responders<span class="sc">/</span>patients,</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">long_study=</span><span class="dv">1</span>L)</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>eg999_ph3 <span class="sc">|&gt;</span></span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>Superficially, this extra information makes the NVS101 single arm data</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>look promising, because the responder proportion on NVS101 is much</span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>higher than on placebo and even higher than on the EG-999 active</span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>treatment group. However, this is a non-randomized across trial</span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>comparison and it is not immediately clear how to quantify the strength</span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>of evidence for the efficacy of NVS101.</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a>Since we are not really interested in EG-999, the data we will use from</span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>the EG-999 Phase 3 trial will only be the placebo group. Thus, our the</span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>data we will use are the following:</span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>our_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(nvs101_singlearm,</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>                      eg999_ph3 <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment <span class="sc">!=</span> <span class="st">"EG-999"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment=</span><span class="fu">factor</span>(treatment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"placebo"</span>, <span class="st">"NVS101"</span>)))</span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>our_data <span class="sc">|&gt;</span></span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="st">"proportion"</span>, <span class="at">decimals=</span><span class="dv">2</span>)</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model description</span></span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Idea</span></span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>With this available information and data, what do we do to come to a</span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>reasonable belief about the efficacy of NVS101 and the PoS of the drug</span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a>development project? One approach that is [foreseen in the Novartis PoS</span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>framework](https://doi.org/10.1002/pst.2179) is to conduct an expert</span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a>elicitation that relies on experts making judgements about the totality</span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>of the available evidence.</span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>Another approach is to analyze the available data. However, we do not</span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a>have direct data on</span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>how NVS101 compares to a placebo group within the same trial (the</span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>    proof of concept study was a single arm trial),</span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>how much the true placebo group responder proportion varies from</span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>    trial to trial, and</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>how much the true responder proportion changes with trial duration</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>    (for either NVS101 or placebo).</span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>Thus, we will still require prior judgements on these questions.</span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>However, it could be the case that these questions are easier to make</span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>judgements about for experts than if we asked them directly about the</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>efficacy of a drug compared with placebo.</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model specification</span></span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a>we first express a mixed effects logistic regression model ignoring</span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a>whether we have data to tell us something about all model parameters. We</span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a>assume a binomial outcome</span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a>$Y_{ij} \sim \text{Bin}(\pi_{ij}, N_{ij})$ for arm $j$ of trial $i$. Our</span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a>model specifies that</span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a>\text{logit}(\pi_{ij}) =&amp; \; \beta_0  <span class="sc">\\</span></span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_1 \times 1<span class="sc">\{</span>\text{treatment}_{ij} = \text{NVS101}<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_2 \times</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\{</span>\text{duration} = \text{52 weeks} <span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a>&amp;+ \beta_3 \times</span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\{</span>\text{treatment}_{ij} = \text{NVS101 <span class="sc">\&amp;</span> duration} = \text{52 weeks}</span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a><span class="sc">\}</span>  <span class="sc">\\</span></span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a>&amp; + \theta_i,</span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a>where $\theta_i \sim N(0, \tau^2)$ is a random trial effect. Or to</span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>express this as a brms-formula:</span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(responders <span class="sc">|</span> <span class="fu">trials</span>(patients) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> treatment <span class="sc">+</span> long_study <span class="sc">+</span> long_study<span class="sc">:</span>treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> trial),</span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># short notation for the rhs of this formula is</span></span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 1 + treatment*long_study + (1 | trial)</span></span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a>                    <span class="at">center =</span> <span class="cn">FALSE</span>, </span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a>**Note** that we use the option <span class="in">`center=FALSE`</span> here in order to fully</span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a>control the parametrization of the linear predictor. By default <span class="in">`brms`</span></span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a>centers the design matrix and treats the intercept separately from the</span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>remaining covariates. While this is often desirable to do, this is not</span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a>appropiate in this case where we want to control all details of the</span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a>model and intend to set priors deliberately.</span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Specification of prior distributions</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a>Before we saw the EG-999 Phase 3 study, what might we have believed</span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>about the placebo group of such a study? To answer this might be a time</span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a>consuming process that may require a review of the available literature</span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>and/or eliciting the judgements of experts. Conveniently, the sample</span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>size section of the clinical trial protocol of the EG-999 Phase 3 study</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>contained a statement that the expected placebo responder rate might be</span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>in the range of 5% to 40%. We will interpret this to indicate a 80% prediction</span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>interval. The authors of the protocol do not really say so clearly, but</span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>we speculate that we cannot rely on this being a 95% prediction</span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a>interval. Thus, if we assume a normal distribution for the predictive</span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>distribution, we get a normal distribution on the logit-scale with mean</span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a><span class="in">`( logit(0.4) + logit(0.05) )/2`</span> $\approx$</span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a><span class="in">`r round( ( logit(0.4) + logit(0.05) )/2, 2)`</span> and standard deviation</span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a><span class="in">`( logit(0.4) - logit(0.05) ) / 2 / qnorm(0.9)`</span> $\approx$</span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a><span class="in">`r round( ( logit(0.4) - logit(0.05) ) / 2 / qnorm(0.9), 1)`</span>. </span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`logit`</span> and <span class="in">`inv_logit`</span> are convenient functions from the <span class="in">`RBesT`</span></span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>package for converting from probabilities to logit-probabilities and</span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>vice versa (in base R you can use <span class="in">`qlogis`</span> and <span class="in">`plogis`</span> instead).</span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a>The resulting prior distribution looks as shown in the figure below.</span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="sc">-</span><span class="fl">1.67</span>, <span class="at">sd=</span><span class="fl">1.0</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"darkorange"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), </span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">(="</span>, </span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">round</span>(<span class="fu">inv_logit</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Average placebo log-odds"</span>) <span class="sc">+</span></span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a>**NOTE**: The <span class="in">`ggdist`</span> and <span class="in">`distributional`</span> packages are an amazing</span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a>combo for understanding distributions. <span class="in">`ggdist`</span> extends <span class="in">`ggplot2`</span> to</span>
<span id="cb21-325"><a href="#cb21-325" aria-hidden="true" tabindex="-1"></a>help us with visualizing distributions (see</span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">here</span><span class="co">](https://mjskay.github.io/ggdist/)</span> for more information).</span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a><span class="in">`distributional`</span> lets us work with distributions including many commonly</span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a>used ones, truncated distributions (e.g. half-normal as</span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a><span class="in">`dist_truncated(dist_normal(mu = 0, sigma=2.5), lower=0)`</span>),</span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>distributions of transformed random variables (e.g.</span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a><span class="in">`dist_transformed(dist=dist_normal(0, 0.5), transform=exp, inverse=log) |&gt; mean()`</span>)</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>and mixture distributions (e.g.</span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a><span class="in">`dist_mixture(dist_normal(0, 1), dist_normal(1.5, 5), weights = c(0.5, 0.5))`</span>).</span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`distributional`</span> package, we can also obtain information on</span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a>distributions such as their mean, median, quantiles, variance, skewness</span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a>and so on (e.g. <span class="in">`dist_student_t(df=3, mu = 0, sigma = 1) |&gt; median()`</span>).</span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-339"><a href="#cb21-339" aria-hidden="true" tabindex="-1"></a>Now that we have a prior for the average true response proportion, we </span>
<span id="cb21-340"><a href="#cb21-340" aria-hidden="true" tabindex="-1"></a>consider how much the true proportion might vary from study to study. </span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a>To set a prior distribution on the between trial SD, we asked experts</span>
<span id="cb21-342"><a href="#cb21-342" aria-hidden="true" tabindex="-1"></a>about the narrowest and widest random effects distributions</span>
<span id="cb21-343"><a href="#cb21-343" aria-hidden="true" tabindex="-1"></a>they consider plausible. </span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a>When discussing with our experts, we fixed the </span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a>random effects mean to a plausible value to make it </span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a>easier for them to express their prior belief on a scale they are </span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a>comfortable on. We then assumed that the same distribution width is </span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a>approximately plausible for other mean values, too.</span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a>For a hypothetical scenario with an average true reponse proportion of 15\%,</span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>clinical experts expressed that it would be unlikely that a few</span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a>studies would not end up having a true responder proportion of 20\% and</span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a>that it is possible that variability could be so high that some could</span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>reach 40\%.</span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a>Thus, we considered that for the narrowest plausible random effects </span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a>distribution (conditional on the the middle of the distribution being 15\%),</span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a>there should be 2.5\% probability that studies could vary to 20\% or higher.</span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>Similarly, for the widest plausible distribution, we assigned 2.5% probability</span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a>that studies would vary to 40% or more. Normal distributions on the logit scale</span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a>that fulfill these criteria are shown in the figure below.</span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mu=</span><span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.68</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res=</span><span class="fu">map2</span>(mu, sigma, \(mu,sigma) <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>), <span class="at">y=</span><span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>), mu, sigma)))) <span class="sc">%&gt;%</span></span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouping =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>    (sigma<span class="sc">==</span><span class="fl">0.18</span> <span class="sc">&amp;</span> x<span class="sc">&gt;</span><span class="fu">qlogis</span>(<span class="fl">0.2</span>)) <span class="sc">~</span> <span class="dv">1</span>L,</span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>    sigma<span class="sc">==</span><span class="fl">0.18</span> <span class="sc">~</span> <span class="dv">2</span>L,</span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>    (x<span class="sc">&gt;</span><span class="fu">qlogis</span>(<span class="fl">0.4</span>)) <span class="sc">~</span> <span class="dv">3</span>L,</span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">4</span>L), <span class="at">levels=</span><span class="fu">rev</span>(<span class="dv">1</span>L<span class="sc">:</span><span class="dv">4</span>L))) <span class="sc">%&gt;%</span></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>y, <span class="at">col=</span>grouping,  <span class="at">fill=</span>grouping)) <span class="sc">+</span></span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a>  <span class="co">#stat_slab(slab_alpha=0.5, n=10000) +</span></span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.2</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">qlogis</span>(<span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>)),</span>
<span id="cb21-383"><a href="#cb21-383" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">round</span>(<span class="fu">qlogis</span>(<span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">="</span>, <span class="dv">100</span><span class="sc">*</span><span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb21-384"><a href="#cb21-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label),</span>
<span id="cb21-385"><a href="#cb21-385" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.62</span>, <span class="sc">-</span><span class="fl">1.4</span>, <span class="sc">-</span><span class="fl">1.1</span>, <span class="sc">-</span><span class="fl">0.9</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>), </span>
<span id="cb21-386"><a href="#cb21-386" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="fu">c</span>(<span class="st">"SD of 0.18"</span>,</span>
<span id="cb21-387"><a href="#cb21-387" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste0</span>(<span class="st">"P(probability&gt;=20%)="</span>,<span class="fu">round</span>(<span class="dv">100-100</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="at">q=</span><span class="fu">qlogis</span>(<span class="fl">0.2</span>), <span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="fl">0.18</span>),<span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb21-388"><a href="#cb21-388" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"SD of 0.68"</span>,</span>
<span id="cb21-389"><a href="#cb21-389" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste0</span>(<span class="st">"P(probability&gt;=40%)="</span>,<span class="fu">round</span>(<span class="dv">100-100</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="at">q=</span><span class="fu">qlogis</span>(<span class="fl">0.4</span>), <span class="fu">qlogis</span>(<span class="fl">0.15</span>), <span class="fl">0.68</span>),<span class="dv">1</span>), <span class="st">"%"</span>)),</span>
<span id="cb21-390"><a href="#cb21-390" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.68</span>, <span class="fl">0.68</span>), <span class="at">grouping=</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">2</span>L, <span class="dv">1</span>L, <span class="dv">4</span>L, <span class="dv">3</span>L), <span class="at">levels=</span><span class="fu">rev</span>(<span class="dv">1</span>L<span class="sc">:</span><span class="dv">4</span>L))), <span class="at">size=</span><span class="dv">6</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-391"><a href="#cb21-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"True logit-response-probability for new trial</span><span class="sc">\n</span><span class="st">given average trial is -1.73 (=15%)"</span>) <span class="sc">+</span></span>
<span id="cb21-392"><a href="#cb21-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>) <span class="sc">+</span></span>
<span id="cb21-393"><a href="#cb21-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"#E69F00"</span>, <span class="st">"darkblue"</span>, <span class="st">"#56B4E9"</span>))) <span class="sc">+</span></span>
<span id="cb21-394"><a href="#cb21-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"#E69F00"</span>, <span class="st">"darkblue"</span>, <span class="st">"#56B4E9"</span>))) <span class="sc">+</span></span>
<span id="cb21-395"><a href="#cb21-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Narrowest &amp; widest plausible random effects</span><span class="sc">\n</span><span class="st">distribution conditional on a mean of logit(0.15)"</span>)</span>
<span id="cb21-396"><a href="#cb21-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-397"><a href="#cb21-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-398"><a href="#cb21-398" aria-hidden="true" tabindex="-1"></a>Now, we translate these beliefs into a prior for the between-trial SD.</span>
<span id="cb21-399"><a href="#cb21-399" aria-hidden="true" tabindex="-1"></a>Given that we consider 0.18 and 0.68 as on the edge of what is plausible </span>
<span id="cb21-400"><a href="#cb21-400" aria-hidden="true" tabindex="-1"></a>for the between-trial SD, we pick a log-normal distribution for the </span>
<span id="cb21-401"><a href="#cb21-401" aria-hidden="true" tabindex="-1"></a>between-trial SD that has these two values approximately as its </span>
<span id="cb21-402"><a href="#cb21-402" aria-hidden="true" tabindex="-1"></a>2.5th and 97.5th percentiles. For such a normal distribution on the logit-scale </span>
<span id="cb21-403"><a href="#cb21-403" aria-hidden="true" tabindex="-1"></a>centered on logit(0.15), this implies a standard deviation of</span>
<span id="cb21-404"><a href="#cb21-404" aria-hidden="true" tabindex="-1"></a><span class="in">`(logit(0.2)-logit(0.15)) / qnorm(0.975)`</span> $\approx$ <span class="in">`r round((logit(0.2)-logit(0.15)) / qnorm(0.975),2)`</span> to</span>
<span id="cb21-405"><a href="#cb21-405" aria-hidden="true" tabindex="-1"></a><span class="in">`(logit(0.4)-logit(0.15)) / qnorm(0.975)`</span> $\approx$ <span class="in">`r round((logit(0.4)-logit(0.15)) / qnorm(0.975),2)`</span>. This can be</span>
<span id="cb21-406"><a href="#cb21-406" aria-hidden="true" tabindex="-1"></a>described by a log-normal prior distribution on the standard deviation</span>
<span id="cb21-407"><a href="#cb21-407" aria-hidden="true" tabindex="-1"></a>with location -1.06 and scale 0.35, as we can see by observing that</span>
<span id="cb21-408"><a href="#cb21-408" aria-hidden="true" tabindex="-1"></a>`dist_lognormal(mu = -1.06, sigma = 0.35) |&gt; quantile(p=c(0.025,</span>
<span id="cb21-409"><a href="#cb21-409" aria-hidden="true" tabindex="-1"></a>0.975)) |&gt; unlist()`</span>
<span id="cb21-410"><a href="#cb21-410" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb21-411"><a href="#cb21-411" aria-hidden="true" tabindex="-1"></a><span class="in">`r round(dist_lognormal(mu = -1.06, sigma = 0.35) |&gt; quantile(p=c(0.025, 0.975)) |&gt; unlist(), 3)`</span>.</span>
<span id="cb21-412"><a href="#cb21-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-415"><a href="#cb21-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-416"><a href="#cb21-416" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mu=</span><span class="sc">-</span><span class="fl">1.06</span>, <span class="at">sigma=</span><span class="fl">0.35</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-417"><a href="#cb21-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_lognormal</span>(<span class="at">mu=</span>mu, <span class="at">sigma=</span>sigma))) <span class="sc">+</span></span>
<span id="cb21-418"><a href="#cb21-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.18</span>, <span class="at">col=</span><span class="st">"#E69F00"</span>, <span class="at">linewidth=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-419"><a href="#cb21-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.68</span>, <span class="at">col=</span><span class="st">"#56B4E9"</span>, <span class="at">linewidth=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-420"><a href="#cb21-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span><span class="fu">tibble</span>(<span class="at">mu=</span><span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>), </span>
<span id="cb21-421"><a href="#cb21-421" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sigma=</span><span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.5</span>), </span>
<span id="cb21-422"><a href="#cb21-422" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="fu">c</span>(<span class="st">"SD of 0.18"</span>, <span class="st">"SD of 0.68"</span>)),</span>
<span id="cb21-423"><a href="#cb21-423" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>mu, <span class="at">y=</span>sigma, <span class="at">label=</span>label),</span>
<span id="cb21-424"><a href="#cb21-424" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="dv">6</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb21-425"><a href="#cb21-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">fill=</span><span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb21-426"><a href="#cb21-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>)) <span class="sc">+</span></span>
<span id="cb21-427"><a href="#cb21-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>) <span class="sc">+</span></span>
<span id="cb21-428"><a href="#cb21-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Between trial SD"</span>)</span>
<span id="cb21-429"><a href="#cb21-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-430"><a href="#cb21-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-431"><a href="#cb21-431" aria-hidden="true" tabindex="-1"></a>When asked how much lower the responder proportion over 52 vs. 12 weeks would </span>
<span id="cb21-432"><a href="#cb21-432" aria-hidden="true" tabindex="-1"></a>be, the clinicians judge it likely that the proportion would decline a little</span>
<span id="cb21-433"><a href="#cb21-433" aria-hidden="true" tabindex="-1"></a>bit. Their rationale was that while the disease does not progress fast enough</span>
<span id="cb21-434"><a href="#cb21-434" aria-hidden="true" tabindex="-1"></a>to change substantially over 9 months, a longer duration offers additional </span>
<span id="cb21-435"><a href="#cb21-435" aria-hidden="true" tabindex="-1"></a>opportunities for a low red blood cell count to occur (even if by chance) that</span>
<span id="cb21-436"><a href="#cb21-436" aria-hidden="true" tabindex="-1"></a>might lead to a blood transfusion.</span>
<span id="cb21-437"><a href="#cb21-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-438"><a href="#cb21-438" aria-hidden="true" tabindex="-1"></a>The resulting prior distribution looks as shown in the figure below.</span>
<span id="cb21-439"><a href="#cb21-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-442"><a href="#cb21-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-443"><a href="#cb21-443" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="sc">-</span><span class="fl">0.1</span>, <span class="at">sd=</span>.<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-444"><a href="#cb21-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb21-445"><a href="#cb21-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"#e7298a"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-446"><a href="#cb21-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)), </span>
<span id="cb21-447"><a href="#cb21-447" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>)), </span>
<span id="cb21-448"><a href="#cb21-448" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb21-449"><a href="#cb21-449" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lower</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"higher</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">2</span>)))) <span class="sc">+</span></span>
<span id="cb21-450"><a href="#cb21-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log-odds of response over 52 compared with 12 weeks"</span>) <span class="sc">+</span></span>
<span id="cb21-451"><a href="#cb21-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span>
<span id="cb21-452"><a href="#cb21-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-453"><a href="#cb21-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-454"><a href="#cb21-454" aria-hidden="true" tabindex="-1"></a>Finally, the clinicians were unsure whether a 52 week vs. a 12 week study</span>
<span id="cb21-455"><a href="#cb21-455" aria-hidden="true" tabindex="-1"></a>would result in a higher or lower log-odds-ratio for drug vs. placebo.</span>
<span id="cb21-456"><a href="#cb21-456" aria-hidden="true" tabindex="-1"></a>However, they expressed that the effect would be relatively small, because</span>
<span id="cb21-457"><a href="#cb21-457" aria-hidden="true" tabindex="-1"></a>the drug should not be disease modifying (i.e. treatment effect should not</span>
<span id="cb21-458"><a href="#cb21-458" aria-hidden="true" tabindex="-1"></a>grow over time) and there is no reason to speculate that the effect on </span>
<span id="cb21-459"><a href="#cb21-459" aria-hidden="true" tabindex="-1"></a>red blood cell counts would somehow decline over time, either. On this basis,</span>
<span id="cb21-460"><a href="#cb21-460" aria-hidden="true" tabindex="-1"></a>they expressed the following prior distribution:</span>
<span id="cb21-461"><a href="#cb21-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-464"><a href="#cb21-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-465"><a href="#cb21-465" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>.<span class="dv">1</span><span class="sc">/</span><span class="fl">1.96</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-466"><a href="#cb21-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_normal</span>(<span class="at">mu =</span> mean, <span class="at">sigma =</span> sd))) <span class="sc">+</span></span>
<span id="cb21-467"><a href="#cb21-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill=</span><span class="st">"royalblue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-468"><a href="#cb21-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)), </span>
<span id="cb21-469"><a href="#cb21-469" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>)), </span>
<span id="cb21-470"><a href="#cb21-470" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb21-471"><a href="#cb21-471" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lower</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"higher</span><span class="sc">\n</span><span class="st">odds"</span>, <span class="dv">2</span>)))) <span class="sc">+</span></span>
<span id="cb21-472"><a href="#cb21-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Change in log-odds ratio of drug vs. placebo</span><span class="sc">\n</span><span class="st">when increasing trial duration from 12 to 52 weeks"</span>) <span class="sc">+</span></span>
<span id="cb21-473"><a href="#cb21-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prior density"</span>)</span>
<span id="cb21-474"><a href="#cb21-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-475"><a href="#cb21-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-476"><a href="#cb21-476" aria-hidden="true" tabindex="-1"></a>Thus, we can set out prior distributions as below. To see what particular</span>
<span id="cb21-477"><a href="#cb21-477" aria-hidden="true" tabindex="-1"></a>coefficients are named, <span class="in">`get_prior(model_formula, our_data)`</span> is a useful</span>
<span id="cb21-478"><a href="#cb21-478" aria-hidden="true" tabindex="-1"></a>command.</span>
<span id="cb21-479"><a href="#cb21-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a>brms_prior <span class="ot">&lt;-</span> <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span>Intercept, <span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.67</span>, <span class="fl">1.0</span>)) <span class="sc">+</span> <span class="co"># prior average placebo effect </span></span>
<span id="cb21-484"><a href="#cb21-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>sd, <span class="at">coef=</span>Intercept, <span class="at">group=</span>trial, <span class="fu">lognormal</span>( <span class="sc">-</span><span class="fl">1.06</span>, <span class="fl">0.35</span>)) <span class="sc">+</span> <span class="co"># prior on the between-study SD in  placebo log-odds</span></span>
<span id="cb21-485"><a href="#cb21-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span>long_study, <span class="fu">normal</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="co"># prior for effect of long-study (26 vs. 12 weeks) on responder rate</span></span>
<span id="cb21-486"><a href="#cb21-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="at">class=</span>b, <span class="at">coef=</span><span class="st">"treatmentNVS101:long_study"</span>, <span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.1</span><span class="sc">/</span><span class="fl">1.96</span>)) <span class="sc">+</span> <span class="co"># Prior on the log-odds-ratio for drug vs. placebo when switching from shor to long study</span></span>
<span id="cb21-487"><a href="#cb21-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">mixnorm</span>(map_w, map_m, map_s), <span class="at">class=</span>b, <span class="at">coef=</span>treatmentNVS101) <span class="co">#  Syntax for specifying mixture prior</span></span>
<span id="cb21-488"><a href="#cb21-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-489"><a href="#cb21-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-490"><a href="#cb21-490" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb21-491"><a href="#cb21-491" aria-hidden="true" tabindex="-1"></a>**NOTE**: Thanks to the new functionality in the <span class="in">`RBesT`</span> package, we were able</span>
<span id="cb21-492"><a href="#cb21-492" aria-hidden="true" tabindex="-1"></a>to just write <span class="in">`prior(mixture_prior, class=b, coef=treatmentNVS10)`</span> to specify</span>
<span id="cb21-493"><a href="#cb21-493" aria-hidden="true" tabindex="-1"></a>a mixture prior. Alternatively, we could have written</span>
<span id="cb21-494"><a href="#cb21-494" aria-hidden="true" tabindex="-1"></a><span class="in">`prior(mixnorm(map_w, map_m, map_s), class=b, coef=treatmentNovDrug)`</span>. </span>
<span id="cb21-495"><a href="#cb21-495" aria-hidden="true" tabindex="-1"></a><span class="in">`map_w`</span>, <span class="in">`map_m`</span> and <span class="in">`map_s`</span> would specify the weights, means and standard</span>
<span id="cb21-496"><a href="#cb21-496" aria-hidden="true" tabindex="-1"></a>deviations of the mixture components, respectively. If we did not have this</span>
<span id="cb21-497"><a href="#cb21-497" aria-hidden="true" tabindex="-1"></a><span class="in">`RBesT`</span> functionality available, we would have to manually write down the</span>
<span id="cb21-498"><a href="#cb21-498" aria-hidden="true" tabindex="-1"></a>log-probability-density-function of the mixture, which involves weighted sums</span>
<span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a>on the probability scale e.g. using the <span class="in">`log_sum_exp`</span> function. For</span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a>further details on the <span class="in">`mixstanvars`</span> feature, please refer to its</span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">online manual</span><span class="co">](https://opensource.nibr.com/RBesT/reference/mixstanvar.html)</span>.</span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model fitting and predictions</span></span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fitmodel, results='hide',message=FALSE,warning=FALSE}</span></span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a>brmfit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula,</span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> our_data,</span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>               <span class="co"># By doing 11,000 samples per chain (default 4 chains) incl. 1000</span></span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>               <span class="co"># warmup samples, we'll get 4 * 10,000= 40,000 samples, which is</span></span>
<span id="cb21-511"><a href="#cb21-511" aria-hidden="true" tabindex="-1"></a>               <span class="co"># what we'll need in the PoS app.</span></span>
<span id="cb21-512"><a href="#cb21-512" aria-hidden="true" tabindex="-1"></a>               <span class="co">#iter = 11000, warmup=1000, </span></span>
<span id="cb21-513"><a href="#cb21-513" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Now we specify our prior distributions:</span></span>
<span id="cb21-514"><a href="#cb21-514" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> brms_prior,</span>
<span id="cb21-515"><a href="#cb21-515" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Note that we define "map=mixture_prior" below. This</span></span>
<span id="cb21-516"><a href="#cb21-516" aria-hidden="true" tabindex="-1"></a>               <span class="co"># matches the prefix "map" defined in the previous</span></span>
<span id="cb21-517"><a href="#cb21-517" aria-hidden="true" tabindex="-1"></a>               <span class="co"># prior definition statement:</span></span>
<span id="cb21-518"><a href="#cb21-518" aria-hidden="true" tabindex="-1"></a>               <span class="at">stanvars =</span> <span class="fu">mixstanvar</span>(<span class="at">map=</span>mixture_prior),</span>
<span id="cb21-519"><a href="#cb21-519" aria-hidden="true" tabindex="-1"></a>               <span class="at">control =</span> control_args,</span>
<span id="cb21-520"><a href="#cb21-520" aria-hidden="true" tabindex="-1"></a>               <span class="at">seed =</span> <span class="dv">5674574</span>,</span>
<span id="cb21-521"><a href="#cb21-521" aria-hidden="true" tabindex="-1"></a>               <span class="at">silent =</span> <span class="dv">2</span>, </span>
<span id="cb21-522"><a href="#cb21-522" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb21-523"><a href="#cb21-523" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb21-524"><a href="#cb21-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-525"><a href="#cb21-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-526"><a href="#cb21-526" aria-hidden="true" tabindex="-1"></a>We can now generate predictions for a new Phase 3 trial </span>
<span id="cb21-527"><a href="#cb21-527" aria-hidden="true" tabindex="-1"></a>for NVS101 compared with placebo of 52 week duration. While the predictions</span>
<span id="cb21-528"><a href="#cb21-528" aria-hidden="true" tabindex="-1"></a>for each arm of the new trial are by default for the true log-odds of response,</span>
<span id="cb21-529"><a href="#cb21-529" aria-hidden="true" tabindex="-1"></a>we can derive all desired quantities from this:</span>
<span id="cb21-530"><a href="#cb21-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-531"><a href="#cb21-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ph3preds}</span></span>
<span id="cb21-532"><a href="#cb21-532" aria-hidden="true" tabindex="-1"></a><span class="co"># we are using the inv_logit function on rvars for which we need to</span></span>
<span id="cb21-533"><a href="#cb21-533" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare the funnction to handle rvar arguments</span></span>
<span id="cb21-534"><a href="#cb21-534" aria-hidden="true" tabindex="-1"></a>rvar_inv_logit <span class="ot">&lt;-</span> <span class="fu">rfun</span>(inv_logit)</span>
<span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>new_ph3_trial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial=</span><span class="st">"New trial"</span>,</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a>                        <span class="at">treatment=</span><span class="fu">c</span>(<span class="st">"placebo"</span>, <span class="st">"NVS101"</span>),</span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a>                        <span class="at">long_study=</span><span class="dv">1</span>,</span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a>                        <span class="at">patients=</span><span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>))</span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a>ph3_predictions <span class="ot">&lt;-</span> new_ph3_trial <span class="sc">|&gt;</span></span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_linpred_rvars</span>(brmfit1,</span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>,</span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">value=</span><span class="st">"logodds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion=</span><span class="fu">rvar_inv_logit</span>(logodds))</span>
<span id="cb21-547"><a href="#cb21-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-548"><a href="#cb21-548" aria-hidden="true" tabindex="-1"></a><span class="co"># One can have tibbles contain columns of rvars, which one can</span></span>
<span id="cb21-549"><a href="#cb21-549" aria-hidden="true" tabindex="-1"></a><span class="co"># recognize by the reported mean and standard deviation of the</span></span>
<span id="cb21-550"><a href="#cb21-550" aria-hidden="true" tabindex="-1"></a><span class="co"># sample they represent:</span></span>
<span id="cb21-551"><a href="#cb21-551" aria-hidden="true" tabindex="-1"></a>ph3_predictions</span>
<span id="cb21-552"><a href="#cb21-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-553"><a href="#cb21-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-554"><a href="#cb21-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-555"><a href="#cb21-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-556"><a href="#cb21-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results</span></span>
<span id="cb21-557"><a href="#cb21-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-558"><a href="#cb21-558" aria-hidden="true" tabindex="-1"></a>Here is a plot of the predicted Phase 3 placebo and NVS101 responder</span>
<span id="cb21-559"><a href="#cb21-559" aria-hidden="true" tabindex="-1"></a>proportion.</span>
<span id="cb21-560"><a href="#cb21-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-563"><a href="#cb21-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-564"><a href="#cb21-564" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ph3_predictions,</span>
<span id="cb21-565"><a href="#cb21-565" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tibble</span>(<span class="at">proportion_NVS101  =</span> proportion[<span class="dv">2</span>],</span>
<span id="cb21-566"><a href="#cb21-566" aria-hidden="true" tabindex="-1"></a>            <span class="at">proportion_placebo =</span> proportion[<span class="dv">1</span>])) <span class="sc">|&gt;</span></span>
<span id="cb21-567"><a href="#cb21-567" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">unnest_rvars</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-568"><a href="#cb21-568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>proportion_placebo, <span class="at">y=</span>proportion_NVS101)) <span class="sc">+</span></span>
<span id="cb21-569"><a href="#cb21-569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb21-570"><a href="#cb21-570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_continuous</span>() <span class="sc">+</span></span>
<span id="cb21-571"><a href="#cb21-571" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-573"><a href="#cb21-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-574"><a href="#cb21-574" aria-hidden="true" tabindex="-1"></a>Additionally, we can look at various measures of a treatment effect:</span>
<span id="cb21-575"><a href="#cb21-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-578"><a href="#cb21-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-579"><a href="#cb21-579" aria-hidden="true" tabindex="-1"></a>ph3_predictions <span class="sc">|&gt;</span></span>
<span id="cb21-580"><a href="#cb21-580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist=</span>proportion)) <span class="sc">+</span></span>
<span id="cb21-581"><a href="#cb21-581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb21-582"><a href="#cb21-582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment, <span class="at">labeller=</span>label_both, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb21-583"><a href="#cb21-583" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Proportion"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-584"><a href="#cb21-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-585"><a href="#cb21-585" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ph3_predictions,</span>
<span id="cb21-586"><a href="#cb21-586" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tibble</span>(<span class="at">measure=</span><span class="fu">c</span>(<span class="st">"logodds"</span>, <span class="st">"lograte"</span>, <span class="st">"proportion_diff"</span>),</span>
<span id="cb21-587"><a href="#cb21-587" aria-hidden="true" tabindex="-1"></a>            <span class="at">posterior=</span><span class="fu">c</span>(<span class="fu">diff</span>(logodds),</span>
<span id="cb21-588"><a href="#cb21-588" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">diff</span>(<span class="fu">log</span>(proportion)),</span>
<span id="cb21-589"><a href="#cb21-589" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">diff</span>(proportion)),</span>
<span id="cb21-590"><a href="#cb21-590" aria-hidden="true" tabindex="-1"></a>            <span class="at">ref=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb21-591"><a href="#cb21-591" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">|&gt;</span></span>
<span id="cb21-592"><a href="#cb21-592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist=</span>posterior)) <span class="sc">+</span></span>
<span id="cb21-593"><a href="#cb21-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb21-594"><a href="#cb21-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span>ref), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb21-595"><a href="#cb21-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>measure, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb21-596"><a href="#cb21-596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-597"><a href="#cb21-597" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb21-598"><a href="#cb21-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-599"><a href="#cb21-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-600"><a href="#cb21-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-601"><a href="#cb21-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-602"><a href="#cb21-602" aria-hidden="true" tabindex="-1"></a>Let's say the target product profile (TPP) for the drug demands a risk difference</span>
<span id="cb21-603"><a href="#cb21-603" aria-hidden="true" tabindex="-1"></a>of &gt;= 45\%. We can simulate Phase III outcomes to find the probability of </span>
<span id="cb21-604"><a href="#cb21-604" aria-hidden="true" tabindex="-1"></a>meeting this TPP and having a significant study, which the Novartis internal</span>
<span id="cb21-605"><a href="#cb21-605" aria-hidden="true" tabindex="-1"></a>PoS app would do for us.</span>
<span id="cb21-606"><a href="#cb21-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-607"><a href="#cb21-607" aria-hidden="true" tabindex="-1"></a>Note that the relativley compact code below does indeed perform a full</span>
<span id="cb21-608"><a href="#cb21-608" aria-hidden="true" tabindex="-1"></a>trial simulation for possible outcomes for every draw of the</span>
<span id="cb21-609"><a href="#cb21-609" aria-hidden="true" tabindex="-1"></a>posterior. The use of <span class="in">`rvars`</span> hides essentially that we are handling</span>
<span id="cb21-610"><a href="#cb21-610" aria-hidden="true" tabindex="-1"></a>entire posteriors here. However, note that we have to wrap the call to</span>
<span id="cb21-611"><a href="#cb21-611" aria-hidden="true" tabindex="-1"></a>the <span class="in">`fisher.test`</span> funcntion into <span class="in">`rdo`</span> such that the expression is</span>
<span id="cb21-612"><a href="#cb21-612" aria-hidden="true" tabindex="-1"></a>automatically evaluated for each draw of the posterior.</span>
<span id="cb21-613"><a href="#cb21-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-616"><a href="#cb21-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-617"><a href="#cb21-617" aria-hidden="true" tabindex="-1"></a>pos_simulations <span class="ot">&lt;-</span> new_ph3_trial <span class="sc">|&gt;</span></span>
<span id="cb21-618"><a href="#cb21-618" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_predicted_rvars</span>(brmfit1,</span>
<span id="cb21-619"><a href="#cb21-619" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb21-620"><a href="#cb21-620" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>,</span>
<span id="cb21-621"><a href="#cb21-621" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">value=</span><span class="st">"pred"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-622"><a href="#cb21-622" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predrate=</span>pred<span class="sc">/</span>patients) <span class="sc">|&gt;</span></span>
<span id="cb21-623"><a href="#cb21-623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatment, pred, predrate, patients) <span class="sc">|&gt;</span></span>
<span id="cb21-624"><a href="#cb21-624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"treatment"</span>, <span class="at">values_from=</span><span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"predrate"</span>, <span class="st">"patients"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-625"><a href="#cb21-625" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">riskdiff_crit =</span> predrate_NVS101 <span class="sc">-</span> predrate_placebo <span class="sc">&gt;=</span> <span class="fl">0.45</span>,</span>
<span id="cb21-626"><a href="#cb21-626" aria-hidden="true" tabindex="-1"></a>           <span class="at">pvalue =</span> <span class="fu">rdo</span>(<span class="fu">fisher.test</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="fu">c</span>(pred_NVS101,  patients_NVS101  <span class="sc">-</span> pred_NVS101,</span>
<span id="cb21-627"><a href="#cb21-627" aria-hidden="true" tabindex="-1"></a>                                               pred_placebo, patients_placebo <span class="sc">-</span> pred_placebo ),</span>
<span id="cb21-628"><a href="#cb21-628" aria-hidden="true" tabindex="-1"></a>                                             <span class="dv">2</span>, <span class="dv">2</span> ) )[[<span class="st">"p.value"</span>]] ),</span>
<span id="cb21-629"><a href="#cb21-629" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving &gt;= 45% risk difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(riskdiff_crit),</span>
<span id="cb21-630"><a href="#cb21-630" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving significance (p&lt;=0.05)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>),</span>
<span id="cb21-631"><a href="#cb21-631" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Achieving significance &amp; TPP target</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">E</span>(riskdiff_crit <span class="sc">*</span> (pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>))</span>
<span id="cb21-632"><a href="#cb21-632" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb21-633"><a href="#cb21-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-634"><a href="#cb21-634" aria-hidden="true" tabindex="-1"></a>pos_simulations <span class="sc">|&gt;</span></span>
<span id="cb21-635"><a href="#cb21-635" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Achieving"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-636"><a href="#cb21-636" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">everything</span>(), <span class="at">names_to=</span><span class="st">"Outcome"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-637"><a href="#cb21-637" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-638"><a href="#cb21-638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">3</span>)</span>
<span id="cb21-639"><a href="#cb21-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-640"><a href="#cb21-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-641"><a href="#cb21-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-642"><a href="#cb21-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-643"><a href="#cb21-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-644"><a href="#cb21-644" aria-hidden="true" tabindex="-1"></a>As we can see, achieving the TPP risk difference is the greater hurdle than</span>
<span id="cb21-645"><a href="#cb21-645" aria-hidden="true" tabindex="-1"></a>achieving statistical significance.</span>
<span id="cb21-646"><a href="#cb21-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-647"><a href="#cb21-647" aria-hidden="true" tabindex="-1"></a>As part of the Novartis PoS framework, we would now account for</span>
<span id="cb21-648"><a href="#cb21-648" aria-hidden="true" tabindex="-1"></a>the possibility of not obtaining an approval despite a positive Phase 3 study,</span>
<span id="cb21-649"><a href="#cb21-649" aria-hidden="true" tabindex="-1"></a>a failure in Phase 3 due to a safety issue, and other risks (e.g. relating</span>
<span id="cb21-650"><a href="#cb21-650" aria-hidden="true" tabindex="-1"></a>to drug manufacturing or market access).</span>
<span id="cb21-651"><a href="#cb21-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-652"><a href="#cb21-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-653"><a href="#cb21-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb21-654"><a href="#cb21-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-655"><a href="#cb21-655" aria-hidden="true" tabindex="-1"></a>In the hypothetical case study, there was not a lot of data, but what there was </span>
<span id="cb21-656"><a href="#cb21-656" aria-hidden="true" tabindex="-1"></a>appeared to be promising. Thus, one would not want to ignore it. </span>
<span id="cb21-657"><a href="#cb21-657" aria-hidden="true" tabindex="-1"></a>In order to make use of it, we had to use informative prior distributions for </span>
<span id="cb21-658"><a href="#cb21-658" aria-hidden="true" tabindex="-1"></a>several parameters of a logistic regression model. In this kind of situation,</span>
<span id="cb21-659"><a href="#cb21-659" aria-hidden="true" tabindex="-1"></a>where we cannot let data inform our prior distributions, there is little choice,</span>
<span id="cb21-660"><a href="#cb21-660" aria-hidden="true" tabindex="-1"></a>if we want an answer using the available data.</span>
<span id="cb21-661"><a href="#cb21-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-662"><a href="#cb21-662" aria-hidden="true" tabindex="-1"></a>Given how our prior judgments directly affect the inference, we want ot ensure </span>
<span id="cb21-663"><a href="#cb21-663" aria-hidden="true" tabindex="-1"></a>that the prior judgements reflect our best understanding of the</span>
<span id="cb21-664"><a href="#cb21-664" aria-hidden="true" tabindex="-1"></a>available scientific evidence. For this purpose a formal prior elicitation</span>
<span id="cb21-665"><a href="#cb21-665" aria-hidden="true" tabindex="-1"></a>(or predictions for some parameters from historical data) are options, but</span>
<span id="cb21-666"><a href="#cb21-666" aria-hidden="true" tabindex="-1"></a>when those are not possibler, we should still try to ensure that prior choices</span>
<span id="cb21-667"><a href="#cb21-667" aria-hidden="true" tabindex="-1"></a>are plausible to the whole team.</span>
<span id="cb21-668"><a href="#cb21-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-669"><a href="#cb21-669" aria-hidden="true" tabindex="-1"></a>Note that in this example, there was also an underlying laboratory measurement</span>
<span id="cb21-670"><a href="#cb21-670" aria-hidden="true" tabindex="-1"></a>(longitudinal measurements of red blood cell counts). It might have been more</span>
<span id="cb21-671"><a href="#cb21-671" aria-hidden="true" tabindex="-1"></a>efficient to work with these directly, but it would have been necessary </span>
<span id="cb21-672"><a href="#cb21-672" aria-hidden="true" tabindex="-1"></a>to translate any results into predictions for the Phase III responder endpoint.</span>
<span id="cb21-673"><a href="#cb21-673" aria-hidden="true" tabindex="-1"></a>Furthermore, the published external competitor data might not report these</span>
<span id="cb21-674"><a href="#cb21-674" aria-hidden="true" tabindex="-1"></a>laboratory outcomes in sufficient detail.</span>
<span id="cb21-675"><a href="#cb21-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-676"><a href="#cb21-676" aria-hidden="true" tabindex="-1"></a>Single arm studies are not ideal. However, when treatment effects are large</span>
<span id="cb21-677"><a href="#cb21-677" aria-hidden="true" tabindex="-1"></a>compared to how much placebo group outcomes vary, we can still learn</span>
<span id="cb21-678"><a href="#cb21-678" aria-hidden="true" tabindex="-1"></a>about drug efficacy from them at the cost of additional assumptions.</span>
<span id="cb21-679"><a href="#cb21-679" aria-hidden="true" tabindex="-1"></a>As part of our case study, we tried to be explicit about our </span>
<span id="cb21-680"><a href="#cb21-680" aria-hidden="true" tabindex="-1"></a>uncertainties and to transparently describe our prior judgements, as well as </span>
<span id="cb21-681"><a href="#cb21-681" aria-hidden="true" tabindex="-1"></a>the rationale behind them. If someone disagrees with some of our prior </span>
<span id="cb21-682"><a href="#cb21-682" aria-hidden="true" tabindex="-1"></a>distributions, they can then do a sensitivity analysis.</span>
<span id="cb21-683"><a href="#cb21-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-684"><a href="#cb21-684" aria-hidden="true" tabindex="-1"></a>A Bayesian approach is also well-suited for PoS calculations, because it lets</span>
<span id="cb21-685"><a href="#cb21-685" aria-hidden="true" tabindex="-1"></a>us easily propagate uncertainties through different steps of a PoS analysis.</span>
<span id="cb21-686"><a href="#cb21-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-687"><a href="#cb21-687" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb21-688"><a href="#cb21-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-689"><a href="#cb21-689" aria-hidden="true" tabindex="-1"></a>To be added</span>
<span id="cb21-690"><a href="#cb21-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-691"><a href="#cb21-691" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {.unnumbered}</span></span>
<span id="cb21-692"><a href="#cb21-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-693"><a href="#cb21-693" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb21-694"><a href="#cb21-694" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Novartis/bamdd/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>