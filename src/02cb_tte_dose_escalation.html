<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lukas Widmer - lukas_andreas.widmer@novartis.com">
<meta name="author" content="Sebastian Weber - sebastian.weber@novartis.com">

<title>10&nbsp; Time-to-event modelling in Oncology dose escalation – Applied Modelling in Drug Development</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../src/02e_multiple_imputation.html" rel="next">
<link href="../src/02c_dose_escalation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b619e7580ba2a849d98fc8631a679bb4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="../site_libs/react-18.2.0/react.min.js"></script>
<script src="../site_libs/react-18.2.0/react-dom.min.js"></script>
<script src="../site_libs/reactwidget-2.0.0/react-tools.js"></script>
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="../site_libs/reactable-binding-0.4.4/reactable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="../resources/mathjax/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../bamdd.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../src/02_case_studies.html">Case studies</a></li><li class="breadcrumb-item"><a href="../src/02cb_tte_dose_escalation.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Time-to-event modelling in Oncology dose escalation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../bamdd_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Applied Modelling in Drug Development</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Novartis/bamdd/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01a_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01b_basic_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/01c_priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model setup &amp; priors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../src/02_case_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case studies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02a_meta_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Use of historical control data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02ab_meta_analysis_trtdiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis to estimate treatment effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02ac_meta_analysis_strata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Use of historical control data with stratification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02l_single_arm_pos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability of success from a single arm trial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02b_dose_finding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dose finding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02c_dose_escalation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Oncology dose escalation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02cb_tte_dose_escalation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Time-to-event modelling in Oncology dose escalation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02e_multiple_imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple imputation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02g_longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Longitudinal data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02h_mmrm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Bayesian Mixed effects Model for Repeated Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02i_time_to_event.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Time-to-event data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/02j_network_meta_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Network meta-analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/03a_stan_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Exposing stan code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/03b_parallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Parallel computation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">10.1</span> Background</a></li>
  <li><a href="#required-libraries" id="toc-required-libraries" class="nav-link" data-scroll-target="#required-libraries"><span class="header-section-number">10.2</span> Required libraries</a></li>
  <li><a href="#example-trial" id="toc-example-trial" class="nav-link" data-scroll-target="#example-trial"><span class="header-section-number">10.3</span> Example trial</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">10.4</span> Data</a></li>
  <li><a href="#model-description" id="toc-model-description" class="nav-link" data-scroll-target="#model-description"><span class="header-section-number">10.5</span> Model description</a>
  <ul class="collapse">
  <li><a href="#model-definition" id="toc-model-definition" class="nav-link" data-scroll-target="#model-definition"><span class="header-section-number">10.5.1</span> Model definition</a></li>
  <li><a href="#model-prior" id="toc-model-prior" class="nav-link" data-scroll-target="#model-prior"><span class="header-section-number">10.5.2</span> Model prior</a></li>
  </ul></li>
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation"><span class="header-section-number">10.6</span> Implementation</a>
  <ul class="collapse">
  <li><a href="#computing-conditional-and-cumulative-dlt-probabilities-for-a-given-dosing-schedule" id="toc-computing-conditional-and-cumulative-dlt-probabilities-for-a-given-dosing-schedule" class="nav-link" data-scroll-target="#computing-conditional-and-cumulative-dlt-probabilities-for-a-given-dosing-schedule"><span class="header-section-number">10.6.1</span> Computing conditional and cumulative DLT probabilities for a given dosing schedule</a></li>
  <li><a href="#dose-escalation-decisions" id="toc-dose-escalation-decisions" class="nav-link" data-scroll-target="#dose-escalation-decisions"><span class="header-section-number">10.6.2</span> Dose escalation decisions</a></li>
  <li><a href="#sec-onco-tte-prior-vis" id="toc-sec-onco-tte-prior-vis" class="nav-link" data-scroll-target="#sec-onco-tte-prior-vis"><span class="header-section-number">10.6.3</span> Visualizing the model prior</a></li>
  </ul></li>
  <li><a href="#examining-the-model-posterior" id="toc-examining-the-model-posterior" class="nav-link" data-scroll-target="#examining-the-model-posterior"><span class="header-section-number">10.7</span> Examining the model posterior</a>
  <ul class="collapse">
  <li><a href="#inference-for-model-parameters" id="toc-inference-for-model-parameters" class="nav-link" data-scroll-target="#inference-for-model-parameters"><span class="header-section-number">10.7.1</span> Inference for model parameters</a></li>
  <li><a href="#inference-for-conditional-and-cumulative-dlt-probabilities" id="toc-inference-for-conditional-and-cumulative-dlt-probabilities" class="nav-link" data-scroll-target="#inference-for-conditional-and-cumulative-dlt-probabilities"><span class="header-section-number">10.7.2</span> Inference for conditional and cumulative DLT probabilities</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">10.8</span> Conclusion</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">10.9</span> Exercise</a></li>
  <li><a href="#sec-onco-tte-appendix" id="toc-sec-onco-tte-appendix" class="nav-link" data-scroll-target="#sec-onco-tte-appendix"><span class="header-section-number">10.10</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#model-derivation" id="toc-model-derivation" class="nav-link" data-scroll-target="#model-derivation"><span class="header-section-number">10.10.1</span> Model derivation</a></li>
  <li><a href="#definitions-from-survival-analysis" id="toc-definitions-from-survival-analysis" class="nav-link" data-scroll-target="#definitions-from-survival-analysis"><span class="header-section-number">10.10.2</span> Definitions from Survival Analysis</a></li>
  <li><a href="#model-definition-1" id="toc-model-definition-1" class="nav-link" data-scroll-target="#model-definition-1"><span class="header-section-number">10.10.3</span> Model definition</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Novartis/bamdd/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../src/02_case_studies.html">Case studies</a></li><li class="breadcrumb-item"><a href="../src/02cb_tte_dose_escalation.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Time-to-event modelling in Oncology dose escalation</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-tte-oncology" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Time-to-event modelling in Oncology dose escalation</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Lukas Widmer - <a href="mailto:lukas_andreas.widmer@novartis.com" class="email">lukas_andreas.widmer@novartis.com</a> </p>
             <p>Sebastian Weber - <a href="mailto:sebastian.weber@novartis.com" class="email">sebastian.weber@novartis.com</a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<!-- https://raw.githubusercontent.com/Novartis/bamdd/main/src/_macros.qmd -->
<p>This case study demonstrates</p>
<ul>
<li>setting up a time-to-event model and prior with explicit modeling of a piecewise-constant log-hazard in <code>brms</code> using Poisson regression</li>
<li>how this time-to-event model relates to the standard BLRM</li>
<li>computing and visualizing conditional and cumulative event probabilities</li>
<li>how to determine the impact of the Monte Carlo Standard Error (MCSE) on decision criteria, e.g., Escalation With Overdose Control (EWOC)</li>
<li>in the exercise: setting up custom <code>brms</code> link functions for the two-drug case</li>
</ul>
<section id="background" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="background"><span class="header-section-number">10.1</span> Background</h2>
<p>The aim of Oncology Phase-I trials is to identify a drug dose which is reasonable safe to use and efficacious at the same time. As cytotoxic drugs aim to kill cancer cells, it is expected that toxicity events are to some extent a surrogate for efficacy of the drug. Due to the life-threatening nature of the disease one thereby uses <em>dose escalation</em> trial designs to identify the maximum tolerated dose (MTD) or recommended dose (RD) rapidly. These trials enroll small patient cohorts at some drug dose and then assess at a dose escalation meeting (DEM) all safety events occurring over the time-course of a treatment cycle (often 4 weeks). The safety events classified as dose limiting toxicities (DLTs) then determine which dose levels are safe for use in the next patient cohort. In this way an increasing data set on the toxicity of the drug emerges as the trial continues.</p>
<p>There are many approaches on how to guide dose escalation trials at a DEM. Traditional designs such as the 3+3 design are based on algorithmic rules governing the decision for the subsequent cohort based on the outcome at the current dose. Specifically, 3 patients are enrolled onto a cohort and the drug dose is increased in case no DLT occurs, if 1 DLT occurs the drug dose is kept constant while it is decreased if more DLTs occur. Whenever two cohorts in sequence observe 1 out of 3, the 3+3 trial completes. This is in line with the goal of a 33% DLT rate at the MTD. It has been shown that these rule-based approaches have rather poor statistical properties and model based approaches have been proposed. In particular, Bayesian model-based designs have proven to provide greater flexibility and improved performance for estimating the MTD, while protecting patient safety. In the model-based paradigm for dose escalation, one develops a model for the dose-toxicity relationship. As DLT data accumulates on-study, the model is used to adaptively guide dose escalation decisions. Bayesian approaches are well-suited for this setting, due in part to the limited amount of available data (Phase-I studies are generally small).</p>
<p>Recent, more targeted treatments, have challenged several aspects taken for granted for traditional cytotoxic therapies, such as</p>
<ul>
<li><strong>Estimating the MTD over just one treatment cycle</strong>: since targeted therapies are typically safer than cytotoxic ones and are applied over longer time periods, estimating longer-term (multi-cycle) dose-toxicity relationships has become more important. However, we typically do not want to wait for the full time period (e.g., 3 cycles) to decide the dose for the next cohort. That is, after the first cycle, one may want to extrapolate to the dose-toxicity relationship over 3 cycles given a prior on how the conditional toxicity of the next cycles changes with respect to the first one. However, this is not easily feasible with methods that only use binary (DLT yes/no) data.</li>
<li><strong>Constant dosing regimen</strong>: For some targeted treatments it may be advantageous to vary the dosing regimen, for instance, by performing within-patient dose-ramp-up over several weeks to avoid cytokine release syndrome. However, classical binary cycle-1 methods such as the 3+3, BOIN or the Bayesian Logistic Regression Model (BLRM) are not able to directly incorporate time-varying dosing or hazard reductions due to ramp-up dosing.</li>
<li><strong>Ignoring dropout</strong>: In classical binary dose-DLT methods, where DLT yes/no was measured for each patient over the first treatment cycle, data from patients that dropped out during this cycle (for instance due to disease progression) is typically ignored. This is no longer an option with modern cancer treatments in Phase I that are both taken over longer time periods where dropout is more likely, as well as administered in last-line treatment populations with aggressive cancers / rapid dropout due to disease progression.</li>
</ul>
<p>These challenges can be addressed by switching to time-to-first-event (time-to-DLT) modeling with piecewise-constant hazards, where the constant period is chosen to align with a period of interest. For instance, if the dose-toxicity relationship over 3 cycles is of interest, one might choose to model piecewise-constant hazards per cycle, or if we are interested in the dose-toxicity relationship of several regimens that contain within-patient ramp-up of dosing on a weekly basis, we might choose piecewise-constant hazards for each week.</p>
</section>
<section id="required-libraries" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="required-libraries"><span class="header-section-number">10.2</span> Required libraries</h2>
<p>To run the R code of this section please ensure to load these libraries and options first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(assertthat)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="dv">12</span>))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># instruct brms to use cmdstanr as backend and cache all Stan binaries</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>, <span class="at">cmdstanr_write_stan_file_dir=</span><span class="fu">here</span>(<span class="st">"_brms-cache"</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create cache directory if not yet available</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">"_brms-cache"</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8794567</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Table formatting helper function:</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>gt_format <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_interactive</span>(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">page_size_default =</span> <span class="dv">5</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_text_wrapping =</span> F, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_compact_mode =</span> T</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-trial" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="example-trial"><span class="header-section-number">10.3</span> Example trial</h2>
<p>In the following, we will assume a simple setting of a first-in-human (FIH) study of a new Oncology treatment. Here, we consider the dose-DLT relationship over a time horizon of 3 treatment cycles, a cycle length of 4 weeks, and daily (QD) dosing of a drug A at a pre-defined dose set with reference dose <span class="math inline">\(\tilde{d} = 50\)</span> (at the reference dose we anticipate the MTD <em>a priori</em>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cycle_lengths <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">weeks</span>(<span class="dv">4</span>), <span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dref_A <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>doses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">50</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cycle_seq <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(cycle_lengths)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dose_seq  <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(doses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the logarithm of the normalized dose (with respect to a reference dose <span class="math inline">\(\tilde{d}\)</span> ), <span class="math inline">\(\log\left(\tilde{d}_{j}\right) =
\log\left(d_{j} / \tilde{d}\right)\)</span>, where <span class="math inline">\(j\)</span> is the cycle index. We define a helper function to add this column as <code>std_A</code>, and whether the log-dose is finite as <code>finite_A</code>, which will become relevant in the case of drug combinations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>add_std_dose_col <span class="ot">&lt;-</span> <span class="cf">function</span>(dose_info, <span class="at">drug =</span> <span class="st">"A"</span>, dref) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dose_info <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"std_{drug}"</span>    <span class="sc">:</span><span class="er">=</span> <span class="fu">log</span>(<span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"dose_"</span>, drug)) <span class="sc">/</span> dref), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"finite_{drug}"</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span>L <span class="sc">*</span> (<span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"dose_"</span>, drug)) <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="data"><span class="header-section-number">10.4</span> Data</h2>
<p>We now need individual patient data (IPD) containing:</p>
<ul>
<li>The doses planned to be administered in each of the three cycles,</li>
<li>The start and end dates of each cycle</li>
<li>The date of censoring (either at the end of the last cycle due to end of the observation period, or during the trial due to dropout)</li>
<li>The date of DLT</li>
</ul>
<p>As an example, we create 3-cycle data in long format reflecting the data used in the BLRM dose escalation case study:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single patient</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>example_ipd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle_index =</span> cycle_seq,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dose_A =</span> <span class="dv">1</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_toxicities =</span> <span class="dv">0</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">follow_up =</span> <span class="fu">as.numeric</span>(cycle_lengths, <span class="st">"days"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create long-format individual-patient data (IPD) corresponding to the one </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># in the BLRM dose escalation case study</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ipd <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">3</span>)),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">4</span>)),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">5</span>)   <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">5</span>)),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">10</span>)  <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">4</span>)),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">25</span>, <span class="at">num_toxicities =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ipd <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="mjruticued" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mjruticued table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mjruticued thead, #mjruticued tbody, #mjruticued tfoot, #mjruticued tr, #mjruticued td, #mjruticued th {
  border-style: none;
}

#mjruticued p {
  margin: 0;
  padding: 0;
}

#mjruticued .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mjruticued .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mjruticued .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mjruticued .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mjruticued .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mjruticued .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mjruticued .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mjruticued .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mjruticued .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mjruticued .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mjruticued .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mjruticued .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mjruticued .gt_spanner_row {
  border-bottom-style: hidden;
}

#mjruticued .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mjruticued .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mjruticued .gt_from_md > :first-child {
  margin-top: 0;
}

#mjruticued .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mjruticued .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mjruticued .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mjruticued .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mjruticued .gt_row_group_first td {
  border-top-width: 2px;
}

#mjruticued .gt_row_group_first th {
  border-top-width: 2px;
}

#mjruticued .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mjruticued .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mjruticued .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mjruticued .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mjruticued .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mjruticued .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mjruticued .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mjruticued .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mjruticued .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mjruticued .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mjruticued .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mjruticued .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mjruticued .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mjruticued .gt_left {
  text-align: left;
}

#mjruticued .gt_center {
  text-align: center;
}

#mjruticued .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mjruticued .gt_font_normal {
  font-weight: normal;
}

#mjruticued .gt_font_bold {
  font-weight: bold;
}

#mjruticued .gt_font_italic {
  font-style: italic;
}

#mjruticued .gt_super {
  font-size: 65%;
}

#mjruticued .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mjruticued .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mjruticued .gt_indent_1 {
  text-indent: 5px;
}

#mjruticued .gt_indent_2 {
  text-indent: 10px;
}

#mjruticued .gt_indent_3 {
  text-indent: 15px;
}

#mjruticued .gt_indent_4 {
  text-indent: 20px;
}

#mjruticued .gt_indent_5 {
  text-indent: 25px;
}

#mjruticued .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mjruticued div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="mjruticued" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="mjruticued">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"cycle_index":[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,1],"dose_A":[1,1,1,1,1,1,1,1,1,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,10,10,10,10,10,10,10,10,10,10,10,10,25,25],"num_toxicities":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],"follow_up":[28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],"std_A":[-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-3.91202300542815,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.99573227355399,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-2.30258509299405,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-1.6094379124341,-0.693147180559945,-0.693147180559945],"finite_A":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"columns":[{"id":"cycle_index","name":"cycle_index","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","1.00"],"html":true,"align":"right"},{"id":"dose_A","name":"dose_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","2.50","2.50","2.50","2.50","2.50","2.50","2.50","2.50","2.50","2.50","2.50","2.50","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","5.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","10.00","25.00","25.00"],"html":true,"align":"right"},{"id":"num_toxicities","name":"num_toxicities","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","1.00","1.00"],"html":true,"align":"right"},{"id":"follow_up","name":"follow_up","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00"],"html":true,"align":"right"},{"id":"std_A","name":"std_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["−3.91","−3.91","−3.91","−3.91","−3.91","−3.91","−3.91","−3.91","−3.91","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−3.00","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−2.30","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−1.61","−0.69","−0.69"],"html":true,"align":"right"},{"id":"finite_A","name":"finite_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"}],"defaultPageSize":5,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"compact":true,"nowrap":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"font-family":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"mjruticued","dataKey":"bc2bff3d07d703b0e7474a75009f4b0d"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style","tag.attribs.columns.5.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<p>We define dosing schedules that we want to compute DLT probabilities for. Here, we choose schedules that are constant over all three cycles:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dosing information per cycle</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dose_info_long <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">schedule_id =</span> dose_seq, <span class="at">cycle =</span> cycle_seq) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose_A =</span> doses[schedule_id])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cycle information</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>cycle_info <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle =</span> cycle_seq, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">follow_up =</span> <span class="fu">as.numeric</span>(cycle_lengths, <span class="st">"days"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD We also generate a reference dosing data set which is formatted like an analysis data set, but is only setup to evaluate the final model on the predefined set of doses. These will be needed to compute the conditional (or cumulative) DLT probabilities in (up to) cycles 1, 2 and 3: =======</p>
<p>We also generate a reference dosing data set which is formatted like an analysis data set, but is only setup to evaluate the final model on the predefined set of doses. These will be needed to compute the conditional (or cumulative) DLT probabilities in (up to) cycles 1, 2 and 3: &gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/develop</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dose_ref_data <span class="ot">&lt;-</span> dose_info_long <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(cycle_info, <span class="at">by=</span><span class="st">"cycle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">num_toxicities=</span><span class="dv">0</span>L) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-description" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="model-description"><span class="header-section-number">10.5</span> Model description</h2>
<p>For each cycle <span class="math inline">\(j\)</span>, we model the probability of observing a DLT event conditional on entering cycle <span class="math inline">\(j\)</span> as a function of the dose <span class="math inline">\(d_{j}\)</span> being administered during this cycle.</p>
<p>For each patient <span class="math inline">\(i \in {1, \ldots, N}\)</span>, we observe either the DLT event time <span class="math inline">\(T_i\)</span> or the censoring time <span class="math inline">\(C_i\)</span>, whichever occurs first. We denote this as <!-- \unicode{x1D7D9} --></p>
<p><span class="math display">\[
(U_i, \delta_i), \textrm{ where } U_i = \min(T_i, C_i) \textrm{ and } \delta_i = 1(T_i \leq C_i).
\]</span></p>
<p>Here, <span class="math inline">\(U_i\)</span> represents the observed time, and <span class="math inline">\(\delta_i\)</span> indicates whether a DLT occurred <span class="math inline">\((\delta_i = 1)\)</span> or not (<span class="math inline">\(\delta_i = 0)\)</span>.</p>
<p>The primary focus of the model is the risk for DLT events over the course of a sequence of cycles. Thus, we do not aim to model accurately the risk for an event within each cycle. While one could model the event and censoring times as interval censored observations, we disregard here the interval censoring and use a continuous time representation of the time to event process. The continuous time representation can be understood as an approximation of the interval censored process with time lapsing in full units of a cycle. As a consequence, the observed event time <span class="math inline">\(T_i\)</span> and censoring times <span class="math inline">\(C_i\)</span> are always recorded at the planned cycle completion time-point (time lapses in units of cycles). Here we assume for simplicity that each cycle <span class="math inline">\(j\)</span> has the same duration <span class="math inline">\(\Delta t\)</span> such that any time being recorded is a multiple of <span class="math inline">\(\Delta t\)</span> and we denote time <span class="math inline">\(t\)</span> being during a cycle <span class="math inline">\(j\)</span> with <span class="math inline">\(t \in ((j-1) \, \Delta t, j \, \Delta t]\)</span> or equivalently <span class="math inline">\(t \in I_j\)</span> for brevity.</p>
<section id="model-definition" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="model-definition"><span class="header-section-number">10.5.1</span> Model definition</h3>
<p>To define our model, we use the following basic definitions from survival analysis. The survival function <span class="math inline">\(S(t)\)</span> and cumulative event probability <span class="math inline">\(F(t)\)</span> are defined as</p>
<p><span class="math display">\[\begin{align*}
S(t) := &amp; \Pr(\textrm{"No event up to time t"}) = \Pr(T \geq t) = 1 - F(t).
\end{align*}\]</span></p>
<p>We now have two quantities that are of particular interest:</p>
<ol type="1">
<li><p>The cumulative DLT probability up to cycle <span class="math inline">\(j\)</span> given a prescribed dosing <span class="math inline">\(\boldsymbol{d} = (d_{1}, d_{2}, d_{3})\)</span> over the three cycles: <span class="math display">\[\Pr(\textrm{"DLT up to cycle j"}|\boldsymbol{d}) =
F(t).\]</span></p></li>
<li><p>The conditional DLT probability of cycle <span class="math inline">\(j\)</span> given survival up to cycle <span class="math inline">\(j-1\)</span> (i.e., not having observed a DLT event up to the end of cycle <span class="math inline">\(j-1\)</span>): <span class="math display">\[\begin{align*}
   \, &amp;  \Pr(\textrm{"DLT in cycle j"}|\textrm{"No DLT up to cycle j-1"}, d_j) \\
= \, &amp;  \Pr(T \leq t + \Delta t|T &gt; t, d_j)\\
= \, &amp;  1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right),
\end{align*}\]</span> where <span class="math inline">\(h(u)\)</span> is the hazard function and <span class="math inline">\(H(t) = \int_{0}^{t} h(u) du\)</span> the cumulative hazard.</p></li>
</ol>
<p>Given the drug dose <span class="math inline">\(d_{j}\)</span> administered in cycle <span class="math inline">\(j\)</span>, we model the log-hazard <span class="math inline">\(\log(h_j(t|\tilde{d}_{j}))\)</span> as <span class="math display">\[
\log(h_j(t|\tilde{d}_{j})) = \alpha + \beta \log\left(\tilde{d}_{j}\right), \textrm{ where } \tilde{d}_{j} = \frac{d_{j}}{\tilde{d}}
\]</span> and <span class="math inline">\(\tilde{d}\)</span> is the reference dose. Then (see <a href="#sec-onco-tte-appendix" class="quarto-xref"><span>Section 10.10</span></a> for the full derivation), the conditional DLT probability is closely related to the classic two-parameter Bayesian Logistic Regression Model (BLRM), since</p>
<p><span class="math display">\[\begin{align}
\mathrm{cloglog}\Pr(T \leq t + \Delta t|T &gt; t, d_j) &amp; = \alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t),
\end{align}\]</span></p>
<p>is the same as for the BLRM in cycle one if we elapse time in cycles (then <span class="math inline">\(\Delta t = 1\)</span> and the <span class="math inline">\(\log(\Delta t)\)</span> is zero), except for the link function changing from <span class="math inline">\(\mathrm{logit}\)</span> to <span class="math inline">\(\mathrm{cloglog}(x) = \log(-\log(1 - x))\)</span>.</p>
<p>The cumulative DLT probability can also be derived, where <span class="math inline">\(j_t\)</span> is the index of the cycle that time <span class="math inline">\(t\)</span> lies in:</p>
<p><span class="math display">\[\begin{align}
\mathrm{cloglog}\Pr(T \leq t|\boldsymbol{d}) &amp; = \log\left(\sum_{j = 1}^{j_t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right)\right) = \mathrm{cloglog} F(t|\boldsymbol{d}).
\end{align}\]</span></p>
<p>Last, but not least, the likelihood for all patients <span class="math inline">\(i\)</span> is then <span class="math display">\[
L(U|\alpha, \beta) = \prod_i \underbrace{ f(T_i)^{\delta_i} }_\textrm{DLT
events} \, \underbrace{S(C_i)^{1 - \delta_i}}_\textrm{Censoring event} \,.
\]</span> In order to fit these models to time to first event data it is helpful to consider its representation as a Poisson regression. Since <span class="math inline">\(f(t) =
h(t) \, S(t)\)</span> and <span class="math inline">\(S(t) = \exp\left(-H(t)\right)\)</span> from basic survival analysis, it follows that the likelihood contribution in absence of an event is <span class="math inline">\(\exp(-H(t))\)</span> while it is <span class="math inline">\(h(t) \,
\exp(-H(t))\)</span> whenever an event occurs.</p>
<p>The Poisson distribution for observing <span class="math inline">\(k\)</span> events,</p>
<p><span class="math display">\[ \Pr(k|\lambda) = \frac{\lambda^k \, \exp(-\lambda)}{k!}, \]</span></p>
<p>becomes <span class="math inline">\(\exp(-\lambda)\)</span> for no event (<span class="math inline">\(k=0\)</span>) and <span class="math inline">\(\lambda \,
\exp(-\lambda)\)</span> for an event (<span class="math inline">\(k=1\)</span>). Therefore, we can model the data using a Poisson regression approach whenever the hazard is constant over the time units we model, <span class="math inline">\(h(t) = \lambda\)</span>. In this case the counts on each time interval are <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. Moreover, we use a <span class="math inline">\(\log\)</span> link function for the counting rate <span class="math inline">\(\lambda\)</span> and model with a linear function the <span class="math inline">\(\log\)</span> counting rate to ensure its positivity. Importantly, we also add to the linear predictor an offset equal to the <span class="math inline">\(\log\)</span> of the exposure time <span class="math inline">\(\log(\Delta t)\)</span>. The offset multiplies <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\Delta t\)</span> and thereby turns the constant counting rate <span class="math inline">\(\lambda\)</span> into a cumulative hazard <span class="math inline">\(H(t) = \lambda \,
\Delta t\)</span>. Thereby we obtain the desired likelihood.</p>
<p>Note, that when using the Poisson approach in <code>brms</code> we pass the cumulative hazard <span class="math inline">\(\lambda \, \Delta t\)</span> as argument to the counting rate such that the likelihood term for an event becomes <span class="math inline">\(\lambda \,
\Delta t \, \exp(-\lambda \, \Delta t)\)</span>, which is not quite equal to <span class="math inline">\(f(t)\)</span> as required above, but is instead equal to <span class="math inline">\(\Delta t \,
f(t)\)</span>. However, as <span class="math inline">\(\Delta t\)</span> is known it is merely a constant and is hence irrelevant for sampling the posterior.</p>
</section>
<section id="model-prior" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="model-prior"><span class="header-section-number">10.5.2</span> Model prior</h3>
<p>For the above model, we must define a prior for the parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. The interpretation of these parameters depends on two reference values, the reference <em>dose</em> <span class="math inline">\(\tilde{d}\)</span> and reference <em>time point</em> <span class="math inline">\(\tilde{t}\)</span>.</p>
<p>The reference dose <span class="math inline">\(\tilde{d}\)</span>, with respect to which the dose is normalized, defines the meaning of the intercept parameter <span class="math inline">\(\alpha\)</span>. Here we choose to define the meaning of the intercept by considering the reference <em>time point</em> <span class="math inline">\(\tilde{t}\)</span> such that for <span class="math inline">\(d=\tilde{d}\)</span> and <span class="math inline">\(t=\tilde{t}\)</span> we have that</p>
<p><span class="math display">\[
\mathrm{cloglog}\Pr(T \leq \tilde{t}|\tilde{d}) = \alpha + \log(\tilde{t}).
\]</span></p>
<p>Hence, when setting the mean of <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(\mathrm{cloglog}^{-1}(\tilde{\pi}) - \log(\tilde{t})\)</span> it becomes apparent that the intercept is equal to the rate of events <span class="math inline">\(\tilde{\pi}\)</span> over the reference time period up to the reference time point <span class="math inline">\(\tilde{t}\)</span> whenever dose <span class="math inline">\(\tilde{d}\)</span> is given.</p>
<p>If we are interested in modeling treatment cycles, we might let the time unit elapse in full cycles and set the reference time point to the end of cycle 1 (<span class="math inline">\(\tilde{t} = 1\)</span>). Then, the interpretation of the prior is the same as for the classic BLRM for which the DLT probability over one cycle is modeled as a binomial logistic regression (<span class="math inline">\(\mathrm{logit}(\pi(d)) = \alpha + \beta \, \log(d/\tilde{d})\)</span>). The only difference is that the link function is now <span class="math inline">\(\mathrm{cloglog}\)</span> instead of <span class="math inline">\(\mathrm{logit}\)</span>.</p>
<p>Given the similarity of the Poisson TTE model to the one cycle focused BLRM we will use the same rational for the slope parameter <span class="math inline">\(\beta\)</span>. The slope parameter <span class="math inline">\(\beta\)</span> can be interpreted as the Hill coefficient of a sigmoid logistic curve. We can hence use mechanistic knowledge and prior <em>in vivo</em> and <em>in vitro</em> data to motivate its feasible range of values, and condense this prior knowledge into an appropriate prior for the slope. In an efficacy meta-analysis, “modeling showed the Hill parameters were concentrated near 1.0”, see</p>
<ul>
<li>Thomas <em>et al.</em> (2014) <a href="https://doi.org/10.1080/19466315.2014.924876">doi:10.1080/19466315.2014.924876</a>,</li>
<li>Bayesian Methods in Pharmaceutical Research (2020) <a href="https://doi.org/10.1201/9781315180212">doi:10.1201/9781315180212</a> and</li>
<li>Thomas <em>et al.</em> (2017) <a href="https://doi.org/10.1080/19466315.2016.1256229">doi:10.1080/19466315.2016.1256229</a> for details.</li>
</ul>
<p>Therefore, in the absence of more specific knowledge (e.g.&nbsp;pre-clinical data, historical clinical data for the mechanism of action, etc.) we assume a prior for <span class="math inline">\(\log\left(\beta\right)\)</span> with mean 0. Furthermore, we wish to avoid extremely steep or flat dose-response curves. Thereby, we parameterize the 95% central credible interval to allow for a 4 fold increase or decrease via setting</p>
<p><span class="math display">\[ \log\left(\beta\right) \sim \mbox{Normal}\left(0,
\left(\frac{\log(4)}{1.96}\right)^2\right).\]</span></p>
<p>As discussed above, the intercept <span class="math inline">\(\alpha\)</span> defines the reference event rate <span class="math inline">\(\tilde{\pi}\)</span> at the reference dose <span class="math inline">\(\tilde{t}\)</span> over the time span up to the reference time <span class="math inline">\(\tilde{t}\)</span>. By setting <span class="math inline">\(\tilde{\pi}\)</span> to 20% we imply that the reference dose <span class="math inline">\(\tilde{d}\)</span> corresponds to our prior guess of the MTD. These considerations define the prior mean for <span class="math inline">\(\alpha\)</span>. The standard deviation for the intercept is set to unity. This choice results from an extensive study of the model properties under various data scenarios. These data scenarios studied how the model guides a dose-escalation trial at an early stage. At an early stage of the trial one requires sufficient conservative dose recommendations from the safety model while at the same time one wishes to ensure that the model allows the trial to continue enrolling patients to low doses should a limited number of DLT events be observed during the early cohorts. The rationale behind the prior of</p>
<p><span class="math display">\[ \alpha \sim \mbox{Normal}\left(\mathrm{cloglog}(\tilde{\pi} = 20\%) - \log\left(\tilde{t}\right), 1^2\right) \]</span></p>
<p>is that we have some level of confidence in the set of doses which we study in the trial to be reasonable. That is, the fact that we choose to study a concrete dose range is by itself prior knowledge driven by a multitude of (pre-clinical &amp; clinical) considerations. This prior choice deliberately avoids that a limited number of DLT events at the start of the trial can entirely undermine our initial understanding of the drug safety profile. Only with sufficient data the model will stop a trial.</p>
<p>For a better intuition of the model prior, it is a helpful to study data scenarios (left out here) and to visualize the joint model prior rather than considering the prior on each parameter individually. This is covered in section <a href="#sec-onco-tte-prior-vis" class="quarto-xref"><span>Section 10.6.3</span></a>.</p>
</section>
</section>
<section id="implementation" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="implementation"><span class="header-section-number">10.6</span> Implementation</h2>
<p>For the case of a single agent trial we can cast the problem into a Poisson regression framework as detailed above and define the <code>brms</code> model formula as follows. We use here a non-linear model formla syntax to enforce a positive slope:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tte_model <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bf</span>(num_toxicities <span class="sc">|</span> <span class="fu">rate</span>(follow_up) <span class="sc">~</span> interA <span class="sc">+</span> <span class="fu">exp</span>(slopeA) <span class="sc">*</span> std_A,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>       interA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       slopeA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">nl=</span><span class="cn">TRUE</span>, <span class="at">family=</span><span class="fu">poisson</span>()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>brms</code> helps us to get the list of model parameters requiring prior specifications:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(tte_model, <span class="at">data =</span> ipd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  prior class      coef group resp dpar  nlpar lb ub       source
 (flat)     b                           interA            default
 (flat)     b Intercept                 interA       (vectorized)
 (flat)     b                           slopeA            default
 (flat)     b Intercept                 slopeA       (vectorized)</code></pre>
</div>
</div>
<p>We can for instance define a prior with 20% DLT probability after the first treatment cycle at the reference dose. For more details on the <span class="math inline">\(\beta\)</span> parameter prior, see the bite-size guidance on <a href="https://go/BLRM">go/BLRM</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## -4.83 approx cloglog(0.2) - log(7*4) for drug A</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tte_prior <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(<span class="dv">4</span>)<span class="sc">/</span><span class="fl">1.96</span>), <span class="at">nlpar=</span>slopeA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then create the Stan model code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tte_stanmodel <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">make_stancode</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tte_standata <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">make_standata</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After inspecting the generated code and data for correctness, we compile the model without sampling it (<code>chains = 0</code>) yet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tte_brms_model <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior, <span class="at">chains =</span> <span class="dv">0</span>, <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="computing-conditional-and-cumulative-dlt-probabilities-for-a-given-dosing-schedule" class="level3" data-number="10.6.1">
<h3 data-number="10.6.1" class="anchored" data-anchor-id="computing-conditional-and-cumulative-dlt-probabilities-for-a-given-dosing-schedule"><span class="header-section-number">10.6.1</span> Computing conditional and cumulative DLT probabilities for a given dosing schedule</h3>
<p>We define a function to compute the conditional and cumulative DLT probabilities over a given schedule, respectively. This function needs to take the hazards for each piecewise-constant interval and compute the respective DLT probability. We write the function in the same logic as the <code>add_*_rvars</code> functions from <code>tidybayes</code> such that we can easily complement analysis data sets with the probabilities of interest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>add_risk_rvars <span class="ot">&lt;-</span> <span class="cf">function</span>(newdata, model, time, .by) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="do">## P(T =&lt; t) = 1 - P(T &gt; t) = inv_cloglog(log(H(t)))</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## &lt;=&gt; P(T =&lt; t) = 1 - P(T &gt; t) = inv_clog(H(t))</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## inv_cloglog(cll) = 1 - exp(-exp(cll))</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## =&gt; inv_clog = 1 - exp(-cl)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    inv_clog <span class="ot">&lt;-</span> <span class="cf">function</span>(cl) { <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>cl) }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## data must be sorted by time to ensure that the cumulative sum</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">## works correctly below</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    time_order <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">pull</span>(newdata, {{.by}}), <span class="fu">pull</span>(newdata, {{time}}))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    orig_order <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(newdata))[time_order]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    riskdata <span class="ot">&lt;-</span> newdata[time_order,]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    H <span class="ot">&lt;-</span> <span class="fu">rvar</span>(<span class="fu">posterior_epred</span>(model,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">newdata=</span>riskdata,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    riskdata <span class="ot">&lt;-</span> <span class="fu">mutate</span>(riskdata,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob=</span><span class="fu">inv_clog</span>(<span class="fu">cumsum</span>(H[<span class="fu">cur_group_rows</span>()])),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cprob=</span><span class="fu">inv_clog</span>(H[<span class="fu">cur_group_rows</span>()]),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.by=</span>{{.by}})</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    riskdata[orig_order,]</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dose-escalation-decisions" class="level3" data-number="10.6.2">
<h3 data-number="10.6.2" class="anchored" data-anchor-id="dose-escalation-decisions"><span class="header-section-number">10.6.2</span> Dose escalation decisions</h3>
<p>As in the basic dose-escalation chapter, we will apply Escalation With Overdose Control (EWOC). I.e., we define a threshold above which doses are “excessively toxic” <span class="math inline">\(\pi_{over}\)</span> (typically <span class="math inline">\(\pi_{over} = 33\%\)</span>), and a so-called feasibility bound <span class="math inline">\(c\)</span> (typically <span class="math inline">\(c = 25\%\)</span>):</p>
<p><span class="math display">\[ \text{EWOC satisfied at }d \iff \Pr( \pi(d) &gt; \pi_{over}) \leq c \]</span> Furthermore, we often define another cutoff <span class="math inline">\(\pi_{targ}\)</span>, and summarize the posterior probabilities for three intervals,</p>
<p><span class="math display">\[\begin{align*} \Pr(d\text{ is an underdose}) &amp;= \Pr( \pi(d) &lt; \pi_{targ} ) \\
\Pr(d\text{ is in the target range}) &amp;= \Pr( \pi_{targ} \leq \pi(d) &lt; \pi_{over} ) \\
\Pr(d\text{ is an overdose}) &amp;= \Pr( \pi(d) &gt; \pi_{over} ),
\end{align*}\]</span></p>
<p>and evaluate EWOC by checking if the last quantity exceeds <span class="math inline">\(c\)</span>.</p>
<p>For the set of MCMC draws, we can compute median, mean, sd, 25% and 75% quantiles, the interval probability as well as the EWOC criteria using the <code>summarize_draws</code> function from the <code>posterior</code> package. Especially for the EWOC metric, we also would like to know if there are any pre-specified doses where the Monte Carlo Error could flip the decision whether a dose is considered safe enough (or not).</p>
<p>We test for this using a Z-test (one-sample location test) for the 75% quantile and its distance from the critical threshold <span class="math inline">\(\pi_{over}\)</span> using the Monte-Carlo Standard Error (MCSE) for the 75% quantile (<code>mcse_q75</code>). We define the EWOC metric to be sufficiently accurate if the probability of flipping the decision due insufficient accuracy (and hence large MCSE) is smaller than 2.5% certainty on whatever side of the decision threshold. In turn we are at least 97.5% certain that the decision is robust wrt to fluctuations implied by MCMC sampling variability. Here we assume that the statistic is normally distributed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summarize_probs <span class="ot">&lt;-</span> <span class="cf">function</span>(draws) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_draws</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    draws,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    median, mean, sd, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">cut</span>(.x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="dv">1</span>)))),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">mcse_quantile</span>(.x, <span class="at">probs =</span> <span class="fl">0.75</span>), </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">default_convergence_measures</span>()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ewoc_ok =</span> q75 <span class="sc">&lt;</span> <span class="fl">0.33</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> (q75 <span class="sc">-</span> .<span class="dv">33</span>) <span class="sc">/</span> mcse_q75,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ewoc_accurate =</span>  <span class="fu">abs</span>(stat) <span class="sc">&gt;=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>variable)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To inspect the prior, we first sample the model ignoring the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tte_model_prioronly <span class="ot">&lt;-</span> <span class="fu">update</span>(tte_brms_model, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">sample_prior =</span> <span class="st">"only"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can compute the conditional and cumulative DLT probabilities implied by the prior,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="ot">&lt;-</span> dose_ref_data <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risk_rvars</span>(tte_model_prioronly, cycle, schedule_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and display them as a table, i.e., the conditional DLT probabilities</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="jouhkehivi" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jouhkehivi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jouhkehivi thead, #jouhkehivi tbody, #jouhkehivi tfoot, #jouhkehivi tr, #jouhkehivi td, #jouhkehivi th {
  border-style: none;
}

#jouhkehivi p {
  margin: 0;
  padding: 0;
}

#jouhkehivi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jouhkehivi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jouhkehivi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jouhkehivi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jouhkehivi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jouhkehivi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jouhkehivi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jouhkehivi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jouhkehivi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jouhkehivi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jouhkehivi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jouhkehivi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jouhkehivi .gt_spanner_row {
  border-bottom-style: hidden;
}

#jouhkehivi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jouhkehivi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jouhkehivi .gt_from_md > :first-child {
  margin-top: 0;
}

#jouhkehivi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jouhkehivi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jouhkehivi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jouhkehivi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jouhkehivi .gt_row_group_first td {
  border-top-width: 2px;
}

#jouhkehivi .gt_row_group_first th {
  border-top-width: 2px;
}

#jouhkehivi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jouhkehivi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jouhkehivi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jouhkehivi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jouhkehivi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jouhkehivi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jouhkehivi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jouhkehivi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jouhkehivi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jouhkehivi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jouhkehivi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jouhkehivi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jouhkehivi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jouhkehivi .gt_left {
  text-align: left;
}

#jouhkehivi .gt_center {
  text-align: center;
}

#jouhkehivi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jouhkehivi .gt_font_normal {
  font-weight: normal;
}

#jouhkehivi .gt_font_bold {
  font-weight: bold;
}

#jouhkehivi .gt_font_italic {
  font-style: italic;
}

#jouhkehivi .gt_super {
  font-size: 65%;
}

#jouhkehivi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jouhkehivi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jouhkehivi .gt_indent_1 {
  text-indent: 5px;
}

#jouhkehivi .gt_indent_2 {
  text-indent: 10px;
}

#jouhkehivi .gt_indent_3 {
  text-indent: 15px;
}

#jouhkehivi .gt_indent_4 {
  text-indent: 20px;
}

#jouhkehivi .gt_indent_5 {
  text-indent: 25px;
}

#jouhkehivi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jouhkehivi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="jouhkehivi" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="jouhkehivi">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"schedule_id":[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9],"cycle":[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],"dose_A":[1,1,1,2.5,2.5,2.5,5,5,5,10,10,10,20,20,20,30,30,30,40,40,40,45,45,45,50,50,50],"follow_up":[28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],"finite_A":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"median":[0.00387787598434836,0.00387787598434836,0.00387787598434836,0.00959365020705299,0.00959365020705299,0.00959365020705299,0.0190006010330934,0.0190006010330934,0.0190006010330934,0.0365492150526717,0.0365492150526717,0.0365492150526717,0.0734486027791892,0.0734486027791892,0.0734486027791892,0.112160868562256,0.112160868562256,0.112160868562256,0.156377314087602,0.156377314087602,0.156377314087602,0.178599544804892,0.178599544804892,0.178599544804892,0.199678820134847,0.199678820134847,0.199678820134847],"mean":[0.0228913813514907,0.0228913813514907,0.0228913813514907,0.0351398030621178,0.0351398030621178,0.0351398030621178,0.0504479742087437,0.0504479742087437,0.0504479742087437,0.0756912511915422,0.0756912511915422,0.0756912511915422,0.120902027202542,0.120902027202542,0.120902027202542,0.16559386324719,0.16559386324719,0.16559386324719,0.211979871491338,0.211979871491338,0.211979871491338,0.236015341282202,0.236015341282202,0.236015341282202,0.26042085678712,0.26042085678712,0.26042085678712],"sd":[0.0530925433669199,0.0530925433669199,0.0530925433669199,0.0692916333727267,0.0692916333727267,0.0692916333727267,0.0858645394021812,0.0858645394021812,0.0858645394021812,0.107699288824832,0.107699288824832,0.107699288824832,0.136983378214046,0.136983378214046,0.136983378214046,0.159765426661011,0.159765426661011,0.159765426661011,0.180499433802746,0.180499433802746,0.180499433802746,0.191168208642855,0.191168208642855,0.191168208642855,0.20262152595597,0.20262152595597,0.20262152595597],"q25":[0.000310199366743924,0.000310199366743924,0.000310199366743924,0.00136841173695557,0.00136841173695557,0.00136841173695557,0.00428403057849283,0.00428403057849283,0.00428403057849283,0.0120313332450982,0.0120313332450982,0.0120313332450982,0.0316255732015338,0.0316255732015338,0.0316255732015338,0.0555183666252145,0.0555183666252145,0.0555183666252145,0.0817097272071046,0.0817097272071046,0.0817097272071046,0.0951197556908022,0.0951197556908022,0.0951197556908022,0.107925426569533,0.107925426569533,0.107925426569533],"q75":[0.0198482136611848,0.0198482136611848,0.0198482136611848,0.0355879687390404,0.0355879687390404,0.0355879687390404,0.0575335920885051,0.0575335920885051,0.0575335920885051,0.0933410715040676,0.0933410715040676,0.0933410715040676,0.157388842785537,0.157388842785537,0.157388842785537,0.21774999991339,0.21774999991339,0.21774999991339,0.287748654644705,0.287748654644705,0.287748654644705,0.320740691355689,0.320740691355689,0.320740691355689,0.353091302532956,0.353091302532956,0.353091302532956],"(0,0.16]":[0.969734867433717,0.969734867433717,0.969734867433717,0.952,0.952,0.952,0.9235,0.9235,0.9235,0.86675,0.86675,0.86675,0.75575,0.75575,0.75575,0.63725,0.63725,0.63725,0.5105,0.5105,0.5105,0.4545,0.4545,0.4545,0.40475,0.40475,0.40475],"(0.16,0.33]":[0.0240120060030015,0.0240120060030015,0.0240120060030015,0.03625,0.03625,0.03625,0.05425,0.05425,0.05425,0.09575,0.09575,0.09575,0.16875,0.16875,0.16875,0.2295,0.2295,0.2295,0.29075,0.29075,0.29075,0.30575,0.30575,0.30575,0.3135,0.3135,0.3135],"(0.33,1]":[0.00625312656328164,0.00625312656328164,0.00625312656328164,0.01175,0.01175,0.01175,0.02225,0.02225,0.02225,0.0375,0.0375,0.0375,0.0755,0.0755,0.0755,0.13325,0.13325,0.13325,0.19875,0.19875,0.19875,0.23975,0.23975,0.23975,0.28175,0.28175,0.28175],"mcse_q75":[0.00103278458444778,0.00103278458444778,0.00103278458444778,0.00169196164849911,0.00169196164849911,0.00169196164849911,0.00237276527309832,0.00237276527309832,0.00237276527309832,0.00276227085288394,0.00276227085288394,0.00276227085288394,0.00375644240600026,0.00375644240600026,0.00375644240600026,0.00549440973360465,0.00549440973360465,0.00549440973360465,0.00491580378746265,0.00491580378746265,0.00491580378746265,0.00610576107965605,0.00610576107965605,0.00610576107965605,0.00722622194134143,0.00722622194134143,0.00722622194134143],"rhat":[1.00002132195022,1.00002132195022,1.00002132195022,1.00005610479397,1.00005610479397,1.00005610479397,1.00010209086275,1.00010209086275,1.00010209086275,1.00014459057592,1.00014459057592,1.00014459057592,1.00028965307287,1.00028965307287,1.00028965307287,1.00046121899938,1.00046121899938,1.00046121899938,1.00048615259829,1.00048615259829,1.00048615259829,1.00037382348907,1.00037382348907,1.00037382348907,1.0002849190742,1.0002849190742,1.0002849190742],"ess_bulk":[3486.79562628121,3486.79562628121,3486.79562628121,3457.53647735068,3457.53647735068,3457.53647735068,3364.23863645461,3364.23863645461,3364.23863645461,3248.85968083723,3248.85968083723,3248.85968083723,3127.5377004014,3127.5377004014,3127.5377004014,3134.71841791711,3134.71841791711,3134.71841791711,3247.98377008565,3247.98377008565,3247.98377008565,3321.28570579688,3321.28570579688,3321.28570579688,3400.86257920483,3400.86257920483,3400.86257920483],"ess_tail":[2377.15555101274,2377.15555101274,2377.15555101274,2376.48429170004,2376.48429170004,2376.48429170004,2374.00102998384,2374.00102998384,2374.00102998384,2363.6975649177,2363.6975649177,2363.6975649177,2236.82533956109,2236.82533956109,2236.82533956109,2182.62026523161,2182.62026523161,2182.62026523161,2398.21535741731,2398.21535741731,2398.21535741731,2376.90362602653,2376.90362602653,2376.90362602653,2202.35637327711,2202.35637327711,2202.35637327711],"ewoc_ok":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,false,false],"stat":[-300.3063668932,-300.3063668932,-300.3063668932,-174.006326634014,-174.006326634014,-174.006326634014,-114.830746640064,-114.830746640064,-114.830746640064,-85.6754971181951,-85.6754971181951,-85.6754971181951,-45.9506997734736,-45.9506997734736,-45.9506997734736,-20.4298560771819,-20.4298560771819,-20.4298560771819,-8.59500240083907,-8.59500240083907,-8.59500240083907,-1.51648721977714,-1.51648721977714,-1.51648721977714,3.19548758955905,3.19548758955905,3.19548758955905],"ewoc_accurate":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,false,false,true,true,true]},"columns":[{"id":"schedule_id","name":"schedule_id","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.00","2.00","2.00","3.00","3.00","3.00","4.00","4.00","4.00","5.00","5.00","5.00","6.00","6.00","6.00","7.00","7.00","7.00","8.00","8.00","8.00","9.00","9.00","9.00"],"html":true,"align":"right"},{"id":"cycle","name":"cycle","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00"],"html":true,"align":"right"},{"id":"dose_A","name":"dose_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.50","2.50","2.50","5.00","5.00","5.00","10.00","10.00","10.00","20.00","20.00","20.00","30.00","30.00","30.00","40.00","40.00","40.00","45.00","45.00","45.00","50.00","50.00","50.00"],"html":true,"align":"right"},{"id":"follow_up","name":"follow_up","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00"],"html":true,"align":"right"},{"id":"finite_A","name":"finite_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"median","name":"median","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.01","0.01","0.01","0.02","0.02","0.02","0.04","0.04","0.04","0.07","0.07","0.07","0.11","0.11","0.11","0.16","0.16","0.16","0.18","0.18","0.18","0.20","0.20","0.20"],"html":true,"align":"right"},{"id":"mean","name":"mean","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.04","0.04","0.04","0.05","0.05","0.05","0.08","0.08","0.08","0.12","0.12","0.12","0.17","0.17","0.17","0.21","0.21","0.21","0.24","0.24","0.24","0.26","0.26","0.26"],"html":true,"align":"right"},{"id":"sd","name":"sd","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.05","0.05","0.05","0.07","0.07","0.07","0.09","0.09","0.09","0.11","0.11","0.11","0.14","0.14","0.14","0.16","0.16","0.16","0.18","0.18","0.18","0.19","0.19","0.19","0.20","0.20","0.20"],"html":true,"align":"right"},{"id":"q25","name":"q25","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.01","0.01","0.01","0.03","0.03","0.03","0.06","0.06","0.06","0.08","0.08","0.08","0.10","0.10","0.10","0.11","0.11","0.11"],"html":true,"align":"right"},{"id":"q75","name":"q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.04","0.04","0.04","0.06","0.06","0.06","0.09","0.09","0.09","0.16","0.16","0.16","0.22","0.22","0.22","0.29","0.29","0.29","0.32","0.32","0.32","0.35","0.35","0.35"],"html":true,"align":"right"},{"id":"(0,0.16]","name":"(0,0.16]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.97","0.97","0.97","0.95","0.95","0.95","0.92","0.92","0.92","0.87","0.87","0.87","0.76","0.76","0.76","0.64","0.64","0.64","0.51","0.51","0.51","0.45","0.45","0.45","0.40","0.40","0.40"],"html":true,"align":"right"},{"id":"(0.16,0.33]","name":"(0.16,0.33]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.04","0.04","0.04","0.05","0.05","0.05","0.10","0.10","0.10","0.17","0.17","0.17","0.23","0.23","0.23","0.29","0.29","0.29","0.31","0.31","0.31","0.31","0.31","0.31"],"html":true,"align":"right"},{"id":"(0.33,1]","name":"(0.33,1]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.01","0.01","0.01","0.01","0.01","0.01","0.02","0.02","0.02","0.04","0.04","0.04","0.08","0.08","0.08","0.13","0.13","0.13","0.20","0.20","0.20","0.24","0.24","0.24","0.28","0.28","0.28"],"html":true,"align":"right"},{"id":"mcse_q75","name":"mcse_q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.01","0.01","0.01","0.00","0.00","0.00","0.01","0.01","0.01","0.01","0.01","0.01"],"html":true,"align":"right"},{"id":"rhat","name":"rhat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"ess_bulk","name":"ess_bulk","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["3,486.80","3,486.80","3,486.80","3,457.54","3,457.54","3,457.54","3,364.24","3,364.24","3,364.24","3,248.86","3,248.86","3,248.86","3,127.54","3,127.54","3,127.54","3,134.72","3,134.72","3,134.72","3,247.98","3,247.98","3,247.98","3,321.29","3,321.29","3,321.29","3,400.86","3,400.86","3,400.86"],"html":true,"align":"right"},{"id":"ess_tail","name":"ess_tail","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,377.16","2,377.16","2,377.16","2,376.48","2,376.48","2,376.48","2,374.00","2,374.00","2,374.00","2,363.70","2,363.70","2,363.70","2,236.83","2,236.83","2,236.83","2,182.62","2,182.62","2,182.62","2,398.22","2,398.22","2,398.22","2,376.90","2,376.90","2,376.90","2,202.36","2,202.36","2,202.36"],"html":true,"align":"right"},{"id":"ewoc_ok","name":"ewoc_ok","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"},{"id":"stat","name":"stat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["−300.31","−300.31","−300.31","−174.01","−174.01","−174.01","−114.83","−114.83","−114.83","−85.68","−85.68","−85.68","−45.95","−45.95","−45.95","−20.43","−20.43","−20.43","−8.60","−8.60","−8.60","−1.52","−1.52","−1.52","3.20","3.20","3.20"],"html":true,"align":"right"},{"id":"ewoc_accurate","name":"ewoc_accurate","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"}],"defaultPageSize":5,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"compact":true,"nowrap":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"font-family":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"jouhkehivi","dataKey":"3a4aa26bcac944ec63429e696e8e1f94"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style","tag.attribs.columns.5.style","tag.attribs.columns.6.style","tag.attribs.columns.7.style","tag.attribs.columns.8.style","tag.attribs.columns.9.style","tag.attribs.columns.10.style","tag.attribs.columns.11.style","tag.attribs.columns.12.style","tag.attribs.columns.13.style","tag.attribs.columns.14.style","tag.attribs.columns.15.style","tag.attribs.columns.16.style","tag.attribs.columns.17.style","tag.attribs.columns.18.style","tag.attribs.columns.19.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<p>as well the cumulative probabilities</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="nhlcfgskel" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nhlcfgskel table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nhlcfgskel thead, #nhlcfgskel tbody, #nhlcfgskel tfoot, #nhlcfgskel tr, #nhlcfgskel td, #nhlcfgskel th {
  border-style: none;
}

#nhlcfgskel p {
  margin: 0;
  padding: 0;
}

#nhlcfgskel .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nhlcfgskel .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nhlcfgskel .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nhlcfgskel .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nhlcfgskel .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nhlcfgskel .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nhlcfgskel .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nhlcfgskel .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nhlcfgskel .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nhlcfgskel .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nhlcfgskel .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nhlcfgskel .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nhlcfgskel .gt_spanner_row {
  border-bottom-style: hidden;
}

#nhlcfgskel .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nhlcfgskel .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nhlcfgskel .gt_from_md > :first-child {
  margin-top: 0;
}

#nhlcfgskel .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nhlcfgskel .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nhlcfgskel .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nhlcfgskel .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nhlcfgskel .gt_row_group_first td {
  border-top-width: 2px;
}

#nhlcfgskel .gt_row_group_first th {
  border-top-width: 2px;
}

#nhlcfgskel .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhlcfgskel .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nhlcfgskel .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nhlcfgskel .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nhlcfgskel .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhlcfgskel .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nhlcfgskel .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nhlcfgskel .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nhlcfgskel .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nhlcfgskel .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nhlcfgskel .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhlcfgskel .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nhlcfgskel .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhlcfgskel .gt_left {
  text-align: left;
}

#nhlcfgskel .gt_center {
  text-align: center;
}

#nhlcfgskel .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nhlcfgskel .gt_font_normal {
  font-weight: normal;
}

#nhlcfgskel .gt_font_bold {
  font-weight: bold;
}

#nhlcfgskel .gt_font_italic {
  font-style: italic;
}

#nhlcfgskel .gt_super {
  font-size: 65%;
}

#nhlcfgskel .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nhlcfgskel .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nhlcfgskel .gt_indent_1 {
  text-indent: 5px;
}

#nhlcfgskel .gt_indent_2 {
  text-indent: 10px;
}

#nhlcfgskel .gt_indent_3 {
  text-indent: 15px;
}

#nhlcfgskel .gt_indent_4 {
  text-indent: 20px;
}

#nhlcfgskel .gt_indent_5 {
  text-indent: 25px;
}

#nhlcfgskel .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nhlcfgskel div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="nhlcfgskel" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="nhlcfgskel">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"schedule_id":[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9],"cycle":[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],"dose_A":[1,1,1,2.5,2.5,2.5,5,5,5,10,10,10,20,20,20,30,30,30,40,40,40,45,45,45,50,50,50],"follow_up":[28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],"finite_A":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"median":[0.00387787598434836,0.0077407140447508,0.0115885724964255,0.00959365020705299,0.0190952622816191,0.0285057192055044,0.0190006010330934,0.0376401792241839,0.0559255942243471,0.0365492150526717,0.0717625849829837,0.105688933881692,0.0734486027791892,0.141502506025449,0.20455794321721,0.112160868562256,0.211741665129979,0.300153384097336,0.156377314087602,0.288300757695421,0.399594363321732,0.178599544804892,0.325301291721979,0.445802173106932,0.199678820134847,0.359486003586197,0.487383073909561],"mean":[0.0228913813514907,0.0424406339061741,0.059612330122826,0.0351398030621178,0.0642446702421446,0.0893009142118333,0.0504479742087437,0.0909800743687544,0.125189653652522,0.0756912511915422,0.134057099846972,0.1820180364673,0.120902027202542,0.208426999427943,0.277258932111543,0.16559386324719,0.278247788640965,0.363015088664897,0.211979871491338,0.346452376473481,0.442927074826372,0.236015341282202,0.379791293569131,0.480280904199468,0.26042085678712,0.411977472014472,0.515114587449138],"sd":[0.0530925433669199,0.0900014565135091,0.118191585756853,0.0692916333727267,0.113929752738252,0.146712907026985,0.0858645394021812,0.137118730951417,0.173210678950157,0.107699288824832,0.165465031908472,0.203831349150084,0.136983378214046,0.199446776367132,0.23655649742197,0.159765426661011,0.221550950535304,0.253087535501594,0.180499433802746,0.237803137613468,0.261283895806198,0.191168208642855,0.245173469468288,0.264074667346022,0.20262152595597,0.252319295306864,0.266333348092149],"q25":[0.000310199366743924,0.000620302509840687,0.000930309459138745,0.00136841173695557,0.00273495091696685,0.0040996201024798,0.00428403057849283,0.00854970818029679,0.0127971114306275,0.0120313332450982,0.0239179134940053,0.0356614823186547,0.0316255732015338,0.0622509694315158,0.0919078198657433,0.0555183666252145,0.107954442633339,0.157479351940747,0.0817097272071046,0.156742974852094,0.225645276265532,0.0951197556908022,0.181191743193493,0.259076584058164,0.107925426569533,0.204202953493554,0.29008968572974],"q75":[0.0198482136611848,0.0393024746152972,0.0583706021644041,0.0355879687390404,0.0699094336421751,0.103009467030889,0.0575335920885051,0.111757068323598,0.162860871748744,0.0933410715040676,0.177969587366165,0.254698786867775,0.157388842785537,0.290006429644521,0.40175148242997,0.21774999991339,0.388084930536174,0.521329426176662,0.287748654644705,0.49269801246107,0.6386734646548,0.320740691355689,0.538606783923614,0.686594352579804,0.353091302532956,0.581509118463217,0.729274584759874],"(0,0.16]":[0.969734867433717,0.927713856928464,0.892973243310828,0.952,0.884,0.8245,0.9235,0.8245,0.7455,0.86675,0.7215,0.618,0.75575,0.549,0.4095,0.63725,0.3835,0.2545,0.5105,0.25675,0.14675,0.4545,0.20925,0.10875,0.40475,0.17225,0.0845],"(0.16,0.33]":[0.0240120060030015,0.0475237618809405,0.0652663165791448,0.03625,0.076,0.10475,0.05425,0.113,0.14525,0.09575,0.168,0.1975,0.16875,0.238,0.26925,0.2295,0.302,0.2825,0.29075,0.3085,0.26725,0.30575,0.29775,0.241,0.3135,0.28175,0.21425],"(0.33,1]":[0.00625312656328164,0.0247623811905953,0.0417604401100275,0.01175,0.04,0.07075,0.02225,0.0625,0.10925,0.0375,0.1105,0.1845,0.0755,0.213,0.32125,0.13325,0.3145,0.463,0.19875,0.43475,0.586,0.23975,0.493,0.65025,0.28175,0.546,0.70125],"mcse_q75":[0.00103278458444778,0.00202491632458834,0.00297759646612261,0.00169196164849911,0.00326454122777858,0.00472406113533191,0.00237276527309832,0.00447183958248598,0.00632091332662726,0.00276227085288394,0.00500871807955355,0.00681160603773934,0.00375644240600026,0.00633141609715632,0.0080036689541228,0.00549440973360465,0.00858706955264205,0.0100655460105262,0.00491580378746265,0.00700741513043179,0.00749185395782848,0.00610576107965605,0.0083036064915053,0.00846967310410662,0.00722622194134143,0.00932974127438074,0.00903456625941645],"rhat":[1.00002132195022,1.00002132195022,1.00002174773101,1.00005610479397,1.00005610479397,1.00005610479397,1.00010209086275,1.00010209086275,1.00010209086275,1.00014459057592,1.00014459057592,1.00014459057592,1.00028965307287,1.00028965307287,1.00028965307287,1.00046121899938,1.00046121899938,1.00046121899938,1.00048615259829,1.00052204300429,1.00059806092129,1.00037382348907,1.00040215502433,1.00051317102903,1.0002849190742,1.0002849190742,1.00043197864695],"ess_bulk":[3486.79562628121,3486.79562628121,3486.67014326078,3457.53647735068,3457.53647735068,3457.53647735068,3364.23863645461,3364.23863645461,3364.23863645461,3248.85968083723,3248.85968083723,3248.85968083723,3127.5377004014,3127.5377004014,3127.5377004014,3134.71841791711,3134.71841791711,3134.71841791711,3247.98377008565,3247.98377008565,3247.98377008565,3321.28570579688,3321.28570579688,3321.28570579688,3400.86257920483,3400.86257920483,3400.86257920483],"ess_tail":[2377.15555101274,2377.15555101274,2377.15555101274,2376.48429170004,2376.48429170004,2376.48429170004,2374.00102998384,2374.00102998384,2374.00102998384,2363.6975649177,2363.6975649177,2363.6975649177,2236.82533956109,2236.82533956109,2236.82533956109,2182.62026523161,2182.62026523161,2182.62026523161,2398.21535741731,2398.21535741731,2398.21535741731,2376.90362602653,2376.90362602653,2376.90362602653,2202.35637327711,2202.35637327711,2202.35637327711],"ewoc_ok":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,false,false,true,false,false,true,false,false,false,false,false],"stat":[-300.3063668932,-143.560265604457,-91.224382123649,-174.006326634014,-79.67139889203,-48.0498720203718,-114.830746640064,-48.8038373583778,-26.4422433301168,-85.6754971181951,-30.3531582770549,-11.0548397419086,-45.9506997734736,-6.3166864634662,8.96482386281227,-20.4298560771819,6.76423198625454,19.0083504637082,-8.59500240083907,23.2179783033697,41.2012121955817,-1.51648721977714,25.1224313359529,42.1024930002204,3.19548758955905,26.9577806143301,44.1941066449894],"ewoc_accurate":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true]},"columns":[{"id":"schedule_id","name":"schedule_id","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.00","2.00","2.00","3.00","3.00","3.00","4.00","4.00","4.00","5.00","5.00","5.00","6.00","6.00","6.00","7.00","7.00","7.00","8.00","8.00","8.00","9.00","9.00","9.00"],"html":true,"align":"right"},{"id":"cycle","name":"cycle","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00"],"html":true,"align":"right"},{"id":"dose_A","name":"dose_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.50","2.50","2.50","5.00","5.00","5.00","10.00","10.00","10.00","20.00","20.00","20.00","30.00","30.00","30.00","40.00","40.00","40.00","45.00","45.00","45.00","50.00","50.00","50.00"],"html":true,"align":"right"},{"id":"follow_up","name":"follow_up","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00"],"html":true,"align":"right"},{"id":"finite_A","name":"finite_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"median","name":"median","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.01","0.01","0.01","0.02","0.03","0.02","0.04","0.06","0.04","0.07","0.11","0.07","0.14","0.20","0.11","0.21","0.30","0.16","0.29","0.40","0.18","0.33","0.45","0.20","0.36","0.49"],"html":true,"align":"right"},{"id":"mean","name":"mean","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.04","0.06","0.04","0.06","0.09","0.05","0.09","0.13","0.08","0.13","0.18","0.12","0.21","0.28","0.17","0.28","0.36","0.21","0.35","0.44","0.24","0.38","0.48","0.26","0.41","0.52"],"html":true,"align":"right"},{"id":"sd","name":"sd","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.05","0.09","0.12","0.07","0.11","0.15","0.09","0.14","0.17","0.11","0.17","0.20","0.14","0.20","0.24","0.16","0.22","0.25","0.18","0.24","0.26","0.19","0.25","0.26","0.20","0.25","0.27"],"html":true,"align":"right"},{"id":"q25","name":"q25","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.01","0.01","0.01","0.02","0.04","0.03","0.06","0.09","0.06","0.11","0.16","0.08","0.16","0.23","0.10","0.18","0.26","0.11","0.20","0.29"],"html":true,"align":"right"},{"id":"q75","name":"q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.04","0.06","0.04","0.07","0.10","0.06","0.11","0.16","0.09","0.18","0.25","0.16","0.29","0.40","0.22","0.39","0.52","0.29","0.49","0.64","0.32","0.54","0.69","0.35","0.58","0.73"],"html":true,"align":"right"},{"id":"(0,0.16]","name":"(0,0.16]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.97","0.93","0.89","0.95","0.88","0.82","0.92","0.82","0.75","0.87","0.72","0.62","0.76","0.55","0.41","0.64","0.38","0.25","0.51","0.26","0.15","0.45","0.21","0.11","0.40","0.17","0.08"],"html":true,"align":"right"},{"id":"(0.16,0.33]","name":"(0.16,0.33]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.05","0.07","0.04","0.08","0.10","0.05","0.11","0.15","0.10","0.17","0.20","0.17","0.24","0.27","0.23","0.30","0.28","0.29","0.31","0.27","0.31","0.30","0.24","0.31","0.28","0.21"],"html":true,"align":"right"},{"id":"(0.33,1]","name":"(0.33,1]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.01","0.02","0.04","0.01","0.04","0.07","0.02","0.06","0.11","0.04","0.11","0.18","0.08","0.21","0.32","0.13","0.31","0.46","0.20","0.43","0.59","0.24","0.49","0.65","0.28","0.55","0.70"],"html":true,"align":"right"},{"id":"mcse_q75","name":"mcse_q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.01","0.00","0.01","0.01","0.00","0.01","0.01","0.01","0.01","0.01","0.00","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01"],"html":true,"align":"right"},{"id":"rhat","name":"rhat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"ess_bulk","name":"ess_bulk","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["3,486.80","3,486.80","3,486.67","3,457.54","3,457.54","3,457.54","3,364.24","3,364.24","3,364.24","3,248.86","3,248.86","3,248.86","3,127.54","3,127.54","3,127.54","3,134.72","3,134.72","3,134.72","3,247.98","3,247.98","3,247.98","3,321.29","3,321.29","3,321.29","3,400.86","3,400.86","3,400.86"],"html":true,"align":"right"},{"id":"ess_tail","name":"ess_tail","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,377.16","2,377.16","2,377.16","2,376.48","2,376.48","2,376.48","2,374.00","2,374.00","2,374.00","2,363.70","2,363.70","2,363.70","2,236.83","2,236.83","2,236.83","2,182.62","2,182.62","2,182.62","2,398.22","2,398.22","2,398.22","2,376.90","2,376.90","2,376.90","2,202.36","2,202.36","2,202.36"],"html":true,"align":"right"},{"id":"ewoc_ok","name":"ewoc_ok","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"},{"id":"stat","name":"stat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["−300.31","−143.56","−91.22","−174.01","−79.67","−48.05","−114.83","−48.80","−26.44","−85.68","−30.35","−11.05","−45.95","−6.32","8.96","−20.43","6.76","19.01","−8.60","23.22","41.20","−1.52","25.12","42.10","3.20","26.96","44.19"],"html":true,"align":"right"},{"id":"ewoc_accurate","name":"ewoc_accurate","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"}],"defaultPageSize":5,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"compact":true,"nowrap":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"font-family":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"nhlcfgskel","dataKey":"15d3ed9b80d62ca85a5b3ef50e158537"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style","tag.attribs.columns.5.style","tag.attribs.columns.6.style","tag.attribs.columns.7.style","tag.attribs.columns.8.style","tag.attribs.columns.9.style","tag.attribs.columns.10.style","tag.attribs.columns.11.style","tag.attribs.columns.12.style","tag.attribs.columns.13.style","tag.attribs.columns.14.style","tag.attribs.columns.15.style","tag.attribs.columns.16.style","tag.attribs.columns.17.style","tag.attribs.columns.18.style","tag.attribs.columns.19.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</section>
<section id="sec-onco-tte-prior-vis" class="level3" data-number="10.6.3">
<h3 data-number="10.6.3" class="anchored" data-anchor-id="sec-onco-tte-prior-vis"><span class="header-section-number">10.6.3</span> Visualizing the model prior</h3>
<p>We can also visualize the prior in terms of the sampled curves, and see whether this distribution makes sense to us. We can, e.g., see, that the prior we defined above is quite sensible in terms of the dose-response curves it implies:</p>
<section id="conditional-dlt-probability-in-cycle-1" class="level4" data-number="10.6.3.1">
<h4 data-number="10.6.3.1" class="anchored" data-anchor-id="conditional-dlt-probability-in-cycle-1"><span class="header-section-number">10.6.3.1</span> Conditional DLT probability in cycle 1</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>add_plot_cols <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">EWOC =</span> <span class="fu">factor</span>(ewoc_ok, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">c</span>(<span class="st">"OK"</span>, <span class="st">"Not OK"</span>)), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dose_A =</span> <span class="fu">factor</span>(dose_A),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cycle =</span> cycle</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>doses_dense <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>dref_A, <span class="at">length.out =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>dose_info_dense <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">schedule_id =</span> <span class="fu">seq_along</span>(doses_dense), </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle =</span> cycle_seq</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_A =</span> doses_dense[schedule_id])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>dose_ref_data_dense <span class="ot">&lt;-</span> dose_info_dense <span class="sc">|&gt;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cycle_info, <span class="at">by=</span><span class="st">"cycle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_toxicities=</span><span class="dv">0</span>L) <span class="sc">|&gt;</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)    </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plot_cycle1_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules, doses) {</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> schedules <span class="sc">|&gt;</span> </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cycle <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  plot_data_long <span class="ot">&lt;-</span> plot_data <span class="sc">|&gt;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dose_A, cprob) <span class="sc">|&gt;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_rvars</span>()</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  plot_data_long <span class="sc">|&gt;</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">y =</span> cprob, <span class="at">group =</span> .draw)) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>( <span class="at">alpha=</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> doses) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Risk of a DLT in cycle 1"</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT in cycle | survival to cycle start)"</span>) <span class="sc">+</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cycle1_dist</span>(tte_model_prioronly, dose_ref_data_dense, <span class="fu">c</span>(doses, <span class="dv">2</span><span class="sc">*</span>dref_A))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If one chooses a very wide prior on a parameter without considering the response scale, this can, result in priors that are not biologically justifiable. For instance, if we chose a much higher standard deviation for the prior of the slope <span class="math inline">\(\beta\)</span>, this leads to a prior is bimodal in the sense that it implies either flat dose-response curves or step functions at the reference dose (which is easier to overlook when only plotting the point intervals):</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tte_prior_wide <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">nlpar=</span>slopeA)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>tte_brms_model_wide_prioronly <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior_wide, <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">sample_prior =</span> <span class="st">"only"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cycle1_dist</span>(tte_brms_model_wide_prioronly, dose_ref_data_dense, <span class="fu">c</span>(doses, <span class="dv">2</span><span class="sc">*</span>dref_A))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nevertheless, it is easier to visualize the distributiom of the estimated dose-response curves for the pre-specified doses using the <code>stat_pointinterval</code> stat from the <code>ggdist</code> package:</p>
</section>
<section id="conditional-dlt-probability-in-each-of-the-3-cycles" class="level4" data-number="10.6.3.2">
<h4 data-number="10.6.3.2" class="anchored" data-anchor-id="conditional-dlt-probability-in-each-of-the-3-cycles"><span class="header-section-number">10.6.3.2</span> Conditional DLT probability in each of the 3 cycles</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_cprob <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  schedules <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_plot_cols</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">ydist =</span> cprob, <span class="at">colour =</span> EWOC)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cycle, <span class="at">labeller =</span> label_both) <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Conditional risk for one DLT per cycle"</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Risk is conditional on survival at the same dose up to cycle start.</span><span class="sc">\n</span><span class="st">Shown is the median (dot) and central 50% CrI (line)."</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT in cycle | survival to cycle start)"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cprob</span>(tte_model_prioronly, dose_ref_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cumulative-dlt-probability-over-3-cycles" class="level4" data-number="10.6.3.3">
<h4 data-number="10.6.3.3" class="anchored" data-anchor-id="cumulative-dlt-probability-over-3-cycles"><span class="header-section-number">10.6.3.3</span> Cumulative DLT probability over 3 cycles</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  schedules <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_plot_cols</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">ydist =</span> prob, <span class="at">colour =</span> EWOC)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cycle, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Overall risk for DLT up to cycle"</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Given same dose over all cycles.</span><span class="sc">\n</span><span class="st">Shown is the median (dot) and central 50% CrI (line)."</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT up to cycle)"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_prob</span>(tte_model_prioronly, dose_ref_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="examining-the-model-posterior" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="examining-the-model-posterior"><span class="header-section-number">10.7</span> Examining the model posterior</h2>
<p>We now sample the model including the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tte_model_posterior <span class="ot">&lt;-</span> <span class="fu">update</span>(tte_brms_model, <span class="at">chains =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="inference-for-model-parameters" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="inference-for-model-parameters"><span class="header-section-number">10.7.1</span> Inference for model parameters</h3>
<p>It is simple to get summary statistics and graphical displays of the posterior distributions for the model parameters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(tte_model_posterior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate Est.Error        Q2.5     Q97.5
b_interA_Intercept -4.2141036 0.8817048  -5.8656920 -2.438936
b_slopeA_Intercept  0.3359283 0.4634905  -0.6674834  1.147130
lprior             -2.3972805 1.0369622  -5.3616400 -1.507926
lp__               -7.6912674 1.0165879 -10.4014250 -6.677724</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">mcmc_plot</span>(tte_model_posterior, <span class="at">type =</span> <span class="st">"dens"</span>, <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-for-conditional-and-cumulative-dlt-probabilities" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="inference-for-conditional-and-cumulative-dlt-probabilities"><span class="header-section-number">10.7.2</span> Inference for conditional and cumulative DLT probabilities</h3>
<p>The conditional and cumulative DLT probabilities are now higher, as expected from the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cprob</span>(tte_model_posterior, dose_ref_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_prob</span>(tte_model_posterior, dose_ref_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02cb_tte_dose_escalation_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">10.8</span> Conclusion</h2>
<p><code>brms</code> can handle time-to-event modelling for DLTs in an early Oncology dose escalation trial using Poisson regression with an offset for the follow-up, and produce all the posterior summaries necessary for guiding such trials. There are, of course, <em>many</em> possible extensions and complications to this methodology, such as hazards varying by treatment cycle (e.g., monotonically decreasing), or by prior treatment (e.g., decreasing hazard in case of prior ramp-up dosing), or drug combinations. The latter will be the topic of the exercise for this chapter where we showcase how to define custom link functions in <code>brms</code> to handle the combination case.</p>
</section>
<section id="exercise" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="exercise"><span class="header-section-number">10.9</span> Exercise</h2>
<p>Often, investigational cancer drugs are tested on top of a standard-of-care (SoC) treatment. In this exercise, we will explore how we can extend the single-agent time-to-event model to a combination of investigational drug and SoC treatment.</p>
<p>In the following, we assume the SoC treatment also has a hazard rate when present, and that there is no drug-drug interactions, i.e., the hazards are <em>additive</em>.</p>
<p>We model the log-hazard <span class="math inline">\(\log\left(h_{B,j}(t|\tilde{d}_{B,j})\right)\)</span> of the SoC treatment (called “drug B” here) in a more simplified way, i.e., either as present “at the reference dose” or absent: <span class="math display">\[
\log\left(h_{B,j}(t|\tilde{d}_{B,j})\right) = \begin{cases}
  \alpha_B &amp; \textrm{if } \tilde{d}_{B,j} = 1  \\
  -\infty  &amp; \textrm{if } \tilde{d}_{B,j} = 0
\end{cases}
\]</span> First, we add a second component to the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Stan function to make combo2 non-linear link come to life. To avoid</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## issues with negative infinity (log(0)) whenever one of the drugs is</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## not present, we have to pass in this information.</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. if drug_A is present (finiteA: indicator 1 = present, 0 = absent)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. if drug_B is present (finnitB: indicator 1 = present, 0 = absent)</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>combo2_tte_stan_code <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="st">// log(h) = log(exp(muA) + exp(muB))</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="st">real combo2_tte_log_inv_link(real muA, real muB, int finiteA, int finiteB) {</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="st">  real log_h;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="st">  if(finiteA == 1 &amp;&amp; finiteB == 1) {</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = log_sum_exp(muA, muB);</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA == 1 &amp;&amp; finiteB != 1) {</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = muA;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA != 1 &amp;&amp; finiteB == 1) {</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = muB;</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA != 1 &amp;&amp; finiteB != 1) {</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="st">    // Need to use negative_infinity() instead of -std::numeric_limits&lt;double&gt;::infinity()</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="st">    // to avoid autodiff issues</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = negative_infinity();</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="st">  return log_h;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>combo2_tte_stanvar <span class="ot">&lt;-</span> <span class="fu">stanvar</span>(<span class="at">scode =</span> combo2_tte_stan_code, <span class="at">block =</span> <span class="st">"functions"</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Define respective R function which is used for simulation of the</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="do">## posterior in R. Note that the inputs are given as draws of matrices</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="do">## which have the format of draws representing rows and columns</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="do">## corresponding to observation rows in the modeling data set for</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="do">## which the posterior is simulated.</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>combo2_tte_log_inv_link <span class="ot">&lt;-</span> <span class="cf">function</span>(muA, muB, finiteA, finiteB) {</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">ncol</span>(muA) <span class="co"># number of observations</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    D <span class="ot">&lt;-</span> <span class="fu">nrow</span>(muA) <span class="co"># number of draws</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="do">## flatten the matrices to vectors (column-major ordering)</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    muA <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(muA)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    muB <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(muB)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    finiteA <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(finiteA)</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    finiteB <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(finiteB)</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    log_muAB <span class="ot">&lt;-</span> matrixStats<span class="sc">::</span><span class="fu">rowLogSumExps</span>(<span class="fu">cbind</span>(muA, muB))</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    log_h <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> log_muAB,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">~</span> muA,</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> muB,</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">rep.int</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="at">times=</span>D<span class="sc">*</span>N)</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cast result into draws x observation matrix</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(log_h, D, N)</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>brms</code> model corresponding to the combination model described above is quite different from the single-drug case due to the need for a custom non-linear link function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>combo2_tte_model  <span class="ot">&lt;-</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bf</span>(num_toxicities <span class="sc">|</span> <span class="fu">rate</span>(follow_up) <span class="sc">~</span> <span class="fu">combo2_tte_log_inv_link</span>(muA, muB, finite_A, finite_B),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">nlf</span>(muA <span class="sc">~</span> interA <span class="sc">+</span> <span class="fu">exp</span>(slopeA) <span class="sc">*</span> std_A),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>       slopeA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>       interA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>       muB <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">nl=</span><span class="cn">TRUE</span>, <span class="at">loop=</span><span class="cn">TRUE</span>, <span class="at">family=</span>poisson</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, we need the indicators finite_A and finite_B now, in order to numerically deal with cases where one or both of the drugs has zero 0 dose.</p>
<p>Now for the exercise:</p>
<ol type="1">
<li>Update the <code>ipd</code> data to include the SoC as drug B (hint: use drug name “B” and a reference dose of 1 for SoC present).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>combo2_ipd <span class="ot">&lt;-</span> ipd <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_B =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"B"</span>, <span class="at">dref =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Define a prior for the SoC treatment that corresponds to a DLT probability of 5% in the first cycle with a standard deviation of 1.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(combo2_tte_model, <span class="at">data =</span> combo2_ipd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  prior class      coef group resp dpar  nlpar lb ub       source
 (flat)     b                           interA            default
 (flat)     b Intercept                 interA       (vectorized)
 (flat)     b                              muB            default
 (flat)     b Intercept                    muB       (vectorized)
 (flat)     b                           slopeA            default
 (flat)     b Intercept                 slopeA       (vectorized)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.3 approx cloglog(0.05) - log(7*4) for the SoC</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>combo2_tte_prior <span class="ot">&lt;-</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(<span class="dv">4</span>)<span class="sc">/</span><span class="fl">1.96</span>), <span class="at">nlpar=</span>slopeA) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">6.3</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>muB, <span class="at">coef=</span>Intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Which dose of the investigational drug would still be sufficiently safe according to the standard EWOC criterion when administered on top of the SoC treatment?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>combo2_tte_brms_model <span class="ot">&lt;-</span> combo2_tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> combo2_ipd, <span class="at">stanvars =</span> combo2_tte_stanvar, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> combo2_tte_prior, <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>make[2]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>combo2_dose_ref_data <span class="ot">&lt;-</span> dose_ref_data <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_B =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"B"</span>, <span class="at">dref =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="ot">&lt;-</span> combo2_dose_ref_data <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(combo2_tte_brms_model, cycle, schedule_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="jzacwqbrco" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jzacwqbrco table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jzacwqbrco thead, #jzacwqbrco tbody, #jzacwqbrco tfoot, #jzacwqbrco tr, #jzacwqbrco td, #jzacwqbrco th {
  border-style: none;
}

#jzacwqbrco p {
  margin: 0;
  padding: 0;
}

#jzacwqbrco .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jzacwqbrco .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jzacwqbrco .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jzacwqbrco .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jzacwqbrco .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jzacwqbrco .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jzacwqbrco .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jzacwqbrco .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jzacwqbrco .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jzacwqbrco .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jzacwqbrco .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jzacwqbrco .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jzacwqbrco .gt_spanner_row {
  border-bottom-style: hidden;
}

#jzacwqbrco .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jzacwqbrco .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jzacwqbrco .gt_from_md > :first-child {
  margin-top: 0;
}

#jzacwqbrco .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jzacwqbrco .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jzacwqbrco .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jzacwqbrco .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jzacwqbrco .gt_row_group_first td {
  border-top-width: 2px;
}

#jzacwqbrco .gt_row_group_first th {
  border-top-width: 2px;
}

#jzacwqbrco .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jzacwqbrco .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jzacwqbrco .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jzacwqbrco .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jzacwqbrco .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jzacwqbrco .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jzacwqbrco .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jzacwqbrco .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jzacwqbrco .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jzacwqbrco .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jzacwqbrco .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jzacwqbrco .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jzacwqbrco .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jzacwqbrco .gt_left {
  text-align: left;
}

#jzacwqbrco .gt_center {
  text-align: center;
}

#jzacwqbrco .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jzacwqbrco .gt_font_normal {
  font-weight: normal;
}

#jzacwqbrco .gt_font_bold {
  font-weight: bold;
}

#jzacwqbrco .gt_font_italic {
  font-style: italic;
}

#jzacwqbrco .gt_super {
  font-size: 65%;
}

#jzacwqbrco .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jzacwqbrco .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jzacwqbrco .gt_indent_1 {
  text-indent: 5px;
}

#jzacwqbrco .gt_indent_2 {
  text-indent: 10px;
}

#jzacwqbrco .gt_indent_3 {
  text-indent: 15px;
}

#jzacwqbrco .gt_indent_4 {
  text-indent: 20px;
}

#jzacwqbrco .gt_indent_5 {
  text-indent: 25px;
}

#jzacwqbrco .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jzacwqbrco div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="jzacwqbrco" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="jzacwqbrco">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"schedule_id":[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9],"cycle":[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],"dose_A":[1,1,1,2.5,2.5,2.5,5,5,5,10,10,10,20,20,20,30,30,30,40,40,40,45,45,45,50,50,50],"follow_up":[28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],"finite_A":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"dose_B":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"std_B":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"finite_B":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"median":[0.0248427297285759,0.0248427297285759,0.0248427297285759,0.0293893375673785,0.0293893375673785,0.0293893375673785,0.0377987721290499,0.0377987721290499,0.0377987721290499,0.0576760351818366,0.0576760351818366,0.0576760351818366,0.1079256934567,0.1079256934567,0.1079256934567,0.169147016569022,0.169147016569022,0.169147016569022,0.239857108485768,0.239857108485768,0.239857108485768,0.276809295756636,0.276809295756636,0.276809295756636,0.315715370857889,0.315715370857889,0.315715370857889],"mean":[0.0293593918104621,0.0293593918104621,0.0293593918104621,0.0340582824421395,0.0340582824421395,0.0340582824421395,0.0428332372564932,0.0428332372564932,0.0428332372564932,0.0644635609690564,0.0644635609690564,0.0644635609690564,0.123495307373412,0.123495307373412,0.123495307373412,0.19947057918554,0.19947057918554,0.19947057918554,0.283427689608027,0.283427689608027,0.283427689608027,0.325139094499129,0.325139094499129,0.325139094499129,0.3652423813392,0.3652423813392,0.3652423813392],"sd":[0.0189130776806193,0.0189130776806193,0.0189130776806193,0.0208279523268015,0.0208279523268015,0.0208279523268015,0.0249440775505609,0.0249440775505609,0.0249440775505609,0.0361551965352534,0.0361551965352534,0.0361551965352534,0.0711103033368724,0.0711103033368724,0.0711103033368724,0.121093899468377,0.121093899468377,0.121093899468377,0.174625347829207,0.174625347829207,0.174625347829207,0.198685694177848,0.198685694177848,0.198685694177848,0.219496837848841,0.219496837848841,0.219496837848841],"q25":[0.0159893037096212,0.0159893037096212,0.0159893037096212,0.019115362129163,0.019115362129163,0.019115362129163,0.0247815752630641,0.0247815752630641,0.0247815752630641,0.0381252187070943,0.0381252187070943,0.0381252187070943,0.0716422602479837,0.0716422602479837,0.0716422602479837,0.110268998065253,0.110268998065253,0.110268998065253,0.150798923430606,0.150798923430606,0.150798923430606,0.172218911510517,0.172218911510517,0.172218911510517,0.191677414956102,0.191677414956102,0.191677414956102],"q75":[0.0384246740498792,0.0384246740498792,0.0384246740498792,0.0441767493773224,0.0441767493773224,0.0441767493773224,0.0554208139322396,0.0554208139322396,0.0554208139322396,0.0831029422250396,0.0831029422250396,0.0831029422250396,0.160913935260126,0.160913935260126,0.160913935260126,0.258859619687701,0.258859619687701,0.258859619687701,0.372745577570273,0.372745577570273,0.372745577570273,0.434547818399912,0.434547818399912,0.434547818399912,0.494886479490005,0.494886479490005,0.494886479490005],"(0,0.16]":[1,1,1,0.9995,0.9995,0.9995,0.99825,0.99825,0.99825,0.98,0.98,0.98,0.74625,0.74625,0.74625,0.463,0.463,0.463,0.278,0.278,0.278,0.21875,0.21875,0.21875,0.1775,0.1775,0.1775],"(0.16,0.33]":[0,0,0,0.0005,0.0005,0.0005,0.00175,0.00175,0.00175,0.02,0.02,0.02,0.2365,0.2365,0.2365,0.40175,0.40175,0.40175,0.4065,0.4065,0.4065,0.3855,0.3855,0.3855,0.34975,0.34975,0.34975],"(0.33,1]":[0,0,0,0,0,0,0,0,0,0,0,0,0.01725,0.01725,0.01725,0.13525,0.13525,0.13525,0.3155,0.3155,0.3155,0.39575,0.39575,0.39575,0.47275,0.47275,0.47275],"mcse_q75":[0.000525799083006206,0.000525799083006206,0.000525799083006206,0.000632102693919168,0.000632102693919168,0.000632102693919168,0.000920639283218228,0.000920639283218228,0.000920639283218228,0.00113586760608464,0.00113586760608464,0.00113586760608464,0.00231497866964464,0.00231497866964464,0.00231497866964464,0.00379560496290621,0.00379560496290621,0.00379560496290621,0.00641075838380911,0.00641075838380911,0.00641075838380911,0.00812807186688491,0.00812807186688491,0.00812807186688491,0.00958333023229174,0.00958333023229174,0.00958333023229174],"rhat":[1.00143887457445,1.00143887457445,1.00143887457445,1.00174792445003,1.00174792445003,1.00174792445003,1.00103501274329,1.00103501274329,1.00103501274329,1.00002719332166,1.00002719332166,1.00002719332166,1.00076505585308,1.00076505585308,1.00076505585308,1.0016112347428,1.0016112347428,1.0016112347428,1.00152665431075,1.00152665431075,1.00152665431075,1.00181143704654,1.00181143704654,1.00181143704654,1.00168124910588,1.00168124910588,1.00168124910588],"ess_bulk":[2245.56972169059,2245.56972169059,2245.56972169059,2345.75670035348,2345.75670035348,2345.75670035348,2805.53456229075,2805.53456229075,2805.53456229075,3796.48807564724,3796.48807564724,3796.48807564724,3548.12301743048,3548.12301743048,3548.12301743048,2743.37456361552,2743.37456361552,2743.37456361552,2421.60043643161,2421.60043643161,2421.60043643161,2351.64941644248,2351.64941644248,2351.64941644248,2308.30350888819,2308.30350888819,2308.30350888819],"ess_tail":[2389.73217318302,2389.73217318302,2389.73217318302,2547.80100684538,2547.80100684538,2547.80100684538,2925.72600060049,2925.72600060049,2925.72600060049,3043.50783251611,3043.50783251611,3043.50783251611,2805.90396081412,2805.90396081412,2805.90396081412,2605.97616822564,2605.97616822564,2605.97616822564,2502.34414595111,2502.34414595111,2502.34414595111,2374.00102998384,2374.00102998384,2374.00102998384,2315.23630406672,2315.23630406672,2315.23630406672],"ewoc_ok":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,false,false,false,false,false,false,false,false],"stat":[-554.537532251039,-554.537532251039,-554.537532251039,-452.178504177089,-452.178504177089,-452.178504177089,-298.248392256226,-298.248392256226,-298.248392256226,-217.364291799834,-217.364291799834,-217.364291799834,-73.0400098096062,-73.0400098096062,-73.0400098096062,-18.7428304598455,-18.7428304598455,-18.7428304598455,6.66778796066166,6.66778796066166,6.66778796066166,12.862560778511,12.862560778511,12.862560778511,17.2055512534053,17.2055512534053,17.2055512534053],"ewoc_accurate":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"columns":[{"id":"schedule_id","name":"schedule_id","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.00","2.00","2.00","3.00","3.00","3.00","4.00","4.00","4.00","5.00","5.00","5.00","6.00","6.00","6.00","7.00","7.00","7.00","8.00","8.00","8.00","9.00","9.00","9.00"],"html":true,"align":"right"},{"id":"cycle","name":"cycle","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00","1.00","2.00","3.00"],"html":true,"align":"right"},{"id":"dose_A","name":"dose_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","2.50","2.50","2.50","5.00","5.00","5.00","10.00","10.00","10.00","20.00","20.00","20.00","30.00","30.00","30.00","40.00","40.00","40.00","45.00","45.00","45.00","50.00","50.00","50.00"],"html":true,"align":"right"},{"id":"follow_up","name":"follow_up","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00","28.00"],"html":true,"align":"right"},{"id":"finite_A","name":"finite_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"dose_B","name":"dose_B","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"std_B","name":"std_B","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00"],"html":true,"align":"right"},{"id":"finite_B","name":"finite_B","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"median","name":"median","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.03","0.03","0.03","0.04","0.04","0.04","0.06","0.06","0.06","0.11","0.11","0.11","0.17","0.17","0.17","0.24","0.24","0.24","0.28","0.28","0.28","0.32","0.32","0.32"],"html":true,"align":"right"},{"id":"mean","name":"mean","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.03","0.03","0.03","0.03","0.03","0.03","0.04","0.04","0.04","0.06","0.06","0.06","0.12","0.12","0.12","0.20","0.20","0.20","0.28","0.28","0.28","0.33","0.33","0.33","0.37","0.37","0.37"],"html":true,"align":"right"},{"id":"sd","name":"sd","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.04","0.04","0.04","0.07","0.07","0.07","0.12","0.12","0.12","0.17","0.17","0.17","0.20","0.20","0.20","0.22","0.22","0.22"],"html":true,"align":"right"},{"id":"q25","name":"q25","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.02","0.04","0.04","0.04","0.07","0.07","0.07","0.11","0.11","0.11","0.15","0.15","0.15","0.17","0.17","0.17","0.19","0.19","0.19"],"html":true,"align":"right"},{"id":"q75","name":"q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.04","0.04","0.04","0.04","0.04","0.04","0.06","0.06","0.06","0.08","0.08","0.08","0.16","0.16","0.16","0.26","0.26","0.26","0.37","0.37","0.37","0.43","0.43","0.43","0.49","0.49","0.49"],"html":true,"align":"right"},{"id":"(0,0.16]","name":"(0,0.16]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","0.98","0.98","0.98","0.75","0.75","0.75","0.46","0.46","0.46","0.28","0.28","0.28","0.22","0.22","0.22","0.18","0.18","0.18"],"html":true,"align":"right"},{"id":"(0.16,0.33]","name":"(0.16,0.33]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.02","0.02","0.02","0.24","0.24","0.24","0.40","0.40","0.40","0.41","0.41","0.41","0.39","0.39","0.39","0.35","0.35","0.35"],"html":true,"align":"right"},{"id":"(0.33,1]","name":"(0.33,1]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.02","0.02","0.02","0.14","0.14","0.14","0.32","0.32","0.32","0.40","0.40","0.40","0.47","0.47","0.47"],"html":true,"align":"right"},{"id":"mcse_q75","name":"mcse_q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01","0.01"],"html":true,"align":"right"},{"id":"rhat","name":"rhat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"ess_bulk","name":"ess_bulk","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,245.57","2,245.57","2,245.57","2,345.76","2,345.76","2,345.76","2,805.53","2,805.53","2,805.53","3,796.49","3,796.49","3,796.49","3,548.12","3,548.12","3,548.12","2,743.37","2,743.37","2,743.37","2,421.60","2,421.60","2,421.60","2,351.65","2,351.65","2,351.65","2,308.30","2,308.30","2,308.30"],"html":true,"align":"right"},{"id":"ess_tail","name":"ess_tail","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,389.73","2,389.73","2,389.73","2,547.80","2,547.80","2,547.80","2,925.73","2,925.73","2,925.73","3,043.51","3,043.51","3,043.51","2,805.90","2,805.90","2,805.90","2,605.98","2,605.98","2,605.98","2,502.34","2,502.34","2,502.34","2,374.00","2,374.00","2,374.00","2,315.24","2,315.24","2,315.24"],"html":true,"align":"right"},{"id":"ewoc_ok","name":"ewoc_ok","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"},{"id":"stat","name":"stat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["−554.54","−554.54","−554.54","−452.18","−452.18","−452.18","−298.25","−298.25","−298.25","−217.36","−217.36","−217.36","−73.04","−73.04","−73.04","−18.74","−18.74","−18.74","6.67","6.67","6.67","12.86","12.86","12.86","17.21","17.21","17.21"],"html":true,"align":"right"},{"id":"ewoc_accurate","name":"ewoc_accurate","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"}],"defaultPageSize":5,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"compact":true,"nowrap":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"font-family":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"jzacwqbrco","dataKey":"fedbc2dc335ec32d2f1b3997f9cddfe0"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style","tag.attribs.columns.5.style","tag.attribs.columns.6.style","tag.attribs.columns.7.style","tag.attribs.columns.8.style","tag.attribs.columns.9.style","tag.attribs.columns.10.style","tag.attribs.columns.11.style","tag.attribs.columns.12.style","tag.attribs.columns.13.style","tag.attribs.columns.14.style","tag.attribs.columns.15.style","tag.attribs.columns.16.style","tag.attribs.columns.17.style","tag.attribs.columns.18.style","tag.attribs.columns.19.style","tag.attribs.columns.20.style","tag.attribs.columns.21.style","tag.attribs.columns.22.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cycle <span class="sc">==</span> <span class="dv">3</span>, ewoc_ok) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>std_B, <span class="sc">-</span>prob, <span class="sc">-</span>cprob, <span class="sc">-</span>finite_A, <span class="sc">-</span>finite_B) <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="rkavktpjit" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rkavktpjit table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rkavktpjit thead, #rkavktpjit tbody, #rkavktpjit tfoot, #rkavktpjit tr, #rkavktpjit td, #rkavktpjit th {
  border-style: none;
}

#rkavktpjit p {
  margin: 0;
  padding: 0;
}

#rkavktpjit .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rkavktpjit .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rkavktpjit .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rkavktpjit .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rkavktpjit .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rkavktpjit .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rkavktpjit .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rkavktpjit .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rkavktpjit .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rkavktpjit .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rkavktpjit .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rkavktpjit .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rkavktpjit .gt_spanner_row {
  border-bottom-style: hidden;
}

#rkavktpjit .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rkavktpjit .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rkavktpjit .gt_from_md > :first-child {
  margin-top: 0;
}

#rkavktpjit .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rkavktpjit .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rkavktpjit .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rkavktpjit .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rkavktpjit .gt_row_group_first td {
  border-top-width: 2px;
}

#rkavktpjit .gt_row_group_first th {
  border-top-width: 2px;
}

#rkavktpjit .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rkavktpjit .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rkavktpjit .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rkavktpjit .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rkavktpjit .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rkavktpjit .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rkavktpjit .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rkavktpjit .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rkavktpjit .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rkavktpjit .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rkavktpjit .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rkavktpjit .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rkavktpjit .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rkavktpjit .gt_left {
  text-align: left;
}

#rkavktpjit .gt_center {
  text-align: center;
}

#rkavktpjit .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rkavktpjit .gt_font_normal {
  font-weight: normal;
}

#rkavktpjit .gt_font_bold {
  font-weight: bold;
}

#rkavktpjit .gt_font_italic {
  font-style: italic;
}

#rkavktpjit .gt_super {
  font-size: 65%;
}

#rkavktpjit .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rkavktpjit .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rkavktpjit .gt_indent_1 {
  text-indent: 5px;
}

#rkavktpjit .gt_indent_2 {
  text-indent: 10px;
}

#rkavktpjit .gt_indent_3 {
  text-indent: 15px;
}

#rkavktpjit .gt_indent_4 {
  text-indent: 20px;
}

#rkavktpjit .gt_indent_5 {
  text-indent: 25px;
}

#rkavktpjit .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rkavktpjit div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="rkavktpjit" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="rkavktpjit">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"schedule_id":[1,2,3,4],"cycle":[3,3,3,3],"dose_A":[1,2.5,5,10],"follow_up":[28,28,28,28],"dose_B":[1,1,1,1],"median":[0.0726920374723019,0.0856021977585785,0.109164077811427,0.16324039053284],"mean":[0.084486963635388,0.0974910441428564,0.121309399608264,0.177585149441739],"sd":[0.0518832998681759,0.0565440566989332,0.0662706988113346,0.0906851128996689],"q25":[0.0472050253927265,0.0562568798743089,0.0725175649503196,0.110070475379664],"q75":[0.110901387742446,0.126761707251402,0.157218264314181,0.229164446388083],"(0,0.16]":[0.9155,0.8705,0.75875,0.4845],"(0.16,0.33]":[0.083,0.12625,0.233,0.451],"(0.33,1]":[0.0015,0.00325,0.00825,0.0645],"mcse_q75":[0.00145883229576271,0.00173250949264681,0.00246393149012397,0.00286404358602155],"rhat":[1.0014551469733,1.0017604429486,1.00103554454741,1.00001762770815],"ess_bulk":[2245.56972169059,2345.75670035348,2805.53456229075,3796.48807564724],"ess_tail":[2389.73217318302,2547.80100684538,2925.72600060049,3043.50783251611],"ewoc_ok":[true,true,true,true],"stat":[-150.187662347442,-117.308617130925,-70.1244074270609,-35.207408890026],"ewoc_accurate":[true,true,true,true]},"columns":[{"id":"schedule_id","name":"schedule_id","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.00","3.00","4.00"],"html":true,"align":"right"},{"id":"cycle","name":"cycle","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["3.00","3.00","3.00","3.00"],"html":true,"align":"right"},{"id":"dose_A","name":"dose_A","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","2.50","5.00","10.00"],"html":true,"align":"right"},{"id":"follow_up","name":"follow_up","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["28.00","28.00","28.00","28.00"],"html":true,"align":"right"},{"id":"dose_B","name":"dose_B","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"median","name":"median","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.07","0.09","0.11","0.16"],"html":true,"align":"right"},{"id":"mean","name":"mean","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.08","0.10","0.12","0.18"],"html":true,"align":"right"},{"id":"sd","name":"sd","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.05","0.06","0.07","0.09"],"html":true,"align":"right"},{"id":"q25","name":"q25","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.05","0.06","0.07","0.11"],"html":true,"align":"right"},{"id":"q75","name":"q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.11","0.13","0.16","0.23"],"html":true,"align":"right"},{"id":"(0,0.16]","name":"(0,0.16]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.92","0.87","0.76","0.48"],"html":true,"align":"right"},{"id":"(0.16,0.33]","name":"(0.16,0.33]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.08","0.13","0.23","0.45"],"html":true,"align":"right"},{"id":"(0.33,1]","name":"(0.33,1]","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.01","0.06"],"html":true,"align":"right"},{"id":"mcse_q75","name":"mcse_q75","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["0.00","0.00","0.00","0.00"],"html":true,"align":"right"},{"id":"rhat","name":"rhat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.00","1.00","1.00","1.00"],"html":true,"align":"right"},{"id":"ess_bulk","name":"ess_bulk","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,245.57","2,345.76","2,805.53","3,796.49"],"html":true,"align":"right"},{"id":"ess_tail","name":"ess_tail","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2,389.73","2,547.80","2,925.73","3,043.51"],"html":true,"align":"right"},{"id":"ewoc_ok","name":"ewoc_ok","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"},{"id":"stat","name":"stat","type":"numeric","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["−150.19","−117.31","−70.12","−35.21"],"html":true,"align":"right"},{"id":"ewoc_accurate","name":"ewoc_accurate","type":"logical","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center"}],"defaultPageSize":5,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"compact":true,"nowrap":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"font-family":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"normal","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"rkavktpjit","dataKey":"b997856942da5b4d7527a3993ba59506"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style","tag.attribs.columns.5.style","tag.attribs.columns.6.style","tag.attribs.columns.7.style","tag.attribs.columns.8.style","tag.attribs.columns.9.style","tag.attribs.columns.10.style","tag.attribs.columns.11.style","tag.attribs.columns.12.style","tag.attribs.columns.13.style","tag.attribs.columns.14.style","tag.attribs.columns.15.style","tag.attribs.columns.16.style","tag.attribs.columns.17.style","tag.attribs.columns.18.style","tag.attribs.columns.19.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<p>I.e., we can see that the highest dose that is safe according to the EWOC criterion until the end of cycle 3 would be a dose of 10 for drug A.</p>
</section>
<section id="sec-onco-tte-appendix" class="level2 appendix" data-number="10.10">
<h2 class="appendix anchored" data-number="10.10" data-anchor-id="sec-onco-tte-appendix"><span class="header-section-number">10.10</span> Appendix</h2>
<section id="model-derivation" class="level3 appendix" data-number="10.10.1">
<h3 class="appendix anchored" data-number="10.10.1" data-anchor-id="model-derivation"><span class="header-section-number">10.10.1</span> Model derivation</h3>
<p>For each cycle <span class="math inline">\(j\)</span>, we model the probability of observing a DLT event conditional on entering cycle <span class="math inline">\(j\)</span> as a function of the dose <span class="math inline">\(d_{j}\)</span> being administered during this cycle.</p>
<p>For each patient <span class="math inline">\(i \in {1, \ldots, N}\)</span>, we observe either the DLT event time <span class="math inline">\(T_i\)</span> or the censoring time <span class="math inline">\(C_i\)</span>, whichever occurs first. We denote this as <!-- \unicode{x1D7D9} --></p>
<p><span class="math display">\[
(U_i, \delta_i), \textrm{ where } U_i = \min(T_i, C_i) \textrm{ and } \delta_i = 1(T_i \leq C_i).
\]</span></p>
<p>Here, <span class="math inline">\(U_i\)</span> represents the observed time, and <span class="math inline">\(\delta_i\)</span> indicates whether a DLT occurred (<span class="math inline">\(\delta_i = 1\)</span>) or not (<span class="math inline">\(\delta_i = 0\)</span>).</p>
<p>The primary focus of the model is the risk for DLT events over the course of a sequence of cycles. Thus, we do not aim to model accurately the risk for an event within each cycle. While one could model the event and censoring times as interval censored observations, we disregard here the interval censoring and use a continuous time representation of the time to event process. The continuous time representation can be understood as an approximation of the interval censored process with time lapsing in full units of a cycle. As a consequence, the observed event time <span class="math inline">\(T_i\)</span> and censoring times <span class="math inline">\(C_i\)</span> are always recorded at the planned cycle completion time-point (time lapses in units of cycles). Here we assume for simplicity that each cycle <span class="math inline">\(j\)</span> has the same duration <span class="math inline">\(\Delta t\)</span> such that any time being recorded is a multiple of <span class="math inline">\(\Delta t\)</span> and we denote time <span class="math inline">\(t\)</span> being during a cycle <span class="math inline">\(j\)</span> with <span class="math inline">\(t \in ((j-1) \, \Delta t, j \, \Delta t]\)</span> or equivalently <span class="math inline">\(t \in I_j\)</span> for brevity.</p>
</section>
<section id="definitions-from-survival-analysis" class="level3 appendix" data-number="10.10.2">
<h3 class="appendix anchored" data-number="10.10.2" data-anchor-id="definitions-from-survival-analysis"><span class="header-section-number">10.10.2</span> Definitions from Survival Analysis</h3>
<p>To define our model, we use the following basic definitions from survival analysis. The survival function <span class="math inline">\(S(t)\)</span> and cumulative event probability <span class="math inline">\(F(t)\)</span> are defined as</p>
<p><span class="math display">\[\begin{align*}
S(t) := &amp; \Pr(\textrm{"No event up to time t"}) \\
= &amp; \Pr(T \geq t) \\
= &amp; 1 - F(t),
\end{align*}\]</span></p>
<p>where <span class="math inline">\(F(t) = \Pr(T &lt; t)\)</span>. The respective event densities <span class="math inline">\(s(t)\)</span> and <span class="math inline">\(f(t)\)</span> are <span class="math display">\[
s(t) = \frac{d}{dt}S(t)
     = \frac{d}{dt} \int_t^\infty f(u) du
     = \frac{d}{dt}[1 - F(t)]
     = -f(t)
\]</span> The hazard function <span class="math inline">\(h(t)\)</span> is defined as <span class="math display">\[
h(t) := \lim_{\Delta t \rightarrow 0}\frac{\Pr(t \leq T &lt; t + \Delta t)}{\Delta t \cdot S(t)}
= \lim_{\Delta t \rightarrow 0}\frac{S(t) - S(t + \Delta t)}{\Delta t \cdot S(t)}
= \frac{f(t)}{S(t)} = -\frac{s(t)}{S(t)}
\]</span></p>
<p>and the cumulative hazard function <span class="math inline">\(H(t)\)</span> is given by <span class="math display">\[
H(t) = \int_0^t h(u) du = -\log(S(t)).
\]</span></p>
<p>We now have two quantities that are of particular interest:</p>
<ol type="1">
<li><p>The cumulative DLT probability up to cycle <span class="math inline">\(j\)</span> given a prescribed dosing <span class="math inline">\(\boldsymbol{d} = (d_{1}, d_{2}, d_{3})\)</span> over the three cycles: <span class="math display">\[\Pr(\textrm{"DLT up to cycle j"}|\boldsymbol{d}) =
F(t).\]</span></p></li>
<li><p>The conditional DLT probability of cycle <span class="math inline">\(j\)</span> given survival up to cycle <span class="math inline">\(j-1\)</span> (i.e., not having observed a DLT event up to the end of cycle <span class="math inline">\(j-1\)</span>): <span class="math display">\[\begin{align*}
   \, &amp;  \Pr(\textrm{"DLT in cycle j"}|\textrm{"No DLT up to cycle j-1"}, d_j) \\
= \, &amp;  \Pr(T \leq t + \Delta t|T &gt; t, d_j)\\
= \, &amp;  1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right).
\end{align*}\]</span></p></li>
</ol>
<p>In the following, we will also use the complementary log-log link <span class="math inline">\(\mathrm{cloglog}\)</span>, as well as its inverse <span class="math inline">\(\mathrm{cloglog}^{-1}:\)</span></p>
<p><span class="math display">\[\begin{align}
\mathrm{cloglog}(x) :=&amp;\ \log(-\log(1 - x)), \textrm{ and} \\
\mathrm{cloglog}^{-1}(y) =&amp;\ 1 - \exp(-\exp(y)).
\end{align}\]</span></p>
</section>
<section id="model-definition-1" class="level3 appendix" data-number="10.10.3">
<h3 class="appendix anchored" data-number="10.10.3" data-anchor-id="model-definition-1"><span class="header-section-number">10.10.3</span> Model definition</h3>
<p>Given the drug dose <span class="math inline">\(d_{j}\)</span> administered in cycle <span class="math inline">\(j\)</span>, we model the log-hazard <span class="math inline">\(\log(h_j(t|\tilde{d}_{j}))\)</span> as <span class="math display">\[
\log(h_j(t|\tilde{d}_{j})) = \alpha + \beta \log\left(\tilde{d}_{j}\right), \textrm{ where } \tilde{d}_{j} = \frac{d_{j}}{\tilde{d}}
\]</span> and <span class="math inline">\(\tilde{d}\)</span> is the reference dose. The conditional DLT probability over 1 cycle in this model is then</p>
<p><span class="math display">\[\begin{align}
\Pr(T \leq t + \Delta t|T &gt; t, \tilde{d}_{j}) &amp; = 1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right)\\
&amp; = 1 - \exp\left(-\int_{t}^{t + \Delta t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right)\right) du \right) \\
&amp; = 1 - \exp\left(-\Delta t \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right)\right) \right) \\
&amp; = 1 - \exp\left(-\exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right) \right).
\end{align}\]</span></p>
<p>This is closely related to the classic two-parameter Bayesian Logistic Regression Model (BLRM), since the conditional probability of observing a DLT,</p>
<p><span class="math display">\[\begin{align}
\mathrm{cloglog}\Pr(T \leq t + \Delta t|T &gt; t, d_j) &amp; = \alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t),
\end{align}\]</span></p>
<p>is the same as for the BLRM in cycle one if we elapse time in cycles (then <span class="math inline">\(\Delta t = 1\)</span> and the <span class="math inline">\(\log(\Delta t)\)</span> is zero), except for the link function changing from <span class="math inline">\(\mathrm{logit}\)</span> to <span class="math inline">\(\mathrm{cloglog}\)</span>.</p>
<p>The cumulative DLT probability can also be derived, where <span class="math inline">\(j_t\)</span> is the index of the cycle that time <span class="math inline">\(t\)</span> lies in:</p>
<p><span class="math display">\[\begin{align}
\mathrm{cloglog}\Pr(T \leq t|\boldsymbol{d}) &amp; = \log\left(\sum_{j = 1}^{j_t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right)\right) = \mathrm{cloglog} F(t|\boldsymbol{d}).
\end{align}\]</span></p>
<p>Last, but not least, the likelihood for all patients <span class="math inline">\(i\)</span> is then <span class="math display">\[
L(U|\alpha, \beta) = \prod_i \underbrace{ f(T_i)^{\delta_i} }_\textrm{DLT
events} \, \underbrace{S(C_i)^{1 - \delta_i}}_\textrm{Survival
events} \,,
\]</span> and the log-likelihood <span class="math display">\[
LL(U|\alpha, \beta) = \underbrace{\sum_i \log\left(f(T_i)\right) \delta_i}_\textrm{DLT
events} + \underbrace{\sum_i \log\left(S(C_i)\right)\left(1 - \delta_i\right)}_\textrm{Survival
events} \,.
\]</span></p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/opensource\.nibr\.com\/bamdd\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../src/02c_dose_escalation.html" class="pagination-link" aria-label="Oncology dose escalation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Oncology dose escalation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../src/02e_multiple_imputation.html" class="pagination-link" aria-label="Multiple imputation">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple imputation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">  - Lukas Widmer - &lt;lukas_andreas.widmer@novartis.com&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - Sebastian Weber - &lt;sebastian.weber@novartis.com&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Time-to-event modelling in Oncology dose escalation {#sec-tte-oncology}</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- https://raw.githubusercontent.com/Novartis/bamdd/main/src/_macros.qmd --&gt;</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>{{&lt; include _macros.qmd &gt;}}</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>This case study demonstrates</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>setting up a time-to-event model and prior with explicit modeling of a </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  piecewise-constant log-hazard in <span class="in">`brms`</span> using Poisson regression</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how this time-to-event model relates to the standard BLRM</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>computing and visualizing conditional and cumulative event probabilities</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how to determine the impact of the Monte Carlo Standard Error (MCSE) on </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  decision criteria, e.g., Escalation With Overdose Control (EWOC)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>in the exercise: setting up custom <span class="in">`brms`</span> link functions for the two-drug case</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-profile="dummy"}</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview Video</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>{{&lt; video videos/brms3-hq-alt-4-tte-onc.mp4 &gt;}}</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>The aim of Oncology Phase-I trials is to identify a drug dose which is</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>reasonable safe to use and efficacious at the same time. As cytotoxic</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>drugs aim to kill cancer cells, it is expected that toxicity events</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>are to some extent a surrogate for efficacy of the drug. Due to the</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>life-threatening nature of the disease one thereby uses *dose</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>escalation* trial designs to identify the maximum tolerated dose (MTD)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>or recommended dose (RD) rapidly. These trials enroll small patient</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>cohorts at some drug dose and then assess at a dose escalation meeting</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>(DEM) all safety events occurring over the time-course of a treatment</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>cycle (often 4 weeks). The safety events classified as dose limiting</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>toxicities (DLTs) then determine which dose levels are safe for use in</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>the next patient cohort. In this way an increasing data set on the</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>toxicity of the drug emerges as the trial continues.</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>There are many approaches on how to guide dose escalation trials at a</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>DEM. Traditional designs such as the 3+3 design are based on</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>algorithmic rules governing the decision for the subsequent cohort</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>based on the outcome at the current dose. Specifically, 3 patients are</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>enrolled onto a cohort and the drug dose is increased in case no DLT</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>occurs, if 1 DLT occurs the drug dose is kept constant while it is</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>decreased if more DLTs occur. Whenever two cohorts in sequence observe</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>1 out of 3, the 3+3 trial completes. This is in line with the goal</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>of a 33% DLT rate at the MTD. It has been shown that these rule-based</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>approaches have rather poor statistical properties and model based</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>approaches have been proposed. In particular, Bayesian model-based</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>designs have proven to provide greater flexibility and improved</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>performance for estimating the MTD, while protecting patient</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>safety. In the model-based paradigm for dose escalation, one develops</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>a model for the dose-toxicity relationship. As DLT data accumulates</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>on-study, the model is used to adaptively guide dose escalation</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>decisions. Bayesian approaches are well-suited for this setting, due</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>in part to the limited amount of available data (Phase-I studies are</span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>generally small).</span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>Recent, more targeted treatments, have challenged several aspects</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>taken for granted for traditional cytotoxic therapies, such as</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Estimating the MTD over just one treatment cycle**: since targeted</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>  therapies are typically safer than cytotoxic ones and are applied</span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>  over longer time periods, estimating longer-term (multi-cycle)</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>  dose-toxicity relationships has become more important. However, we</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>  typically do not want to wait for the full time period (e.g., 3</span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>  cycles) to decide the dose for the next cohort. That is, after the</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>  first cycle, one may want to extrapolate to the dose-toxicity</span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>  relationship over 3 cycles given a prior on how the conditional</span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>  toxicity of the next cycles changes with respect to the first</span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>  one. However, this is not easily feasible with methods that only use</span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>  binary (DLT yes/no) data.</span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Constant dosing regimen**: For some targeted treatments it may be</span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a>  advantageous to vary the dosing regimen, for instance, by performing</span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>  within-patient dose-ramp-up over several weeks to avoid cytokine</span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a>  release syndrome. However, classical binary cycle-1 methods such as</span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a>  the 3+3, BOIN or the Bayesian Logistic Regression Model (BLRM) are not able </span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>  to directly incorporate time-varying dosing or hazard reductions due to</span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>  ramp-up dosing.</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Ignoring dropout**: In classical binary dose-DLT methods, where</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a>  DLT yes/no was measured for each patient over the first treatment</span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a>  cycle, data from patients that dropped out during this cycle (for</span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a>  instance due to disease progression) is typically ignored. This is</span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a>  no longer an option with modern cancer treatments in Phase I that</span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a>  are both taken over longer time periods where dropout is more</span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a>  likely, as well as administered in last-line treatment populations</span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a>  with aggressive cancers / rapid dropout due to disease progression.</span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a>These challenges can be addressed by switching to time-to-first-event</span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a>(time-to-DLT) modeling with piecewise-constant hazards, where the</span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a>constant period is chosen to align with a period of interest. For</span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a>instance, if the dose-toxicity relationship over 3 cycles is of</span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a>interest, one might choose to model piecewise-constant hazards per</span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a>cycle, or if we are interested in the dose-toxicity relationship of</span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a>several regimens that contain within-patient ramp-up of dosing on a</span>
<span id="cb42-105"><a href="#cb42-105" aria-hidden="true" tabindex="-1"></a>weekly basis, we might choose piecewise-constant hazards for each</span>
<span id="cb42-106"><a href="#cb42-106" aria-hidden="true" tabindex="-1"></a>week.</span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Required libraries</span></span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a>To run the R code of this section please ensure to load these</span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a>libraries and options first:</span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=TRUE,echo=TRUE,message=FALSE,warning=FALSE}</span></span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(assertthat)</span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="dv">12</span>))</span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a><span class="co"># instruct brms to use cmdstanr as backend and cache all Stan binaries</span></span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>, <span class="at">cmdstanr_write_stan_file_dir=</span><span class="fu">here</span>(<span class="st">"_brms-cache"</span>))</span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a><span class="co"># create cache directory if not yet available</span></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">"_brms-cache"</span>), <span class="cn">FALSE</span>)</span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8794567</span>)</span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Table formatting helper function:</span></span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a>gt_format <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals=</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_interactive</span>(</span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">page_size_default =</span> <span class="dv">5</span>, </span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_text_wrapping =</span> F, </span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_compact_mode =</span> T</span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE, echo=FALSE, eval=TRUE}</span></span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible to the reader additional setup steps, which are optional</span></span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a><span class="co"># {{&lt; include setup.R &gt;}}</span></span>
<span id="cb42-148"><a href="#cb42-148" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"setup.R"</span>)</span>
<span id="cb42-149"><a href="#cb42-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example trial</span></span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a>In the following, we will assume a simple setting of a first-in-human</span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a>(FIH) study of a new Oncology treatment. Here, we consider the</span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a>dose-DLT relationship over a time horizon of 3 treatment cycles, a cycle</span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a>length of 4 weeks, and daily (QD) dosing of a drug A at a pre-defined</span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a>dose set with reference dose $\tilde{d} = 50$ (at the reference dose</span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a>we anticipate the MTD *a priori*):</span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-162"><a href="#cb42-162" aria-hidden="true" tabindex="-1"></a>cycle_lengths <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">weeks</span>(<span class="dv">4</span>), <span class="dv">3</span>)</span>
<span id="cb42-163"><a href="#cb42-163" aria-hidden="true" tabindex="-1"></a>dref_A <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a>doses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">50</span>)</span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-166"><a href="#cb42-166" aria-hidden="true" tabindex="-1"></a>cycle_seq <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(cycle_lengths)</span>
<span id="cb42-167"><a href="#cb42-167" aria-hidden="true" tabindex="-1"></a>dose_seq  <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(doses)</span>
<span id="cb42-168"><a href="#cb42-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a>We will use the logarithm of the normalized dose (with respect to a</span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a>reference dose $\tilde{d}$ ), $\log\left(\tilde{d}_{j}\right) =</span>
<span id="cb42-172"><a href="#cb42-172" aria-hidden="true" tabindex="-1"></a>\log\left(d_{j} / \tilde{d}\right)$, where $j$ is the cycle index. We</span>
<span id="cb42-173"><a href="#cb42-173" aria-hidden="true" tabindex="-1"></a>define a helper function to add this column as <span class="in">`std_A`</span>, and whether</span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a>the log-dose is finite as <span class="in">`finite_A`</span>, which will become relevant in the</span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a>case of drug combinations.</span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a>add_std_dose_col <span class="ot">&lt;-</span> <span class="cf">function</span>(dose_info, <span class="at">drug =</span> <span class="st">"A"</span>, dref) {</span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a>  dose_info <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"std_{drug}"</span>    <span class="sc">:</span><span class="er">=</span> <span class="fu">log</span>(<span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"dose_"</span>, drug)) <span class="sc">/</span> dref), </span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"finite_{drug}"</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span>L <span class="sc">*</span> (<span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"dose_"</span>, drug)) <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a>We now need individual patient data (IPD) containing:</span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-191"><a href="#cb42-191" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The doses planned to be administered in each of the three cycles,</span>
<span id="cb42-192"><a href="#cb42-192" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The start and end dates of each cycle</span>
<span id="cb42-193"><a href="#cb42-193" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The date of censoring (either at the end of the last cycle due to</span>
<span id="cb42-194"><a href="#cb42-194" aria-hidden="true" tabindex="-1"></a>  end of the observation period, or during the trial due to dropout)</span>
<span id="cb42-195"><a href="#cb42-195" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The date of DLT </span>
<span id="cb42-196"><a href="#cb42-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-197"><a href="#cb42-197" aria-hidden="true" tabindex="-1"></a>As an example, we create 3-cycle data in long format reflecting the</span>
<span id="cb42-198"><a href="#cb42-198" aria-hidden="true" tabindex="-1"></a>data used in the BLRM dose escalation case study: </span>
<span id="cb42-199"><a href="#cb42-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-202"><a href="#cb42-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-203"><a href="#cb42-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single patient</span></span>
<span id="cb42-204"><a href="#cb42-204" aria-hidden="true" tabindex="-1"></a>example_ipd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-205"><a href="#cb42-205" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle_index =</span> cycle_seq,</span>
<span id="cb42-206"><a href="#cb42-206" aria-hidden="true" tabindex="-1"></a>  <span class="at">dose_A =</span> <span class="dv">1</span>,</span>
<span id="cb42-207"><a href="#cb42-207" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_toxicities =</span> <span class="dv">0</span>,</span>
<span id="cb42-208"><a href="#cb42-208" aria-hidden="true" tabindex="-1"></a>  <span class="at">follow_up =</span> <span class="fu">as.numeric</span>(cycle_lengths, <span class="st">"days"</span>)</span>
<span id="cb42-209"><a href="#cb42-209" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb42-210"><a href="#cb42-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-211"><a href="#cb42-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Create long-format individual-patient data (IPD) corresponding to the one </span></span>
<span id="cb42-212"><a href="#cb42-212" aria-hidden="true" tabindex="-1"></a><span class="co"># in the BLRM dose escalation case study</span></span>
<span id="cb42-213"><a href="#cb42-213" aria-hidden="true" tabindex="-1"></a>ipd <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb42-214"><a href="#cb42-214" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">3</span>)),</span>
<span id="cb42-215"><a href="#cb42-215" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">4</span>)),</span>
<span id="cb42-216"><a href="#cb42-216" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">5</span>)   <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">5</span>)),</span>
<span id="cb42-217"><a href="#cb42-217" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">10</span>)  <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), <span class="dv">4</span>)),</span>
<span id="cb42-218"><a href="#cb42-218" aria-hidden="true" tabindex="-1"></a>  example_ipd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dose_A =</span> <span class="dv">25</span>, <span class="at">num_toxicities =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb42-219"><a href="#cb42-219" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)</span>
<span id="cb42-220"><a href="#cb42-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-221"><a href="#cb42-221" aria-hidden="true" tabindex="-1"></a>ipd <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span>
<span id="cb42-222"><a href="#cb42-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-223"><a href="#cb42-223" aria-hidden="true" tabindex="-1"></a>We define dosing schedules that we want to compute DLT probabilities for. Here,</span>
<span id="cb42-224"><a href="#cb42-224" aria-hidden="true" tabindex="-1"></a>we choose schedules that are constant over all three cycles: </span>
<span id="cb42-225"><a href="#cb42-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-228"><a href="#cb42-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-229"><a href="#cb42-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Dosing information per cycle</span></span>
<span id="cb42-230"><a href="#cb42-230" aria-hidden="true" tabindex="-1"></a>dose_info_long <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">schedule_id =</span> dose_seq, <span class="at">cycle =</span> cycle_seq) <span class="sc">|&gt;</span></span>
<span id="cb42-231"><a href="#cb42-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose_A =</span> doses[schedule_id])</span>
<span id="cb42-232"><a href="#cb42-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-233"><a href="#cb42-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Cycle information</span></span>
<span id="cb42-234"><a href="#cb42-234" aria-hidden="true" tabindex="-1"></a>cycle_info <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-235"><a href="#cb42-235" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle =</span> cycle_seq, </span>
<span id="cb42-236"><a href="#cb42-236" aria-hidden="true" tabindex="-1"></a>  <span class="at">follow_up =</span> <span class="fu">as.numeric</span>(cycle_lengths, <span class="st">"days"</span>)</span>
<span id="cb42-237"><a href="#cb42-237" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-238"><a href="#cb42-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-239"><a href="#cb42-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-240"><a href="#cb42-240" aria-hidden="true" tabindex="-1"></a>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span>
<span id="cb42-241"><a href="#cb42-241" aria-hidden="true" tabindex="-1"></a>We also generate a reference dosing data set which is formatted like</span>
<span id="cb42-242"><a href="#cb42-242" aria-hidden="true" tabindex="-1"></a>an analysis data set, but is only setup to evaluate the final model on</span>
<span id="cb42-243"><a href="#cb42-243" aria-hidden="true" tabindex="-1"></a>the predefined set of doses. These will be needed to compute </span>
<span id="cb42-244"><a href="#cb42-244" aria-hidden="true" tabindex="-1"></a>the conditional (or cumulative) DLT probabilities in (up to) cycles 1, 2 and 3:</span>
<span id="cb42-245"><a href="#cb42-245" aria-hidden="true" tabindex="-1"></a><span class="fu">=======</span></span>
<span id="cb42-246"><a href="#cb42-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-247"><a href="#cb42-247" aria-hidden="true" tabindex="-1"></a>We also generate a reference dosing data set which is formatted</span>
<span id="cb42-248"><a href="#cb42-248" aria-hidden="true" tabindex="-1"></a>like an analysis data set, but is only setup to evaluate the final</span>
<span id="cb42-249"><a href="#cb42-249" aria-hidden="true" tabindex="-1"></a>model on the predefined set of doses. These will be needed to compute</span>
<span id="cb42-250"><a href="#cb42-250" aria-hidden="true" tabindex="-1"></a>the conditional (or cumulative) DLT probabilities in (up to) cycles 1,</span>
<span id="cb42-251"><a href="#cb42-251" aria-hidden="true" tabindex="-1"></a>2 and 3:</span>
<span id="cb42-252"><a href="#cb42-252" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/develop</span></span>
<span id="cb42-253"><a href="#cb42-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-256"><a href="#cb42-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-257"><a href="#cb42-257" aria-hidden="true" tabindex="-1"></a>dose_ref_data <span class="ot">&lt;-</span> dose_info_long <span class="sc">|&gt;</span></span>
<span id="cb42-258"><a href="#cb42-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(cycle_info, <span class="at">by=</span><span class="st">"cycle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-259"><a href="#cb42-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">num_toxicities=</span><span class="dv">0</span>L) <span class="sc">|&gt;</span></span>
<span id="cb42-260"><a href="#cb42-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)</span>
<span id="cb42-261"><a href="#cb42-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-262"><a href="#cb42-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-263"><a href="#cb42-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model description</span></span>
<span id="cb42-264"><a href="#cb42-264" aria-hidden="true" tabindex="-1"></a>For each cycle $j$, we model the probability of observing a DLT event</span>
<span id="cb42-265"><a href="#cb42-265" aria-hidden="true" tabindex="-1"></a>conditional on entering cycle $j$ as a function of the dose $d_{j}$</span>
<span id="cb42-266"><a href="#cb42-266" aria-hidden="true" tabindex="-1"></a>being administered during this cycle.</span>
<span id="cb42-267"><a href="#cb42-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-268"><a href="#cb42-268" aria-hidden="true" tabindex="-1"></a>For each patient $i \in {1, \ldots, N}$, we observe either the DLT</span>
<span id="cb42-269"><a href="#cb42-269" aria-hidden="true" tabindex="-1"></a>event time $T_i$ or the censoring time $C_i$, whichever occurs</span>
<span id="cb42-270"><a href="#cb42-270" aria-hidden="true" tabindex="-1"></a>first. We denote this as <span class="co">&lt;!-- \unicode{x1D7D9} --&gt;</span></span>
<span id="cb42-271"><a href="#cb42-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-272"><a href="#cb42-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-273"><a href="#cb42-273" aria-hidden="true" tabindex="-1"></a>(U_i, \delta_i), \textrm{ where } U_i = \min(T_i, C_i) \textrm{ and } \delta_i = 1(T_i \leq C_i).</span>
<span id="cb42-274"><a href="#cb42-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-275"><a href="#cb42-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-276"><a href="#cb42-276" aria-hidden="true" tabindex="-1"></a>Here, $U_i$ represents the observed time, and $\delta_i$ indicates</span>
<span id="cb42-277"><a href="#cb42-277" aria-hidden="true" tabindex="-1"></a>whether a DLT occurred $(\delta_i = 1)$ or not ($\delta_i = 0)$.</span>
<span id="cb42-278"><a href="#cb42-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-279"><a href="#cb42-279" aria-hidden="true" tabindex="-1"></a>The primary focus of the model is the risk for DLT events over the</span>
<span id="cb42-280"><a href="#cb42-280" aria-hidden="true" tabindex="-1"></a>course of a sequence of cycles. Thus, we do not aim to model</span>
<span id="cb42-281"><a href="#cb42-281" aria-hidden="true" tabindex="-1"></a>accurately the risk for an event within each cycle. While one could</span>
<span id="cb42-282"><a href="#cb42-282" aria-hidden="true" tabindex="-1"></a>model the event and censoring times as interval censored observations,</span>
<span id="cb42-283"><a href="#cb42-283" aria-hidden="true" tabindex="-1"></a>we disregard here the interval censoring and use a continuous time</span>
<span id="cb42-284"><a href="#cb42-284" aria-hidden="true" tabindex="-1"></a>representation of the time to event process. The continuous time</span>
<span id="cb42-285"><a href="#cb42-285" aria-hidden="true" tabindex="-1"></a>representation can be understood as an approximation of the interval</span>
<span id="cb42-286"><a href="#cb42-286" aria-hidden="true" tabindex="-1"></a>censored process with time lapsing in full units of a cycle. As a</span>
<span id="cb42-287"><a href="#cb42-287" aria-hidden="true" tabindex="-1"></a>consequence, the observed event time $T_i$ and censoring times $C_i$</span>
<span id="cb42-288"><a href="#cb42-288" aria-hidden="true" tabindex="-1"></a>are always recorded at the planned cycle completion time-point (time</span>
<span id="cb42-289"><a href="#cb42-289" aria-hidden="true" tabindex="-1"></a>lapses in units of cycles). Here we assume for simplicity that each</span>
<span id="cb42-290"><a href="#cb42-290" aria-hidden="true" tabindex="-1"></a>cycle $j$ has the same duration $\Delta t$ such that any time being</span>
<span id="cb42-291"><a href="#cb42-291" aria-hidden="true" tabindex="-1"></a>recorded is a multiple of $\Delta t$ and we denote time $t$ being</span>
<span id="cb42-292"><a href="#cb42-292" aria-hidden="true" tabindex="-1"></a>during a cycle $j$ with $t \in ((j-1) \, \Delta t, j \, \Delta t]$ or</span>
<span id="cb42-293"><a href="#cb42-293" aria-hidden="true" tabindex="-1"></a>equivalently $t \in I_j$ for brevity.</span>
<span id="cb42-294"><a href="#cb42-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-295"><a href="#cb42-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model definition</span></span>
<span id="cb42-296"><a href="#cb42-296" aria-hidden="true" tabindex="-1"></a>To define our model, we use the following basic definitions from</span>
<span id="cb42-297"><a href="#cb42-297" aria-hidden="true" tabindex="-1"></a>survival analysis. The survival function $S(t)$ and cumulative event</span>
<span id="cb42-298"><a href="#cb42-298" aria-hidden="true" tabindex="-1"></a>probability $F(t)$ are defined as</span>
<span id="cb42-299"><a href="#cb42-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-300"><a href="#cb42-300" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-301"><a href="#cb42-301" aria-hidden="true" tabindex="-1"></a>S(t) := &amp; \Pr(\textrm{"No event up to time t"}) = \Pr(T \geq t) = 1 - F(t).</span>
<span id="cb42-302"><a href="#cb42-302" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-303"><a href="#cb42-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-304"><a href="#cb42-304" aria-hidden="true" tabindex="-1"></a>We now have two quantities that are of particular interest:</span>
<span id="cb42-305"><a href="#cb42-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-306"><a href="#cb42-306" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The cumulative DLT probability up to cycle $j$ given a prescribed</span>
<span id="cb42-307"><a href="#cb42-307" aria-hidden="true" tabindex="-1"></a>   dosing $\boldsymbol{d} = (d_{1}, d_{2}, d_{3})$ over the three</span>
<span id="cb42-308"><a href="#cb42-308" aria-hidden="true" tabindex="-1"></a>   cycles: $$\Pr(\textrm{"DLT up to cycle j"}|\boldsymbol{d}) =</span>
<span id="cb42-309"><a href="#cb42-309" aria-hidden="true" tabindex="-1"></a>   F(t).$$</span>
<span id="cb42-310"><a href="#cb42-310" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb42-311"><a href="#cb42-311" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The conditional DLT probability of cycle $j$ given survival up to cycle $j-1$ (i.e., not having observed a DLT event up to the end of cycle $j-1$):</span>
<span id="cb42-312"><a href="#cb42-312" aria-hidden="true" tabindex="-1"></a>   \begin{align*}</span>
<span id="cb42-313"><a href="#cb42-313" aria-hidden="true" tabindex="-1"></a>      \, &amp;  \Pr(\textrm{"DLT in cycle j"}|\textrm{"No DLT up to cycle j-1"}, d_j) <span class="sc">\\</span></span>
<span id="cb42-314"><a href="#cb42-314" aria-hidden="true" tabindex="-1"></a>    = \, &amp;  \Pr(T \leq t + \Delta t|T &gt; t, d_j)<span class="sc">\\</span></span>
<span id="cb42-315"><a href="#cb42-315" aria-hidden="true" tabindex="-1"></a>    = \, &amp;  1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right),</span>
<span id="cb42-316"><a href="#cb42-316" aria-hidden="true" tabindex="-1"></a>   \end{align*}</span>
<span id="cb42-317"><a href="#cb42-317" aria-hidden="true" tabindex="-1"></a>   where $h(u)$ is the hazard function and $H(t) = \int_{0}^{t} h(u) du$ the cumulative hazard.</span>
<span id="cb42-318"><a href="#cb42-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-319"><a href="#cb42-319" aria-hidden="true" tabindex="-1"></a>Given the drug dose $d_{j}$ administered in cycle $j$, we model the log-hazard $\log(h_j(t|\tilde{d}_{j}))$ as </span>
<span id="cb42-320"><a href="#cb42-320" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-321"><a href="#cb42-321" aria-hidden="true" tabindex="-1"></a>\log(h_j(t|\tilde{d}_{j})) = \alpha + \beta \log\left(\tilde{d}_{j}\right), \textrm{ where } \tilde{d}_{j} = \frac{d_{j}}{\tilde{d}}</span>
<span id="cb42-322"><a href="#cb42-322" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-323"><a href="#cb42-323" aria-hidden="true" tabindex="-1"></a>and $\tilde{d}$ is the reference dose. Then (see @sec-onco-tte-appendix for the full derivation), the conditional DLT probability is </span>
<span id="cb42-324"><a href="#cb42-324" aria-hidden="true" tabindex="-1"></a>closely related to the classic two-parameter Bayesian Logistic Regression Model </span>
<span id="cb42-325"><a href="#cb42-325" aria-hidden="true" tabindex="-1"></a>(BLRM), since</span>
<span id="cb42-326"><a href="#cb42-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-327"><a href="#cb42-327" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-328"><a href="#cb42-328" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}\Pr(T \leq t + \Delta t|T &gt; t, d_j) &amp; = \alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t),</span>
<span id="cb42-329"><a href="#cb42-329" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-330"><a href="#cb42-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-331"><a href="#cb42-331" aria-hidden="true" tabindex="-1"></a>is the same as for the BLRM in cycle one if we elapse time in cycles</span>
<span id="cb42-332"><a href="#cb42-332" aria-hidden="true" tabindex="-1"></a>(then $\Delta t = 1$ and the $\log(\Delta t)$ is zero), except for the</span>
<span id="cb42-333"><a href="#cb42-333" aria-hidden="true" tabindex="-1"></a>link function changing from $\mathrm{logit}$ to $\mathrm{cloglog}(x) = \log(-\log(1 - x))$.</span>
<span id="cb42-334"><a href="#cb42-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-335"><a href="#cb42-335" aria-hidden="true" tabindex="-1"></a>The cumulative DLT probability can also be derived, where $j_t$ is the</span>
<span id="cb42-336"><a href="#cb42-336" aria-hidden="true" tabindex="-1"></a>index of the cycle that time $t$ lies in:</span>
<span id="cb42-337"><a href="#cb42-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-338"><a href="#cb42-338" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-339"><a href="#cb42-339" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}\Pr(T \leq t|\boldsymbol{d}) &amp; = \log\left(\sum_{j = 1}^{j_t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right)\right) = \mathrm{cloglog} F(t|\boldsymbol{d}).</span>
<span id="cb42-340"><a href="#cb42-340" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-341"><a href="#cb42-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-342"><a href="#cb42-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-343"><a href="#cb42-343" aria-hidden="true" tabindex="-1"></a>Last, but not least, the likelihood for all patients $i$ is then</span>
<span id="cb42-344"><a href="#cb42-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-345"><a href="#cb42-345" aria-hidden="true" tabindex="-1"></a>L(U|\alpha, \beta) = \prod_i \underbrace{ f(T_i)^{\delta_i} }_\textrm{DLT</span>
<span id="cb42-346"><a href="#cb42-346" aria-hidden="true" tabindex="-1"></a> events} \, \underbrace{S(C_i)^{1 - \delta_i}}_\textrm{Censoring event} \,.</span>
<span id="cb42-347"><a href="#cb42-347" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-348"><a href="#cb42-348" aria-hidden="true" tabindex="-1"></a>In order to fit these models to time to first event data it is helpful</span>
<span id="cb42-349"><a href="#cb42-349" aria-hidden="true" tabindex="-1"></a>to consider its representation as a Poisson regression. Since $f(t) =</span>
<span id="cb42-350"><a href="#cb42-350" aria-hidden="true" tabindex="-1"></a>h(t) \, S(t)$ and $S(t) = \exp\left(-H(t)\right)$ from basic</span>
<span id="cb42-351"><a href="#cb42-351" aria-hidden="true" tabindex="-1"></a>survival analysis, it follows that the likelihood contribution in</span>
<span id="cb42-352"><a href="#cb42-352" aria-hidden="true" tabindex="-1"></a>absence of an event is $\exp(-H(t))$ while it is $h(t) \,</span>
<span id="cb42-353"><a href="#cb42-353" aria-hidden="true" tabindex="-1"></a>\exp(-H(t))$ whenever an event occurs.</span>
<span id="cb42-354"><a href="#cb42-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-355"><a href="#cb42-355" aria-hidden="true" tabindex="-1"></a>The Poisson distribution for observing $k$ events,</span>
<span id="cb42-356"><a href="#cb42-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-357"><a href="#cb42-357" aria-hidden="true" tabindex="-1"></a>$$ \Pr(k|\lambda) = \frac{\lambda^k \, \exp(-\lambda)}{k!}, $$</span>
<span id="cb42-358"><a href="#cb42-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-359"><a href="#cb42-359" aria-hidden="true" tabindex="-1"></a>becomes $\exp(-\lambda)$ for no event ($k=0$) and $\lambda \,</span>
<span id="cb42-360"><a href="#cb42-360" aria-hidden="true" tabindex="-1"></a>\exp(-\lambda)$ for an event ($k=1$). Therefore, we can model the data</span>
<span id="cb42-361"><a href="#cb42-361" aria-hidden="true" tabindex="-1"></a>using a Poisson regression approach whenever the hazard is constant</span>
<span id="cb42-362"><a href="#cb42-362" aria-hidden="true" tabindex="-1"></a>over the time units we model, $h(t) = \lambda$. In this case the</span>
<span id="cb42-363"><a href="#cb42-363" aria-hidden="true" tabindex="-1"></a>counts on each time interval are $0$ or $1$. Moreover, we use a $\log$</span>
<span id="cb42-364"><a href="#cb42-364" aria-hidden="true" tabindex="-1"></a>link function for the counting rate $\lambda$ and model with a linear</span>
<span id="cb42-365"><a href="#cb42-365" aria-hidden="true" tabindex="-1"></a>function the $\log$ counting rate to ensure its</span>
<span id="cb42-366"><a href="#cb42-366" aria-hidden="true" tabindex="-1"></a>positivity. Importantly, we also add to the linear predictor an offset</span>
<span id="cb42-367"><a href="#cb42-367" aria-hidden="true" tabindex="-1"></a>equal to the $\log$ of the exposure time $\log(\Delta t)$. The offset</span>
<span id="cb42-368"><a href="#cb42-368" aria-hidden="true" tabindex="-1"></a>multiplies $\lambda$ with $\Delta t$ and thereby turns the constant</span>
<span id="cb42-369"><a href="#cb42-369" aria-hidden="true" tabindex="-1"></a>counting rate $\lambda$ into a cumulative hazard $H(t) = \lambda \,</span>
<span id="cb42-370"><a href="#cb42-370" aria-hidden="true" tabindex="-1"></a>\Delta t$. Thereby we obtain the desired likelihood.</span>
<span id="cb42-371"><a href="#cb42-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-372"><a href="#cb42-372" aria-hidden="true" tabindex="-1"></a>Note, that when using the Poisson approach in <span class="in">`brms`</span> we pass the</span>
<span id="cb42-373"><a href="#cb42-373" aria-hidden="true" tabindex="-1"></a>cumulative hazard $\lambda \, \Delta t$ as argument to the counting</span>
<span id="cb42-374"><a href="#cb42-374" aria-hidden="true" tabindex="-1"></a>rate such that the likelihood term for an event becomes $\lambda \,</span>
<span id="cb42-375"><a href="#cb42-375" aria-hidden="true" tabindex="-1"></a>\Delta t \, \exp(-\lambda \, \Delta t)$, which is not quite equal to</span>
<span id="cb42-376"><a href="#cb42-376" aria-hidden="true" tabindex="-1"></a>$f(t)$ as required above, but is instead equal to $\Delta t \,</span>
<span id="cb42-377"><a href="#cb42-377" aria-hidden="true" tabindex="-1"></a>f(t)$. However, as $\Delta t$ is known it is merely a constant and is</span>
<span id="cb42-378"><a href="#cb42-378" aria-hidden="true" tabindex="-1"></a>hence irrelevant for sampling the posterior.</span>
<span id="cb42-379"><a href="#cb42-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-380"><a href="#cb42-380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model prior</span></span>
<span id="cb42-381"><a href="#cb42-381" aria-hidden="true" tabindex="-1"></a>For the above model, we must define a prior for the parameters</span>
<span id="cb42-382"><a href="#cb42-382" aria-hidden="true" tabindex="-1"></a>$\alpha$ and $\beta$. The interpretation of these parameters depends</span>
<span id="cb42-383"><a href="#cb42-383" aria-hidden="true" tabindex="-1"></a>on two reference values, the reference *dose* $\tilde{d}$ and</span>
<span id="cb42-384"><a href="#cb42-384" aria-hidden="true" tabindex="-1"></a>reference *time point* $\tilde{t}$.</span>
<span id="cb42-385"><a href="#cb42-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-386"><a href="#cb42-386" aria-hidden="true" tabindex="-1"></a>The reference dose $\tilde{d}$, with respect to which the dose is normalized,</span>
<span id="cb42-387"><a href="#cb42-387" aria-hidden="true" tabindex="-1"></a>defines the meaning of the intercept parameter $\alpha$. Here we</span>
<span id="cb42-388"><a href="#cb42-388" aria-hidden="true" tabindex="-1"></a>choose to define the meaning of the intercept by considering the</span>
<span id="cb42-389"><a href="#cb42-389" aria-hidden="true" tabindex="-1"></a>reference *time point* $\tilde{t}$ such that for $d=\tilde{d}$ and</span>
<span id="cb42-390"><a href="#cb42-390" aria-hidden="true" tabindex="-1"></a>$t=\tilde{t}$ we have that</span>
<span id="cb42-391"><a href="#cb42-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-392"><a href="#cb42-392" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-393"><a href="#cb42-393" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}\Pr(T \leq \tilde{t}|\tilde{d}) = \alpha + \log(\tilde{t}).</span>
<span id="cb42-394"><a href="#cb42-394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-395"><a href="#cb42-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-396"><a href="#cb42-396" aria-hidden="true" tabindex="-1"></a>Hence, when setting the mean of $\alpha$ to</span>
<span id="cb42-397"><a href="#cb42-397" aria-hidden="true" tabindex="-1"></a>$\mathrm{cloglog}^{-1}(\tilde{\pi}) - \log(\tilde{t})$ it becomes</span>
<span id="cb42-398"><a href="#cb42-398" aria-hidden="true" tabindex="-1"></a>apparent that the intercept is equal to the rate of events</span>
<span id="cb42-399"><a href="#cb42-399" aria-hidden="true" tabindex="-1"></a>$\tilde{\pi}$ over the reference time period up to the reference time</span>
<span id="cb42-400"><a href="#cb42-400" aria-hidden="true" tabindex="-1"></a>point $\tilde{t}$ whenever dose $\tilde{d}$ is given. </span>
<span id="cb42-401"><a href="#cb42-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-402"><a href="#cb42-402" aria-hidden="true" tabindex="-1"></a>If we are interested in modeling treatment cycles, we might let the</span>
<span id="cb42-403"><a href="#cb42-403" aria-hidden="true" tabindex="-1"></a>time unit elapse in full cycles and set the reference time point to the end</span>
<span id="cb42-404"><a href="#cb42-404" aria-hidden="true" tabindex="-1"></a>of cycle 1 ($\tilde{t} = 1$). Then, the interpretation of the prior is</span>
<span id="cb42-405"><a href="#cb42-405" aria-hidden="true" tabindex="-1"></a>the same as for the classic BLRM for which the DLT probability over</span>
<span id="cb42-406"><a href="#cb42-406" aria-hidden="true" tabindex="-1"></a>one cycle is modeled as a binomial logistic regression</span>
<span id="cb42-407"><a href="#cb42-407" aria-hidden="true" tabindex="-1"></a>($\mathrm{logit}(\pi(d)) = \alpha + \beta \, \log(d/\tilde{d})$). The</span>
<span id="cb42-408"><a href="#cb42-408" aria-hidden="true" tabindex="-1"></a>only difference is that the link function is now $\mathrm{cloglog}$</span>
<span id="cb42-409"><a href="#cb42-409" aria-hidden="true" tabindex="-1"></a>instead of $\mathrm{logit}$.</span>
<span id="cb42-410"><a href="#cb42-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-411"><a href="#cb42-411" aria-hidden="true" tabindex="-1"></a>Given the similarity of the Poisson TTE model to the one cycle</span>
<span id="cb42-412"><a href="#cb42-412" aria-hidden="true" tabindex="-1"></a>focused BLRM we will use the same rational for the slope parameter</span>
<span id="cb42-413"><a href="#cb42-413" aria-hidden="true" tabindex="-1"></a>$\beta$. The slope parameter $\beta$ can be interpreted as the Hill</span>
<span id="cb42-414"><a href="#cb42-414" aria-hidden="true" tabindex="-1"></a>coefficient of a sigmoid logistic curve. We can hence use mechanistic</span>
<span id="cb42-415"><a href="#cb42-415" aria-hidden="true" tabindex="-1"></a>knowledge and prior *in vivo* and *in vitro* data to motivate its</span>
<span id="cb42-416"><a href="#cb42-416" aria-hidden="true" tabindex="-1"></a>feasible range of values, and condense this prior knowledge into an</span>
<span id="cb42-417"><a href="#cb42-417" aria-hidden="true" tabindex="-1"></a>appropriate prior for the slope. In an efficacy meta-analysis,</span>
<span id="cb42-418"><a href="#cb42-418" aria-hidden="true" tabindex="-1"></a>"modeling showed the Hill parameters were concentrated near 1.0", see</span>
<span id="cb42-419"><a href="#cb42-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-420"><a href="#cb42-420" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Thomas *et al.* (2014) <span class="co">[</span><span class="ot">doi:10.1080/19466315.2014.924876</span><span class="co">](https://doi.org/10.1080/19466315.2014.924876)</span>, </span>
<span id="cb42-421"><a href="#cb42-421" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian Methods in Pharmaceutical Research (2020) <span class="co">[</span><span class="ot">doi:10.1201/9781315180212</span><span class="co">](https://doi.org/10.1201/9781315180212)</span> and</span>
<span id="cb42-422"><a href="#cb42-422" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Thomas *et al.* (2017) <span class="co">[</span><span class="ot">doi:10.1080/19466315.2016.1256229</span><span class="co">](https://doi.org/10.1080/19466315.2016.1256229)</span> for details.</span>
<span id="cb42-423"><a href="#cb42-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-424"><a href="#cb42-424" aria-hidden="true" tabindex="-1"></a>Therefore, in the absence of more specific knowledge </span>
<span id="cb42-425"><a href="#cb42-425" aria-hidden="true" tabindex="-1"></a>(e.g. pre-clinical data, historical clinical data for the mechanism of action,</span>
<span id="cb42-426"><a href="#cb42-426" aria-hidden="true" tabindex="-1"></a>etc.) we assume a prior for $\log\left(\beta\right)$ with mean 0.</span>
<span id="cb42-427"><a href="#cb42-427" aria-hidden="true" tabindex="-1"></a>Furthermore, we wish to avoid extremely steep or </span>
<span id="cb42-428"><a href="#cb42-428" aria-hidden="true" tabindex="-1"></a>flat dose-response curves. Thereby, we parameterize the 95% central</span>
<span id="cb42-429"><a href="#cb42-429" aria-hidden="true" tabindex="-1"></a>credible interval to allow for a 4 fold increase or decrease via setting</span>
<span id="cb42-430"><a href="#cb42-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-431"><a href="#cb42-431" aria-hidden="true" tabindex="-1"></a>$$ \log\left(\beta\right) \sim \N\left(0,</span>
<span id="cb42-432"><a href="#cb42-432" aria-hidden="true" tabindex="-1"></a>\left(\frac{\log(4)}{1.96}\right)^2\right).$$</span>
<span id="cb42-433"><a href="#cb42-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-434"><a href="#cb42-434" aria-hidden="true" tabindex="-1"></a>As discussed above, the intercept $\alpha$ defines the reference event</span>
<span id="cb42-435"><a href="#cb42-435" aria-hidden="true" tabindex="-1"></a>rate $\tilde{\pi}$ at the reference dose $\tilde{t}$ over the time</span>
<span id="cb42-436"><a href="#cb42-436" aria-hidden="true" tabindex="-1"></a>span up to the reference time $\tilde{t}$. By setting $\tilde{\pi}$ to</span>
<span id="cb42-437"><a href="#cb42-437" aria-hidden="true" tabindex="-1"></a>20\% we imply that the reference dose $\tilde{d}$ corresponds to our</span>
<span id="cb42-438"><a href="#cb42-438" aria-hidden="true" tabindex="-1"></a>prior guess of the MTD. These considerations define the prior mean for</span>
<span id="cb42-439"><a href="#cb42-439" aria-hidden="true" tabindex="-1"></a>$\alpha$. The standard deviation for the intercept is set to</span>
<span id="cb42-440"><a href="#cb42-440" aria-hidden="true" tabindex="-1"></a>unity. This choice results from an extensive study of the model</span>
<span id="cb42-441"><a href="#cb42-441" aria-hidden="true" tabindex="-1"></a>properties under various data scenarios. These data scenarios studied</span>
<span id="cb42-442"><a href="#cb42-442" aria-hidden="true" tabindex="-1"></a>how the model guides a dose-escalation trial at an early stage. At an</span>
<span id="cb42-443"><a href="#cb42-443" aria-hidden="true" tabindex="-1"></a>early stage of the trial one requires sufficient conservative dose</span>
<span id="cb42-444"><a href="#cb42-444" aria-hidden="true" tabindex="-1"></a>recommendations from the safety model while at the same time one</span>
<span id="cb42-445"><a href="#cb42-445" aria-hidden="true" tabindex="-1"></a>wishes to ensure that the model allows the trial to continue enrolling</span>
<span id="cb42-446"><a href="#cb42-446" aria-hidden="true" tabindex="-1"></a>patients to low doses should a limited number of DLT events be</span>
<span id="cb42-447"><a href="#cb42-447" aria-hidden="true" tabindex="-1"></a>observed during the early cohorts. The rationale behind the prior of</span>
<span id="cb42-448"><a href="#cb42-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-449"><a href="#cb42-449" aria-hidden="true" tabindex="-1"></a>$$ \alpha \sim \N\left(\mathrm{cloglog}(\tilde{\pi} = 20\%) - \log\left(\tilde{t}\right), 1^2\right) $$ </span>
<span id="cb42-450"><a href="#cb42-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-451"><a href="#cb42-451" aria-hidden="true" tabindex="-1"></a>is that we have some level of confidence in the set of doses which we</span>
<span id="cb42-452"><a href="#cb42-452" aria-hidden="true" tabindex="-1"></a>study in the trial to be reasonable. That is, the fact that we choose</span>
<span id="cb42-453"><a href="#cb42-453" aria-hidden="true" tabindex="-1"></a>to study a concrete dose range is by itself prior knowledge driven by</span>
<span id="cb42-454"><a href="#cb42-454" aria-hidden="true" tabindex="-1"></a>a multitude of (pre-clinical &amp; clinical) considerations. This prior</span>
<span id="cb42-455"><a href="#cb42-455" aria-hidden="true" tabindex="-1"></a>choice deliberately avoids that a limited number of DLT events at the</span>
<span id="cb42-456"><a href="#cb42-456" aria-hidden="true" tabindex="-1"></a>start of the trial can entirely undermine our initial understanding of</span>
<span id="cb42-457"><a href="#cb42-457" aria-hidden="true" tabindex="-1"></a>the drug safety profile. Only with sufficient data the model will stop</span>
<span id="cb42-458"><a href="#cb42-458" aria-hidden="true" tabindex="-1"></a>a trial.</span>
<span id="cb42-459"><a href="#cb42-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-460"><a href="#cb42-460" aria-hidden="true" tabindex="-1"></a>For a better intuition of the model prior, it is a helpful to study</span>
<span id="cb42-461"><a href="#cb42-461" aria-hidden="true" tabindex="-1"></a>data scenarios (left out here) and to visualize the joint model prior</span>
<span id="cb42-462"><a href="#cb42-462" aria-hidden="true" tabindex="-1"></a>rather than considering the prior on each parameter individually. This</span>
<span id="cb42-463"><a href="#cb42-463" aria-hidden="true" tabindex="-1"></a>is covered in section @sec-onco-tte-prior-vis.</span>
<span id="cb42-464"><a href="#cb42-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-465"><a href="#cb42-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Implementation</span></span>
<span id="cb42-466"><a href="#cb42-466" aria-hidden="true" tabindex="-1"></a>For the case of a single agent trial we can cast the problem into a</span>
<span id="cb42-467"><a href="#cb42-467" aria-hidden="true" tabindex="-1"></a>Poisson regression framework as detailed above and define the <span class="in">`brms`</span></span>
<span id="cb42-468"><a href="#cb42-468" aria-hidden="true" tabindex="-1"></a>model formula as follows. We use here a non-linear model formla</span>
<span id="cb42-469"><a href="#cb42-469" aria-hidden="true" tabindex="-1"></a>syntax to enforce a positive slope:</span>
<span id="cb42-470"><a href="#cb42-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-473"><a href="#cb42-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-474"><a href="#cb42-474" aria-hidden="true" tabindex="-1"></a>tte_model <span class="ot">&lt;-</span></span>
<span id="cb42-475"><a href="#cb42-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bf</span>(num_toxicities <span class="sc">|</span> <span class="fu">rate</span>(follow_up) <span class="sc">~</span> interA <span class="sc">+</span> <span class="fu">exp</span>(slopeA) <span class="sc">*</span> std_A,</span>
<span id="cb42-476"><a href="#cb42-476" aria-hidden="true" tabindex="-1"></a>       interA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb42-477"><a href="#cb42-477" aria-hidden="true" tabindex="-1"></a>       slopeA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb42-478"><a href="#cb42-478" aria-hidden="true" tabindex="-1"></a>       <span class="at">nl=</span><span class="cn">TRUE</span>, <span class="at">family=</span><span class="fu">poisson</span>()</span>
<span id="cb42-479"><a href="#cb42-479" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-480"><a href="#cb42-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-481"><a href="#cb42-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-482"><a href="#cb42-482" aria-hidden="true" tabindex="-1"></a><span class="in">`brms`</span> helps us to get the list of model parameters requiring prior</span>
<span id="cb42-483"><a href="#cb42-483" aria-hidden="true" tabindex="-1"></a>specifications:</span>
<span id="cb42-484"><a href="#cb42-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-487"><a href="#cb42-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-488"><a href="#cb42-488" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(tte_model, <span class="at">data =</span> ipd)</span>
<span id="cb42-489"><a href="#cb42-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-490"><a href="#cb42-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-491"><a href="#cb42-491" aria-hidden="true" tabindex="-1"></a>We can for instance define a prior with 20% DLT probability after the first </span>
<span id="cb42-492"><a href="#cb42-492" aria-hidden="true" tabindex="-1"></a>treatment cycle at the reference dose. For more details on the $\beta$ parameter</span>
<span id="cb42-493"><a href="#cb42-493" aria-hidden="true" tabindex="-1"></a>prior, see the bite-size guidance on <span class="co">[</span><span class="ot">go/BLRM</span><span class="co">](https://go/BLRM)</span>.</span>
<span id="cb42-494"><a href="#cb42-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-497"><a href="#cb42-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-498"><a href="#cb42-498" aria-hidden="true" tabindex="-1"></a><span class="do">## -4.83 approx cloglog(0.2) - log(7*4) for drug A</span></span>
<span id="cb42-499"><a href="#cb42-499" aria-hidden="true" tabindex="-1"></a>tte_prior <span class="ot">&lt;-</span></span>
<span id="cb42-500"><a href="#cb42-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb42-501"><a href="#cb42-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(<span class="dv">4</span>)<span class="sc">/</span><span class="fl">1.96</span>), <span class="at">nlpar=</span>slopeA)</span>
<span id="cb42-502"><a href="#cb42-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-503"><a href="#cb42-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-504"><a href="#cb42-504" aria-hidden="true" tabindex="-1"></a>We then create the Stan model code</span>
<span id="cb42-505"><a href="#cb42-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-508"><a href="#cb42-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-509"><a href="#cb42-509" aria-hidden="true" tabindex="-1"></a>tte_stanmodel <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">make_stancode</span>(</span>
<span id="cb42-510"><a href="#cb42-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior</span>
<span id="cb42-511"><a href="#cb42-511" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-512"><a href="#cb42-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-513"><a href="#cb42-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-514"><a href="#cb42-514" aria-hidden="true" tabindex="-1"></a>and data:</span>
<span id="cb42-515"><a href="#cb42-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-518"><a href="#cb42-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-519"><a href="#cb42-519" aria-hidden="true" tabindex="-1"></a>tte_standata <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">make_standata</span>(</span>
<span id="cb42-520"><a href="#cb42-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior</span>
<span id="cb42-521"><a href="#cb42-521" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-522"><a href="#cb42-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-523"><a href="#cb42-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-524"><a href="#cb42-524" aria-hidden="true" tabindex="-1"></a>After inspecting the generated code and data for correctness, we compile the </span>
<span id="cb42-525"><a href="#cb42-525" aria-hidden="true" tabindex="-1"></a>model without sampling it (<span class="in">`chains = 0`</span>) yet:</span>
<span id="cb42-526"><a href="#cb42-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-527"><a href="#cb42-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb42-528"><a href="#cb42-528" aria-hidden="true" tabindex="-1"></a>tte_brms_model <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb42-529"><a href="#cb42-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior, <span class="at">chains =</span> <span class="dv">0</span>, <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb42-530"><a href="#cb42-530" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-531"><a href="#cb42-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-532"><a href="#cb42-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-533"><a href="#cb42-533" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computing conditional and cumulative DLT probabilities for a given dosing schedule</span></span>
<span id="cb42-534"><a href="#cb42-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-535"><a href="#cb42-535" aria-hidden="true" tabindex="-1"></a>We define a function to compute the conditional and cumulative DLT</span>
<span id="cb42-536"><a href="#cb42-536" aria-hidden="true" tabindex="-1"></a>probabilities over a given schedule, respectively. This function needs</span>
<span id="cb42-537"><a href="#cb42-537" aria-hidden="true" tabindex="-1"></a>to take the hazards for each piecewise-constant interval and compute</span>
<span id="cb42-538"><a href="#cb42-538" aria-hidden="true" tabindex="-1"></a>the respective DLT probability. We write the function in the same</span>
<span id="cb42-539"><a href="#cb42-539" aria-hidden="true" tabindex="-1"></a>logic as the <span class="in">`add_*_rvars`</span> functions from <span class="in">`tidybayes`</span> such that we can</span>
<span id="cb42-540"><a href="#cb42-540" aria-hidden="true" tabindex="-1"></a>easily complement analysis data sets with the probabilities of</span>
<span id="cb42-541"><a href="#cb42-541" aria-hidden="true" tabindex="-1"></a>interest:</span>
<span id="cb42-542"><a href="#cb42-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-545"><a href="#cb42-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-546"><a href="#cb42-546" aria-hidden="true" tabindex="-1"></a>add_risk_rvars <span class="ot">&lt;-</span> <span class="cf">function</span>(newdata, model, time, .by) {</span>
<span id="cb42-547"><a href="#cb42-547" aria-hidden="true" tabindex="-1"></a>    <span class="do">## P(T =&lt; t) = 1 - P(T &gt; t) = inv_cloglog(log(H(t)))</span></span>
<span id="cb42-548"><a href="#cb42-548" aria-hidden="true" tabindex="-1"></a>    <span class="do">## &lt;=&gt; P(T =&lt; t) = 1 - P(T &gt; t) = inv_clog(H(t))</span></span>
<span id="cb42-549"><a href="#cb42-549" aria-hidden="true" tabindex="-1"></a>    <span class="do">## inv_cloglog(cll) = 1 - exp(-exp(cll))</span></span>
<span id="cb42-550"><a href="#cb42-550" aria-hidden="true" tabindex="-1"></a>    <span class="do">## =&gt; inv_clog = 1 - exp(-cl)</span></span>
<span id="cb42-551"><a href="#cb42-551" aria-hidden="true" tabindex="-1"></a>    inv_clog <span class="ot">&lt;-</span> <span class="cf">function</span>(cl) { <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>cl) }</span>
<span id="cb42-552"><a href="#cb42-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-553"><a href="#cb42-553" aria-hidden="true" tabindex="-1"></a>    <span class="do">## data must be sorted by time to ensure that the cumulative sum</span></span>
<span id="cb42-554"><a href="#cb42-554" aria-hidden="true" tabindex="-1"></a>    <span class="do">## works correctly below</span></span>
<span id="cb42-555"><a href="#cb42-555" aria-hidden="true" tabindex="-1"></a>    time_order <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">pull</span>(newdata, {{.by}}), <span class="fu">pull</span>(newdata, {{time}}))</span>
<span id="cb42-556"><a href="#cb42-556" aria-hidden="true" tabindex="-1"></a>    orig_order <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(newdata))[time_order]</span>
<span id="cb42-557"><a href="#cb42-557" aria-hidden="true" tabindex="-1"></a>    riskdata <span class="ot">&lt;-</span> newdata[time_order,]</span>
<span id="cb42-558"><a href="#cb42-558" aria-hidden="true" tabindex="-1"></a>    H <span class="ot">&lt;-</span> <span class="fu">rvar</span>(<span class="fu">posterior_epred</span>(model,</span>
<span id="cb42-559"><a href="#cb42-559" aria-hidden="true" tabindex="-1"></a>                              <span class="at">newdata=</span>riskdata,</span>
<span id="cb42-560"><a href="#cb42-560" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-561"><a href="#cb42-561" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sample_new_levels=</span><span class="st">"gaussian"</span>))</span>
<span id="cb42-562"><a href="#cb42-562" aria-hidden="true" tabindex="-1"></a>    riskdata <span class="ot">&lt;-</span> <span class="fu">mutate</span>(riskdata,</span>
<span id="cb42-563"><a href="#cb42-563" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob=</span><span class="fu">inv_clog</span>(<span class="fu">cumsum</span>(H[<span class="fu">cur_group_rows</span>()])),</span>
<span id="cb42-564"><a href="#cb42-564" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cprob=</span><span class="fu">inv_clog</span>(H[<span class="fu">cur_group_rows</span>()]),</span>
<span id="cb42-565"><a href="#cb42-565" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.by=</span>{{.by}})</span>
<span id="cb42-566"><a href="#cb42-566" aria-hidden="true" tabindex="-1"></a>    riskdata[orig_order,]</span>
<span id="cb42-567"><a href="#cb42-567" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-568"><a href="#cb42-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-569"><a href="#cb42-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-570"><a href="#cb42-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-571"><a href="#cb42-571" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dose escalation decisions</span></span>
<span id="cb42-572"><a href="#cb42-572" aria-hidden="true" tabindex="-1"></a>As in the basic dose-escalation chapter, we will apply Escalation With</span>
<span id="cb42-573"><a href="#cb42-573" aria-hidden="true" tabindex="-1"></a>Overdose Control (EWOC). I.e., we define a threshold above which doses</span>
<span id="cb42-574"><a href="#cb42-574" aria-hidden="true" tabindex="-1"></a>are "excessively toxic" $\pi_{over}$ (typically $\pi_{over} = 33\%$),</span>
<span id="cb42-575"><a href="#cb42-575" aria-hidden="true" tabindex="-1"></a>and a so-called feasibility bound $c$ (typically $c = 25\%$):</span>
<span id="cb42-576"><a href="#cb42-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-577"><a href="#cb42-577" aria-hidden="true" tabindex="-1"></a>$$ \text{EWOC satisfied at }d \iff \Pr( \pi(d) &gt; \pi_{over}) \leq c $$</span>
<span id="cb42-578"><a href="#cb42-578" aria-hidden="true" tabindex="-1"></a>Furthermore, we often define another cutoff $\pi_{targ}$, and summarize the posterior probabilities for three intervals,</span>
<span id="cb42-579"><a href="#cb42-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-580"><a href="#cb42-580" aria-hidden="true" tabindex="-1"></a>\begin{align*} \Pr(d\text{ is an underdose}) &amp;= \Pr( \pi(d) &lt; \pi_{targ} ) <span class="sc">\\</span></span>
<span id="cb42-581"><a href="#cb42-581" aria-hidden="true" tabindex="-1"></a>\Pr(d\text{ is in the target range}) &amp;= \Pr( \pi_{targ} \leq \pi(d) &lt; \pi_{over} ) <span class="sc">\\</span></span>
<span id="cb42-582"><a href="#cb42-582" aria-hidden="true" tabindex="-1"></a>\Pr(d\text{ is an overdose}) &amp;= \Pr( \pi(d) &gt; \pi_{over} ),</span>
<span id="cb42-583"><a href="#cb42-583" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-584"><a href="#cb42-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-585"><a href="#cb42-585" aria-hidden="true" tabindex="-1"></a>and evaluate EWOC by checking if the last quantity exceeds $c$.</span>
<span id="cb42-586"><a href="#cb42-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-587"><a href="#cb42-587" aria-hidden="true" tabindex="-1"></a>For the set of MCMC draws, we can compute median, mean, sd, 25% and 75% </span>
<span id="cb42-588"><a href="#cb42-588" aria-hidden="true" tabindex="-1"></a>quantiles, the interval probability as well as the EWOC criteria using the </span>
<span id="cb42-589"><a href="#cb42-589" aria-hidden="true" tabindex="-1"></a><span class="in">`summarize_draws`</span> function from the <span class="in">`posterior`</span> package. </span>
<span id="cb42-590"><a href="#cb42-590" aria-hidden="true" tabindex="-1"></a>Especially for the EWOC metric, we also would like to know if there </span>
<span id="cb42-591"><a href="#cb42-591" aria-hidden="true" tabindex="-1"></a>are any pre-specified doses where the Monte Carlo Error could flip the decision</span>
<span id="cb42-592"><a href="#cb42-592" aria-hidden="true" tabindex="-1"></a>whether a dose is considered safe enough (or not). </span>
<span id="cb42-593"><a href="#cb42-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-594"><a href="#cb42-594" aria-hidden="true" tabindex="-1"></a>We test for this using a Z-test (one-sample location test) for the 75%</span>
<span id="cb42-595"><a href="#cb42-595" aria-hidden="true" tabindex="-1"></a>quantile and its distance from the critical threshold $\pi_{over}$</span>
<span id="cb42-596"><a href="#cb42-596" aria-hidden="true" tabindex="-1"></a>using the Monte-Carlo Standard Error (MCSE) for the 75% quantile</span>
<span id="cb42-597"><a href="#cb42-597" aria-hidden="true" tabindex="-1"></a>(<span class="in">`mcse_q75`</span>). We define the EWOC metric to be sufficiently accurate if</span>
<span id="cb42-598"><a href="#cb42-598" aria-hidden="true" tabindex="-1"></a>the probability of flipping the decision due insufficient accuracy</span>
<span id="cb42-599"><a href="#cb42-599" aria-hidden="true" tabindex="-1"></a>(and hence large MCSE) is smaller than 2.5% certainty on whatever side</span>
<span id="cb42-600"><a href="#cb42-600" aria-hidden="true" tabindex="-1"></a>of the decision threshold. In turn we are at least 97.5% certain that</span>
<span id="cb42-601"><a href="#cb42-601" aria-hidden="true" tabindex="-1"></a>the decision is robust wrt to fluctuations implied by MCMC sampling</span>
<span id="cb42-602"><a href="#cb42-602" aria-hidden="true" tabindex="-1"></a>variability. Here we assume that the statistic is normally</span>
<span id="cb42-603"><a href="#cb42-603" aria-hidden="true" tabindex="-1"></a>distributed:</span>
<span id="cb42-604"><a href="#cb42-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-607"><a href="#cb42-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-608"><a href="#cb42-608" aria-hidden="true" tabindex="-1"></a>summarize_probs <span class="ot">&lt;-</span> <span class="cf">function</span>(draws) {</span>
<span id="cb42-609"><a href="#cb42-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_draws</span>(</span>
<span id="cb42-610"><a href="#cb42-610" aria-hidden="true" tabindex="-1"></a>    draws,</span>
<span id="cb42-611"><a href="#cb42-611" aria-hidden="true" tabindex="-1"></a>    median, mean, sd, </span>
<span id="cb42-612"><a href="#cb42-612" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), </span>
<span id="cb42-613"><a href="#cb42-613" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">cut</span>(.x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="dv">1</span>)))),</span>
<span id="cb42-614"><a href="#cb42-614" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">mcse_quantile</span>(.x, <span class="at">probs =</span> <span class="fl">0.75</span>), </span>
<span id="cb42-615"><a href="#cb42-615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">default_convergence_measures</span>()</span>
<span id="cb42-616"><a href="#cb42-616" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb42-617"><a href="#cb42-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">ewoc_ok =</span> q75 <span class="sc">&lt;</span> <span class="fl">0.33</span>,</span>
<span id="cb42-618"><a href="#cb42-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> (q75 <span class="sc">-</span> .<span class="dv">33</span>) <span class="sc">/</span> mcse_q75,</span>
<span id="cb42-619"><a href="#cb42-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">ewoc_accurate =</span>  <span class="fu">abs</span>(stat) <span class="sc">&gt;=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb42-620"><a href="#cb42-620" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>variable)</span>
<span id="cb42-621"><a href="#cb42-621" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-622"><a href="#cb42-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-623"><a href="#cb42-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-624"><a href="#cb42-624" aria-hidden="true" tabindex="-1"></a>To inspect the prior, we first sample the model ignoring the data:</span>
<span id="cb42-625"><a href="#cb42-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-626"><a href="#cb42-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb42-627"><a href="#cb42-627" aria-hidden="true" tabindex="-1"></a>tte_model_prioronly <span class="ot">&lt;-</span> <span class="fu">update</span>(tte_brms_model, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">sample_prior =</span> <span class="st">"only"</span>) </span>
<span id="cb42-628"><a href="#cb42-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-629"><a href="#cb42-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-630"><a href="#cb42-630" aria-hidden="true" tabindex="-1"></a>Now we can compute the conditional and cumulative DLT probabilities</span>
<span id="cb42-631"><a href="#cb42-631" aria-hidden="true" tabindex="-1"></a>implied by the prior,</span>
<span id="cb42-632"><a href="#cb42-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-635"><a href="#cb42-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-636"><a href="#cb42-636" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="ot">&lt;-</span> dose_ref_data <span class="sc">|&gt;</span></span>
<span id="cb42-637"><a href="#cb42-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risk_rvars</span>(tte_model_prioronly, cycle, schedule_id)</span>
<span id="cb42-638"><a href="#cb42-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-639"><a href="#cb42-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-640"><a href="#cb42-640" aria-hidden="true" tabindex="-1"></a>and display them as a table, i.e., the conditional DLT probabilities</span>
<span id="cb42-641"><a href="#cb42-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-644"><a href="#cb42-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-645"><a href="#cb42-645" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="sc">|&gt;</span></span>
<span id="cb42-646"><a href="#cb42-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb42-647"><a href="#cb42-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb42-648"><a href="#cb42-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span>
<span id="cb42-649"><a href="#cb42-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-650"><a href="#cb42-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-651"><a href="#cb42-651" aria-hidden="true" tabindex="-1"></a>as well the cumulative probabilities</span>
<span id="cb42-652"><a href="#cb42-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a>prior_risk <span class="sc">|&gt;</span></span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span>
<span id="cb42-660"><a href="#cb42-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-661"><a href="#cb42-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-662"><a href="#cb42-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-663"><a href="#cb42-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing the model prior {#sec-onco-tte-prior-vis}</span></span>
<span id="cb42-664"><a href="#cb42-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-665"><a href="#cb42-665" aria-hidden="true" tabindex="-1"></a>We can also visualize the prior in terms of the sampled curves, and see whether</span>
<span id="cb42-666"><a href="#cb42-666" aria-hidden="true" tabindex="-1"></a>this distribution makes sense to us. We can, e.g., see, that the prior we defined</span>
<span id="cb42-667"><a href="#cb42-667" aria-hidden="true" tabindex="-1"></a>above is quite sensible in terms of the dose-response curves it implies:</span>
<span id="cb42-668"><a href="#cb42-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-669"><a href="#cb42-669" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditional DLT probability in cycle 1</span></span>
<span id="cb42-672"><a href="#cb42-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-673"><a href="#cb42-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-674"><a href="#cb42-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb42-675"><a href="#cb42-675" aria-hidden="true" tabindex="-1"></a>add_plot_cols <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb42-676"><a href="#cb42-676" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb42-677"><a href="#cb42-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">EWOC =</span> <span class="fu">factor</span>(ewoc_ok, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">c</span>(<span class="st">"OK"</span>, <span class="st">"Not OK"</span>)), </span>
<span id="cb42-678"><a href="#cb42-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">dose_A =</span> <span class="fu">factor</span>(dose_A),</span>
<span id="cb42-679"><a href="#cb42-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cycle =</span> cycle</span>
<span id="cb42-680"><a href="#cb42-680" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-681"><a href="#cb42-681" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-682"><a href="#cb42-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-683"><a href="#cb42-683" aria-hidden="true" tabindex="-1"></a>doses_dense <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>dref_A, <span class="at">length.out =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb42-684"><a href="#cb42-684" aria-hidden="true" tabindex="-1"></a>dose_info_dense <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb42-685"><a href="#cb42-685" aria-hidden="true" tabindex="-1"></a>  <span class="at">schedule_id =</span> <span class="fu">seq_along</span>(doses_dense), </span>
<span id="cb42-686"><a href="#cb42-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">cycle =</span> cycle_seq</span>
<span id="cb42-687"><a href="#cb42-687" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-688"><a href="#cb42-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_A =</span> doses_dense[schedule_id])</span>
<span id="cb42-689"><a href="#cb42-689" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-690"><a href="#cb42-690" aria-hidden="true" tabindex="-1"></a>dose_ref_data_dense <span class="ot">&lt;-</span> dose_info_dense <span class="sc">|&gt;</span></span>
<span id="cb42-691"><a href="#cb42-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cycle_info, <span class="at">by=</span><span class="st">"cycle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-692"><a href="#cb42-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_toxicities=</span><span class="dv">0</span>L) <span class="sc">|&gt;</span></span>
<span id="cb42-693"><a href="#cb42-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"A"</span>, <span class="at">dref =</span> dref_A)    </span>
<span id="cb42-694"><a href="#cb42-694" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-695"><a href="#cb42-695" aria-hidden="true" tabindex="-1"></a>plot_cycle1_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules, doses) {</span>
<span id="cb42-696"><a href="#cb42-696" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> schedules <span class="sc">|&gt;</span> </span>
<span id="cb42-697"><a href="#cb42-697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb42-698"><a href="#cb42-698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb42-699"><a href="#cb42-699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cycle <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb42-700"><a href="#cb42-700" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-701"><a href="#cb42-701" aria-hidden="true" tabindex="-1"></a>  plot_data_long <span class="ot">&lt;-</span> plot_data <span class="sc">|&gt;</span></span>
<span id="cb42-702"><a href="#cb42-702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dose_A, cprob) <span class="sc">|&gt;</span></span>
<span id="cb42-703"><a href="#cb42-703" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_rvars</span>()</span>
<span id="cb42-704"><a href="#cb42-704" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-705"><a href="#cb42-705" aria-hidden="true" tabindex="-1"></a>  plot_data_long <span class="sc">|&gt;</span></span>
<span id="cb42-706"><a href="#cb42-706" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">y =</span> cprob, <span class="at">group =</span> .draw)) <span class="sc">+</span></span>
<span id="cb42-707"><a href="#cb42-707" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>( <span class="at">alpha=</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb42-708"><a href="#cb42-708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> doses) <span class="sc">+</span></span>
<span id="cb42-709"><a href="#cb42-709" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb42-710"><a href="#cb42-710" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-711"><a href="#cb42-711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb42-712"><a href="#cb42-712" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Risk of a DLT in cycle 1"</span></span>
<span id="cb42-713"><a href="#cb42-713" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb42-714"><a href="#cb42-714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb42-715"><a href="#cb42-715" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT in cycle | survival to cycle start)"</span>) <span class="sc">+</span></span>
<span id="cb42-716"><a href="#cb42-716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb42-717"><a href="#cb42-717" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-718"><a href="#cb42-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-719"><a href="#cb42-719" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cycle1_dist</span>(tte_model_prioronly, dose_ref_data_dense, <span class="fu">c</span>(doses, <span class="dv">2</span><span class="sc">*</span>dref_A))</span>
<span id="cb42-720"><a href="#cb42-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-721"><a href="#cb42-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-722"><a href="#cb42-722" aria-hidden="true" tabindex="-1"></a>If one chooses a very wide prior on a parameter without considering the response</span>
<span id="cb42-723"><a href="#cb42-723" aria-hidden="true" tabindex="-1"></a>scale, this can, result in priors that are not biologically</span>
<span id="cb42-724"><a href="#cb42-724" aria-hidden="true" tabindex="-1"></a>justifiable. For instance, if we chose a much higher standard deviation for</span>
<span id="cb42-725"><a href="#cb42-725" aria-hidden="true" tabindex="-1"></a>the prior of the slope $\beta$, this leads to a prior is bimodal in the sense </span>
<span id="cb42-726"><a href="#cb42-726" aria-hidden="true" tabindex="-1"></a>that it implies either flat dose-response curves or step functions at the </span>
<span id="cb42-727"><a href="#cb42-727" aria-hidden="true" tabindex="-1"></a>reference dose (which is easier to overlook when only plotting the point </span>
<span id="cb42-728"><a href="#cb42-728" aria-hidden="true" tabindex="-1"></a>intervals):</span>
<span id="cb42-729"><a href="#cb42-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-730"><a href="#cb42-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb42-731"><a href="#cb42-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-732"><a href="#cb42-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb42-733"><a href="#cb42-733" aria-hidden="true" tabindex="-1"></a>tte_prior_wide <span class="ot">&lt;-</span></span>
<span id="cb42-734"><a href="#cb42-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb42-735"><a href="#cb42-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">nlpar=</span>slopeA)</span>
<span id="cb42-736"><a href="#cb42-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-737"><a href="#cb42-737" aria-hidden="true" tabindex="-1"></a>tte_brms_model_wide_prioronly <span class="ot">&lt;-</span> tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb42-738"><a href="#cb42-738" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ipd, <span class="at">prior =</span> tte_prior_wide, <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">sample_prior =</span> <span class="st">"only"</span></span>
<span id="cb42-739"><a href="#cb42-739" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-740"><a href="#cb42-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-741"><a href="#cb42-741" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cycle1_dist</span>(tte_brms_model_wide_prioronly, dose_ref_data_dense, <span class="fu">c</span>(doses, <span class="dv">2</span><span class="sc">*</span>dref_A))</span>
<span id="cb42-742"><a href="#cb42-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-743"><a href="#cb42-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-744"><a href="#cb42-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-745"><a href="#cb42-745" aria-hidden="true" tabindex="-1"></a>Nevertheless, it is easier to visualize the distributiom of the estimated </span>
<span id="cb42-746"><a href="#cb42-746" aria-hidden="true" tabindex="-1"></a>dose-response curves for the pre-specified doses using the <span class="in">`stat_pointinterval`</span> </span>
<span id="cb42-747"><a href="#cb42-747" aria-hidden="true" tabindex="-1"></a>stat from the <span class="in">`ggdist`</span> package:</span>
<span id="cb42-748"><a href="#cb42-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-749"><a href="#cb42-749" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditional DLT probability in each of the 3 cycles</span></span>
<span id="cb42-752"><a href="#cb42-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-753"><a href="#cb42-753" aria-hidden="true" tabindex="-1"></a>plot_cprob <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules) {</span>
<span id="cb42-754"><a href="#cb42-754" aria-hidden="true" tabindex="-1"></a>  schedules <span class="sc">|&gt;</span> </span>
<span id="cb42-755"><a href="#cb42-755" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb42-756"><a href="#cb42-756" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb42-757"><a href="#cb42-757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_plot_cols</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-758"><a href="#cb42-758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">ydist =</span> cprob, <span class="at">colour =</span> EWOC)) <span class="sc">+</span></span>
<span id="cb42-759"><a href="#cb42-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cycle, <span class="at">labeller =</span> label_both) <span class="sc">+</span> </span>
<span id="cb42-760"><a href="#cb42-760" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-761"><a href="#cb42-761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb42-762"><a href="#cb42-762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb42-763"><a href="#cb42-763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-764"><a href="#cb42-764" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb42-765"><a href="#cb42-765" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Conditional risk for one DLT per cycle"</span>, </span>
<span id="cb42-766"><a href="#cb42-766" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Risk is conditional on survival at the same dose up to cycle start.</span><span class="sc">\n</span><span class="st">Shown is the median (dot) and central 50% CrI (line)."</span></span>
<span id="cb42-767"><a href="#cb42-767" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb42-768"><a href="#cb42-768" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb42-769"><a href="#cb42-769" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT in cycle | survival to cycle start)"</span>)</span>
<span id="cb42-770"><a href="#cb42-770" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-771"><a href="#cb42-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-772"><a href="#cb42-772" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cprob</span>(tte_model_prioronly, dose_ref_data)</span>
<span id="cb42-773"><a href="#cb42-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-774"><a href="#cb42-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-775"><a href="#cb42-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-776"><a href="#cb42-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-777"><a href="#cb42-777" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cumulative DLT probability over 3 cycles</span></span>
<span id="cb42-780"><a href="#cb42-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-781"><a href="#cb42-781" aria-hidden="true" tabindex="-1"></a>plot_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(model, schedules) {</span>
<span id="cb42-782"><a href="#cb42-782" aria-hidden="true" tabindex="-1"></a>  schedules <span class="sc">|&gt;</span></span>
<span id="cb42-783"><a href="#cb42-783" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(model, cycle, schedule_id) <span class="sc">|&gt;</span></span>
<span id="cb42-784"><a href="#cb42-784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb42-785"><a href="#cb42-785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_plot_cols</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-786"><a href="#cb42-786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(dose_A, <span class="at">ydist =</span> prob, <span class="at">colour =</span> EWOC)) <span class="sc">+</span></span>
<span id="cb42-787"><a href="#cb42-787" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-788"><a href="#cb42-788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cycle, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb42-789"><a href="#cb42-789" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb42-790"><a href="#cb42-790" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb42-791"><a href="#cb42-791" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_at</span>(<span class="fl">0.33</span>, <span class="at">linetype =</span> <span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-792"><a href="#cb42-792" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(</span>
<span id="cb42-793"><a href="#cb42-793" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Overall risk for DLT up to cycle"</span>, </span>
<span id="cb42-794"><a href="#cb42-794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Given same dose over all cycles.</span><span class="sc">\n</span><span class="st">Shown is the median (dot) and central 50% CrI (line)."</span></span>
<span id="cb42-795"><a href="#cb42-795" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb42-796"><a href="#cb42-796" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Dose [mg]"</span>) <span class="sc">+</span></span>
<span id="cb42-797"><a href="#cb42-797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"P(DLT up to cycle)"</span>)</span>
<span id="cb42-798"><a href="#cb42-798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-799"><a href="#cb42-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-800"><a href="#cb42-800" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_prob</span>(tte_model_prioronly, dose_ref_data) </span>
<span id="cb42-801"><a href="#cb42-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-802"><a href="#cb42-802" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examining the model posterior</span></span>
<span id="cb42-803"><a href="#cb42-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-804"><a href="#cb42-804" aria-hidden="true" tabindex="-1"></a>We now sample the model including the data:</span>
<span id="cb42-805"><a href="#cb42-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-808"><a href="#cb42-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-809"><a href="#cb42-809" aria-hidden="true" tabindex="-1"></a>tte_model_posterior <span class="ot">&lt;-</span> <span class="fu">update</span>(tte_brms_model, <span class="at">chains =</span> <span class="dv">4</span>)</span>
<span id="cb42-810"><a href="#cb42-810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-811"><a href="#cb42-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-812"><a href="#cb42-812" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference for model parameters</span></span>
<span id="cb42-813"><a href="#cb42-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-814"><a href="#cb42-814" aria-hidden="true" tabindex="-1"></a>It is simple to get summary statistics and graphical displays of the</span>
<span id="cb42-815"><a href="#cb42-815" aria-hidden="true" tabindex="-1"></a>posterior distributions for the model parameters:</span>
<span id="cb42-816"><a href="#cb42-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-819"><a href="#cb42-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-820"><a href="#cb42-820" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(tte_model_posterior)</span>
<span id="cb42-821"><a href="#cb42-821" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">mcmc_plot</span>(tte_model_posterior, <span class="at">type =</span> <span class="st">"dens"</span>, <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span>
<span id="cb42-822"><a href="#cb42-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-823"><a href="#cb42-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-824"><a href="#cb42-824" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference for conditional and cumulative DLT probabilities</span></span>
<span id="cb42-825"><a href="#cb42-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-826"><a href="#cb42-826" aria-hidden="true" tabindex="-1"></a>The conditional and cumulative DLT probabilities are now higher, as</span>
<span id="cb42-827"><a href="#cb42-827" aria-hidden="true" tabindex="-1"></a>expected from the data:</span>
<span id="cb42-828"><a href="#cb42-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-831"><a href="#cb42-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-832"><a href="#cb42-832" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cprob</span>(tte_model_posterior, dose_ref_data) </span>
<span id="cb42-833"><a href="#cb42-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-834"><a href="#cb42-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-837"><a href="#cb42-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-838"><a href="#cb42-838" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_prob</span>(tte_model_posterior, dose_ref_data) </span>
<span id="cb42-839"><a href="#cb42-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-840"><a href="#cb42-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-841"><a href="#cb42-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-842"><a href="#cb42-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-843"><a href="#cb42-843" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb42-844"><a href="#cb42-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-845"><a href="#cb42-845" aria-hidden="true" tabindex="-1"></a><span class="in">`brms`</span> can handle time-to-event modelling for DLTs in an early</span>
<span id="cb42-846"><a href="#cb42-846" aria-hidden="true" tabindex="-1"></a>Oncology dose escalation trial using Poisson regression with an offset</span>
<span id="cb42-847"><a href="#cb42-847" aria-hidden="true" tabindex="-1"></a>for the follow-up, and produce all the posterior summaries necessary</span>
<span id="cb42-848"><a href="#cb42-848" aria-hidden="true" tabindex="-1"></a>for guiding such trials. There are, of course, *many* possible</span>
<span id="cb42-849"><a href="#cb42-849" aria-hidden="true" tabindex="-1"></a>extensions and complications to this methodology, such as hazards</span>
<span id="cb42-850"><a href="#cb42-850" aria-hidden="true" tabindex="-1"></a>varying by treatment cycle (e.g., monotonically decreasing), or by</span>
<span id="cb42-851"><a href="#cb42-851" aria-hidden="true" tabindex="-1"></a>prior treatment (e.g., decreasing hazard in case of prior ramp-up</span>
<span id="cb42-852"><a href="#cb42-852" aria-hidden="true" tabindex="-1"></a>dosing), or drug combinations. The latter will be the topic of the</span>
<span id="cb42-853"><a href="#cb42-853" aria-hidden="true" tabindex="-1"></a>exercise for this chapter where we showcase how to define custom link</span>
<span id="cb42-854"><a href="#cb42-854" aria-hidden="true" tabindex="-1"></a>functions in <span class="in">`brms`</span> to handle the combination case.</span>
<span id="cb42-855"><a href="#cb42-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-856"><a href="#cb42-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb42-857"><a href="#cb42-857" aria-hidden="true" tabindex="-1"></a>Often, investigational cancer drugs are tested on top of a</span>
<span id="cb42-858"><a href="#cb42-858" aria-hidden="true" tabindex="-1"></a>standard-of-care (SoC) treatment. In this exercise, we will explore</span>
<span id="cb42-859"><a href="#cb42-859" aria-hidden="true" tabindex="-1"></a>how we can extend the single-agent time-to-event model to a</span>
<span id="cb42-860"><a href="#cb42-860" aria-hidden="true" tabindex="-1"></a>combination of investigational drug and SoC treatment.</span>
<span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a>In the following, we assume the SoC treatment also has a hazard rate</span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a>when present, and that there is no drug-drug interactions, i.e., the</span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a>hazards are *additive*.</span>
<span id="cb42-865"><a href="#cb42-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-866"><a href="#cb42-866" aria-hidden="true" tabindex="-1"></a>We model the log-hazard $\log\left(h_{B,j}(t|\tilde{d}_{B,j})\right)$ of </span>
<span id="cb42-867"><a href="#cb42-867" aria-hidden="true" tabindex="-1"></a>the SoC treatment (called "drug B" here) in a more simplified way, i.e., </span>
<span id="cb42-868"><a href="#cb42-868" aria-hidden="true" tabindex="-1"></a>either as present "at the reference dose" or absent: </span>
<span id="cb42-869"><a href="#cb42-869" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-870"><a href="#cb42-870" aria-hidden="true" tabindex="-1"></a>\log\left(h_{B,j}(t|\tilde{d}_{B,j})\right) = \begin{cases}</span>
<span id="cb42-871"><a href="#cb42-871" aria-hidden="true" tabindex="-1"></a>  \alpha_B &amp; \textrm{if } \tilde{d}_{B,j} = 1  <span class="sc">\\</span></span>
<span id="cb42-872"><a href="#cb42-872" aria-hidden="true" tabindex="-1"></a>  -\infty  &amp; \textrm{if } \tilde{d}_{B,j} = 0</span>
<span id="cb42-873"><a href="#cb42-873" aria-hidden="true" tabindex="-1"></a>\end{cases} </span>
<span id="cb42-874"><a href="#cb42-874" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-875"><a href="#cb42-875" aria-hidden="true" tabindex="-1"></a>First, we add a second component to the model:</span>
<span id="cb42-876"><a href="#cb42-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-879"><a href="#cb42-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-880"><a href="#cb42-880" aria-hidden="true" tabindex="-1"></a><span class="do">## Stan function to make combo2 non-linear link come to life. To avoid</span></span>
<span id="cb42-881"><a href="#cb42-881" aria-hidden="true" tabindex="-1"></a><span class="do">## issues with negative infinity (log(0)) whenever one of the drugs is</span></span>
<span id="cb42-882"><a href="#cb42-882" aria-hidden="true" tabindex="-1"></a><span class="do">## not present, we have to pass in this information.</span></span>
<span id="cb42-883"><a href="#cb42-883" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. if drug_A is present (finiteA: indicator 1 = present, 0 = absent)</span></span>
<span id="cb42-884"><a href="#cb42-884" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. if drug_B is present (finnitB: indicator 1 = present, 0 = absent)</span></span>
<span id="cb42-885"><a href="#cb42-885" aria-hidden="true" tabindex="-1"></a>combo2_tte_stan_code <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb42-886"><a href="#cb42-886" aria-hidden="true" tabindex="-1"></a><span class="st">// log(h) = log(exp(muA) + exp(muB))</span></span>
<span id="cb42-887"><a href="#cb42-887" aria-hidden="true" tabindex="-1"></a><span class="st">real combo2_tte_log_inv_link(real muA, real muB, int finiteA, int finiteB) {</span></span>
<span id="cb42-888"><a href="#cb42-888" aria-hidden="true" tabindex="-1"></a><span class="st">  real log_h;</span></span>
<span id="cb42-889"><a href="#cb42-889" aria-hidden="true" tabindex="-1"></a><span class="st">  if(finiteA == 1 &amp;&amp; finiteB == 1) {</span></span>
<span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = log_sum_exp(muA, muB);</span></span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA == 1 &amp;&amp; finiteB != 1) {</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = muA;</span></span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA != 1 &amp;&amp; finiteB == 1) {</span></span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = muB;</span></span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a><span class="st">  } else if(finiteA != 1 &amp;&amp; finiteB != 1) {</span></span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a><span class="st">    // Need to use negative_infinity() instead of -std::numeric_limits&lt;double&gt;::infinity()</span></span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a><span class="st">    // to avoid autodiff issues</span></span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a><span class="st">    log_h = negative_infinity();</span></span>
<span id="cb42-899"><a href="#cb42-899" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb42-900"><a href="#cb42-900" aria-hidden="true" tabindex="-1"></a><span class="st">  return log_h;</span></span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>combo2_tte_stanvar <span class="ot">&lt;-</span> <span class="fu">stanvar</span>(<span class="at">scode =</span> combo2_tte_stan_code, <span class="at">block =</span> <span class="st">"functions"</span>)</span>
<span id="cb42-905"><a href="#cb42-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-906"><a href="#cb42-906" aria-hidden="true" tabindex="-1"></a><span class="do">## Define respective R function which is used for simulation of the</span></span>
<span id="cb42-907"><a href="#cb42-907" aria-hidden="true" tabindex="-1"></a><span class="do">## posterior in R. Note that the inputs are given as draws of matrices</span></span>
<span id="cb42-908"><a href="#cb42-908" aria-hidden="true" tabindex="-1"></a><span class="do">## which have the format of draws representing rows and columns</span></span>
<span id="cb42-909"><a href="#cb42-909" aria-hidden="true" tabindex="-1"></a><span class="do">## corresponding to observation rows in the modeling data set for</span></span>
<span id="cb42-910"><a href="#cb42-910" aria-hidden="true" tabindex="-1"></a><span class="do">## which the posterior is simulated.</span></span>
<span id="cb42-911"><a href="#cb42-911" aria-hidden="true" tabindex="-1"></a>combo2_tte_log_inv_link <span class="ot">&lt;-</span> <span class="cf">function</span>(muA, muB, finiteA, finiteB) {</span>
<span id="cb42-912"><a href="#cb42-912" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">ncol</span>(muA) <span class="co"># number of observations</span></span>
<span id="cb42-913"><a href="#cb42-913" aria-hidden="true" tabindex="-1"></a>    D <span class="ot">&lt;-</span> <span class="fu">nrow</span>(muA) <span class="co"># number of draws</span></span>
<span id="cb42-914"><a href="#cb42-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-915"><a href="#cb42-915" aria-hidden="true" tabindex="-1"></a>    <span class="do">## flatten the matrices to vectors (column-major ordering)</span></span>
<span id="cb42-916"><a href="#cb42-916" aria-hidden="true" tabindex="-1"></a>    muA <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(muA)</span>
<span id="cb42-917"><a href="#cb42-917" aria-hidden="true" tabindex="-1"></a>    muB <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(muB)</span>
<span id="cb42-918"><a href="#cb42-918" aria-hidden="true" tabindex="-1"></a>    finiteA <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(finiteA)</span>
<span id="cb42-919"><a href="#cb42-919" aria-hidden="true" tabindex="-1"></a>    finiteB <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(finiteB)</span>
<span id="cb42-920"><a href="#cb42-920" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-921"><a href="#cb42-921" aria-hidden="true" tabindex="-1"></a>    log_muAB <span class="ot">&lt;-</span> matrixStats<span class="sc">::</span><span class="fu">rowLogSumExps</span>(<span class="fu">cbind</span>(muA, muB))</span>
<span id="cb42-922"><a href="#cb42-922" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-923"><a href="#cb42-923" aria-hidden="true" tabindex="-1"></a>    log_h <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb42-924"><a href="#cb42-924" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> log_muAB,</span>
<span id="cb42-925"><a href="#cb42-925" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">~</span> muA,</span>
<span id="cb42-926"><a href="#cb42-926" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> muB,</span>
<span id="cb42-927"><a href="#cb42-927" aria-hidden="true" tabindex="-1"></a>        finiteA <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finiteB <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">rep.int</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="at">times=</span>D<span class="sc">*</span>N)</span>
<span id="cb42-928"><a href="#cb42-928" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-929"><a href="#cb42-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-930"><a href="#cb42-930" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cast result into draws x observation matrix</span></span>
<span id="cb42-931"><a href="#cb42-931" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(log_h, D, N)</span>
<span id="cb42-932"><a href="#cb42-932" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-933"><a href="#cb42-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-934"><a href="#cb42-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-935"><a href="#cb42-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-936"><a href="#cb42-936" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`brms`</span> model corresponding to the combination model</span>
<span id="cb42-937"><a href="#cb42-937" aria-hidden="true" tabindex="-1"></a>described above is quite different from the single-drug case due to the need for</span>
<span id="cb42-938"><a href="#cb42-938" aria-hidden="true" tabindex="-1"></a>a custom non-linear link function:</span>
<span id="cb42-941"><a href="#cb42-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-942"><a href="#cb42-942" aria-hidden="true" tabindex="-1"></a>combo2_tte_model  <span class="ot">&lt;-</span></span>
<span id="cb42-943"><a href="#cb42-943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bf</span>(num_toxicities <span class="sc">|</span> <span class="fu">rate</span>(follow_up) <span class="sc">~</span> <span class="fu">combo2_tte_log_inv_link</span>(muA, muB, finite_A, finite_B),</span>
<span id="cb42-944"><a href="#cb42-944" aria-hidden="true" tabindex="-1"></a>       <span class="fu">nlf</span>(muA <span class="sc">~</span> interA <span class="sc">+</span> <span class="fu">exp</span>(slopeA) <span class="sc">*</span> std_A),</span>
<span id="cb42-945"><a href="#cb42-945" aria-hidden="true" tabindex="-1"></a>       slopeA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb42-946"><a href="#cb42-946" aria-hidden="true" tabindex="-1"></a>       interA <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb42-947"><a href="#cb42-947" aria-hidden="true" tabindex="-1"></a>       muB <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb42-948"><a href="#cb42-948" aria-hidden="true" tabindex="-1"></a>       <span class="at">nl=</span><span class="cn">TRUE</span>, <span class="at">loop=</span><span class="cn">TRUE</span>, <span class="at">family=</span>poisson</span>
<span id="cb42-949"><a href="#cb42-949" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-950"><a href="#cb42-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-951"><a href="#cb42-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-952"><a href="#cb42-952" aria-hidden="true" tabindex="-1"></a>In addition, we need the indicators finite_A and finite_B now, in order to </span>
<span id="cb42-953"><a href="#cb42-953" aria-hidden="true" tabindex="-1"></a>numerically deal with cases where one or both of the drugs has zero 0 dose.</span>
<span id="cb42-954"><a href="#cb42-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-955"><a href="#cb42-955" aria-hidden="true" tabindex="-1"></a>Now for the exercise:</span>
<span id="cb42-956"><a href="#cb42-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-957"><a href="#cb42-957" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Update the <span class="in">`ipd`</span> data to include the SoC as drug B (hint: use drug name "B" </span>
<span id="cb42-958"><a href="#cb42-958" aria-hidden="true" tabindex="-1"></a>   and a reference dose of 1 for SoC present).</span>
<span id="cb42-961"><a href="#cb42-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-962"><a href="#cb42-962" aria-hidden="true" tabindex="-1"></a>combo2_ipd <span class="ot">&lt;-</span> ipd <span class="sc">|&gt;</span> </span>
<span id="cb42-963"><a href="#cb42-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_B =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-964"><a href="#cb42-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"B"</span>, <span class="at">dref =</span> <span class="dv">1</span>)</span>
<span id="cb42-965"><a href="#cb42-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-966"><a href="#cb42-966" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Define a prior for the SoC treatment that corresponds to a DLT probability of 5% in</span>
<span id="cb42-967"><a href="#cb42-967" aria-hidden="true" tabindex="-1"></a>   the first cycle with a standard deviation of 1.</span>
<span id="cb42-970"><a href="#cb42-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-971"><a href="#cb42-971" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(combo2_tte_model, <span class="at">data =</span> combo2_ipd)</span>
<span id="cb42-972"><a href="#cb42-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-973"><a href="#cb42-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-976"><a href="#cb42-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-977"><a href="#cb42-977" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.3 approx cloglog(0.05) - log(7*4) for the SoC</span></span>
<span id="cb42-978"><a href="#cb42-978" aria-hidden="true" tabindex="-1"></a>combo2_tte_prior <span class="ot">&lt;-</span></span>
<span id="cb42-979"><a href="#cb42-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">4.83</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>interA, <span class="at">class=</span>b, <span class="at">coef=</span>Intercept) <span class="sc">+</span></span>
<span id="cb42-980"><a href="#cb42-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(<span class="dv">4</span>)<span class="sc">/</span><span class="fl">1.96</span>), <span class="at">nlpar=</span>slopeA) <span class="sc">+</span></span>
<span id="cb42-981"><a href="#cb42-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">6.3</span>, <span class="dv">1</span>), <span class="at">nlpar=</span>muB, <span class="at">coef=</span>Intercept)</span>
<span id="cb42-982"><a href="#cb42-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-983"><a href="#cb42-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-984"><a href="#cb42-984" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which dose of the investigational drug would still be sufficiently safe according </span>
<span id="cb42-985"><a href="#cb42-985" aria-hidden="true" tabindex="-1"></a>to the standard EWOC criterion when administered on top of the SoC treatment?</span>
<span id="cb42-988"><a href="#cb42-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-989"><a href="#cb42-989" aria-hidden="true" tabindex="-1"></a>combo2_tte_brms_model <span class="ot">&lt;-</span> combo2_tte_model <span class="sc">|&gt;</span> <span class="fu">brm</span>(</span>
<span id="cb42-990"><a href="#cb42-990" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> combo2_ipd, <span class="at">stanvars =</span> combo2_tte_stanvar, </span>
<span id="cb42-991"><a href="#cb42-991" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> combo2_tte_prior, <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb42-992"><a href="#cb42-992" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-993"><a href="#cb42-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-994"><a href="#cb42-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-997"><a href="#cb42-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-998"><a href="#cb42-998" aria-hidden="true" tabindex="-1"></a>combo2_dose_ref_data <span class="ot">&lt;-</span> dose_ref_data <span class="sc">|&gt;</span> </span>
<span id="cb42-999"><a href="#cb42-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dose_B =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-1000"><a href="#cb42-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_std_dose_col</span>(<span class="at">drug =</span> <span class="st">"B"</span>, <span class="at">dref =</span> <span class="dv">1</span>)</span>
<span id="cb42-1001"><a href="#cb42-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1002"><a href="#cb42-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1003"><a href="#cb42-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1006"><a href="#cb42-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1007"><a href="#cb42-1007" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="ot">&lt;-</span> combo2_dose_ref_data <span class="sc">|&gt;</span></span>
<span id="cb42-1008"><a href="#cb42-1008" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_risk_rvars</span>(combo2_tte_brms_model, cycle, schedule_id)</span>
<span id="cb42-1009"><a href="#cb42-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1010"><a href="#cb42-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1013"><a href="#cb42-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1014"><a href="#cb42-1014" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="sc">|&gt;</span></span>
<span id="cb42-1015"><a href="#cb42-1015" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(cprob)) <span class="sc">|&gt;</span></span>
<span id="cb42-1016"><a href="#cb42-1016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>prob, <span class="sc">-</span>cprob) <span class="sc">|&gt;</span></span>
<span id="cb42-1017"><a href="#cb42-1017" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span>
<span id="cb42-1018"><a href="#cb42-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1019"><a href="#cb42-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1022"><a href="#cb42-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1023"><a href="#cb42-1023" aria-hidden="true" tabindex="-1"></a>combo2_risk <span class="sc">|&gt;</span></span>
<span id="cb42-1024"><a href="#cb42-1024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">summarize_probs</span>(prob)) <span class="sc">|&gt;</span></span>
<span id="cb42-1025"><a href="#cb42-1025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cycle <span class="sc">==</span> <span class="dv">3</span>, ewoc_ok) <span class="sc">|&gt;</span> </span>
<span id="cb42-1026"><a href="#cb42-1026" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>num_toxicities, <span class="sc">-</span>std_A, <span class="sc">-</span>std_B, <span class="sc">-</span>prob, <span class="sc">-</span>cprob, <span class="sc">-</span>finite_A, <span class="sc">-</span>finite_B) <span class="sc">|&gt;</span></span>
<span id="cb42-1027"><a href="#cb42-1027" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">gt_format</span>()</span>
<span id="cb42-1028"><a href="#cb42-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1029"><a href="#cb42-1029" aria-hidden="true" tabindex="-1"></a>I.e., we can see that the highest dose that is safe according to the EWOC </span>
<span id="cb42-1030"><a href="#cb42-1030" aria-hidden="true" tabindex="-1"></a>criterion until the end of cycle 3 would be a dose of 10 for drug A.</span>
<span id="cb42-1031"><a href="#cb42-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1032"><a href="#cb42-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1033"><a href="#cb42-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1034"><a href="#cb42-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1035"><a href="#cb42-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix {#sec-onco-tte-appendix .appendix}</span></span>
<span id="cb42-1036"><a href="#cb42-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1037"><a href="#cb42-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model derivation {.appendix}</span></span>
<span id="cb42-1038"><a href="#cb42-1038" aria-hidden="true" tabindex="-1"></a>For each cycle $j$, we model the probability of observing a DLT event</span>
<span id="cb42-1039"><a href="#cb42-1039" aria-hidden="true" tabindex="-1"></a>conditional on entering cycle $j$ as a function of the dose $d_{j}$</span>
<span id="cb42-1040"><a href="#cb42-1040" aria-hidden="true" tabindex="-1"></a>being administered during this cycle.</span>
<span id="cb42-1041"><a href="#cb42-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1042"><a href="#cb42-1042" aria-hidden="true" tabindex="-1"></a>For each patient $i \in {1, \ldots, N}$, we observe either the DLT</span>
<span id="cb42-1043"><a href="#cb42-1043" aria-hidden="true" tabindex="-1"></a>event time $T_i$ or the censoring time $C_i$, whichever occurs</span>
<span id="cb42-1044"><a href="#cb42-1044" aria-hidden="true" tabindex="-1"></a>first. We denote this as <span class="co">&lt;!-- \unicode{x1D7D9} --&gt;</span></span>
<span id="cb42-1045"><a href="#cb42-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1046"><a href="#cb42-1046" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1047"><a href="#cb42-1047" aria-hidden="true" tabindex="-1"></a>(U_i, \delta_i), \textrm{ where } U_i = \min(T_i, C_i) \textrm{ and } \delta_i = 1(T_i \leq C_i).</span>
<span id="cb42-1048"><a href="#cb42-1048" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1049"><a href="#cb42-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1050"><a href="#cb42-1050" aria-hidden="true" tabindex="-1"></a>Here, $U_i$ represents the observed time, and $\delta_i$ indicates</span>
<span id="cb42-1051"><a href="#cb42-1051" aria-hidden="true" tabindex="-1"></a>whether a DLT occurred ($\delta_i = 1$) or not ($\delta_i = 0$).</span>
<span id="cb42-1052"><a href="#cb42-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1053"><a href="#cb42-1053" aria-hidden="true" tabindex="-1"></a>The primary focus of the model is the risk for DLT events over the</span>
<span id="cb42-1054"><a href="#cb42-1054" aria-hidden="true" tabindex="-1"></a>course of a sequence of cycles. Thus, we do not aim to model</span>
<span id="cb42-1055"><a href="#cb42-1055" aria-hidden="true" tabindex="-1"></a>accurately the risk for an event within each cycle. While one could</span>
<span id="cb42-1056"><a href="#cb42-1056" aria-hidden="true" tabindex="-1"></a>model the event and censoring times as interval censored observations,</span>
<span id="cb42-1057"><a href="#cb42-1057" aria-hidden="true" tabindex="-1"></a>we disregard here the interval censoring and use a continuous time</span>
<span id="cb42-1058"><a href="#cb42-1058" aria-hidden="true" tabindex="-1"></a>representation of the time to event process. The continuous time</span>
<span id="cb42-1059"><a href="#cb42-1059" aria-hidden="true" tabindex="-1"></a>representation can be understood as an approximation of the interval</span>
<span id="cb42-1060"><a href="#cb42-1060" aria-hidden="true" tabindex="-1"></a>censored process with time lapsing in full units of a cycle. As a</span>
<span id="cb42-1061"><a href="#cb42-1061" aria-hidden="true" tabindex="-1"></a>consequence, the observed event time $T_i$ and censoring times $C_i$</span>
<span id="cb42-1062"><a href="#cb42-1062" aria-hidden="true" tabindex="-1"></a>are always recorded at the planned cycle completion time-point (time</span>
<span id="cb42-1063"><a href="#cb42-1063" aria-hidden="true" tabindex="-1"></a>lapses in units of cycles). Here we assume for simplicity that each</span>
<span id="cb42-1064"><a href="#cb42-1064" aria-hidden="true" tabindex="-1"></a>cycle $j$ has the same duration $\Delta t$ such that any time being</span>
<span id="cb42-1065"><a href="#cb42-1065" aria-hidden="true" tabindex="-1"></a>recorded is a multiple of $\Delta t$ and we denote time $t$ being</span>
<span id="cb42-1066"><a href="#cb42-1066" aria-hidden="true" tabindex="-1"></a>during a cycle $j$ with $t \in ((j-1) \, \Delta t, j \, \Delta t]$ or</span>
<span id="cb42-1067"><a href="#cb42-1067" aria-hidden="true" tabindex="-1"></a>equivalently $t \in I_j$ for brevity.</span>
<span id="cb42-1068"><a href="#cb42-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1069"><a href="#cb42-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definitions from Survival Analysis {.appendix}</span></span>
<span id="cb42-1070"><a href="#cb42-1070" aria-hidden="true" tabindex="-1"></a>To define our model, we use the following basic definitions from</span>
<span id="cb42-1071"><a href="#cb42-1071" aria-hidden="true" tabindex="-1"></a>survival analysis. The survival function $S(t)$ and cumulative event</span>
<span id="cb42-1072"><a href="#cb42-1072" aria-hidden="true" tabindex="-1"></a>probability $F(t)$ are defined as</span>
<span id="cb42-1073"><a href="#cb42-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1074"><a href="#cb42-1074" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1075"><a href="#cb42-1075" aria-hidden="true" tabindex="-1"></a>S(t) := &amp; \Pr(\textrm{"No event up to time t"}) <span class="sc">\\</span></span>
<span id="cb42-1076"><a href="#cb42-1076" aria-hidden="true" tabindex="-1"></a> = &amp; \Pr(T \geq t) <span class="sc">\\</span></span>
<span id="cb42-1077"><a href="#cb42-1077" aria-hidden="true" tabindex="-1"></a> = &amp; 1 - F(t),</span>
<span id="cb42-1078"><a href="#cb42-1078" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1079"><a href="#cb42-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1080"><a href="#cb42-1080" aria-hidden="true" tabindex="-1"></a>where $F(t) = \Pr(T &lt; t)$. The respective event densities $s(t)$ and $f(t)$ are</span>
<span id="cb42-1081"><a href="#cb42-1081" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1082"><a href="#cb42-1082" aria-hidden="true" tabindex="-1"></a>s(t) = \frac{d}{dt}S(t) </span>
<span id="cb42-1083"><a href="#cb42-1083" aria-hidden="true" tabindex="-1"></a>     = \frac{d}{dt} \int_t^\infty f(u) du </span>
<span id="cb42-1084"><a href="#cb42-1084" aria-hidden="true" tabindex="-1"></a>     = \frac{d}{dt}<span class="co">[</span><span class="ot">1 - F(t)</span><span class="co">]</span> </span>
<span id="cb42-1085"><a href="#cb42-1085" aria-hidden="true" tabindex="-1"></a>     = -f(t)</span>
<span id="cb42-1086"><a href="#cb42-1086" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1087"><a href="#cb42-1087" aria-hidden="true" tabindex="-1"></a>The hazard function $h(t)$ is defined as</span>
<span id="cb42-1088"><a href="#cb42-1088" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1089"><a href="#cb42-1089" aria-hidden="true" tabindex="-1"></a>h(t) := \lim_{\Delta t \rightarrow 0}\frac{\Pr(t \leq T &lt; t + \Delta t)}{\Delta t \cdot S(t)} </span>
<span id="cb42-1090"><a href="#cb42-1090" aria-hidden="true" tabindex="-1"></a>= \lim_{\Delta t \rightarrow 0}\frac{S(t) - S(t + \Delta t)}{\Delta t \cdot S(t)} </span>
<span id="cb42-1091"><a href="#cb42-1091" aria-hidden="true" tabindex="-1"></a>= \frac{f(t)}{S(t)} = -\frac{s(t)}{S(t)}</span>
<span id="cb42-1092"><a href="#cb42-1092" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1093"><a href="#cb42-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1094"><a href="#cb42-1094" aria-hidden="true" tabindex="-1"></a>and the cumulative hazard function $H(t)$ is given by</span>
<span id="cb42-1095"><a href="#cb42-1095" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1096"><a href="#cb42-1096" aria-hidden="true" tabindex="-1"></a>H(t) = \int_0^t h(u) du = -\log(S(t)).</span>
<span id="cb42-1097"><a href="#cb42-1097" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1098"><a href="#cb42-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1099"><a href="#cb42-1099" aria-hidden="true" tabindex="-1"></a>We now have two quantities that are of particular interest:</span>
<span id="cb42-1100"><a href="#cb42-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1101"><a href="#cb42-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The cumulative DLT probability up to cycle $j$ given a prescribed</span>
<span id="cb42-1102"><a href="#cb42-1102" aria-hidden="true" tabindex="-1"></a>   dosing $\boldsymbol{d} = (d_{1}, d_{2}, d_{3})$ over the three</span>
<span id="cb42-1103"><a href="#cb42-1103" aria-hidden="true" tabindex="-1"></a>   cycles: $$\Pr(\textrm{"DLT up to cycle j"}|\boldsymbol{d}) =</span>
<span id="cb42-1104"><a href="#cb42-1104" aria-hidden="true" tabindex="-1"></a>   F(t).$$</span>
<span id="cb42-1105"><a href="#cb42-1105" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb42-1106"><a href="#cb42-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The conditional DLT probability of cycle $j$ given survival up to cycle $j-1$ (i.e., not having observed a DLT event up to the end of cycle $j-1$):</span>
<span id="cb42-1107"><a href="#cb42-1107" aria-hidden="true" tabindex="-1"></a>   \begin{align*}</span>
<span id="cb42-1108"><a href="#cb42-1108" aria-hidden="true" tabindex="-1"></a>      \, &amp;  \Pr(\textrm{"DLT in cycle j"}|\textrm{"No DLT up to cycle j-1"}, d_j) <span class="sc">\\</span></span>
<span id="cb42-1109"><a href="#cb42-1109" aria-hidden="true" tabindex="-1"></a>    = \, &amp;  \Pr(T \leq t + \Delta t|T &gt; t, d_j)<span class="sc">\\</span></span>
<span id="cb42-1110"><a href="#cb42-1110" aria-hidden="true" tabindex="-1"></a>    = \, &amp;  1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right).</span>
<span id="cb42-1111"><a href="#cb42-1111" aria-hidden="true" tabindex="-1"></a>   \end{align*}</span>
<span id="cb42-1112"><a href="#cb42-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1113"><a href="#cb42-1113" aria-hidden="true" tabindex="-1"></a>In the following, we will also use the complementary log-log link $\mathrm{cloglog}$, as well as its inverse $\mathrm{cloglog}^{-1}:$</span>
<span id="cb42-1114"><a href="#cb42-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1115"><a href="#cb42-1115" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-1116"><a href="#cb42-1116" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}(x) :=&amp;\ \log(-\log(1 - x)), \textrm{ and} <span class="sc">\\</span></span>
<span id="cb42-1117"><a href="#cb42-1117" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}^{-1}(y) =&amp;\ 1 - \exp(-\exp(y)). </span>
<span id="cb42-1118"><a href="#cb42-1118" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-1119"><a href="#cb42-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1120"><a href="#cb42-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model definition {.appendix}</span></span>
<span id="cb42-1121"><a href="#cb42-1121" aria-hidden="true" tabindex="-1"></a>Given the drug dose $d_{j}$ administered in cycle $j$, we model the log-hazard $\log(h_j(t|\tilde{d}_{j}))$ as </span>
<span id="cb42-1122"><a href="#cb42-1122" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1123"><a href="#cb42-1123" aria-hidden="true" tabindex="-1"></a>\log(h_j(t|\tilde{d}_{j})) = \alpha + \beta \log\left(\tilde{d}_{j}\right), \textrm{ where } \tilde{d}_{j} = \frac{d_{j}}{\tilde{d}}</span>
<span id="cb42-1124"><a href="#cb42-1124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1125"><a href="#cb42-1125" aria-hidden="true" tabindex="-1"></a>and $\tilde{d}$ is the reference dose. The conditional DLT probability over 1 cycle in this model is then</span>
<span id="cb42-1126"><a href="#cb42-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1127"><a href="#cb42-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1128"><a href="#cb42-1128" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-1129"><a href="#cb42-1129" aria-hidden="true" tabindex="-1"></a>\Pr(T \leq t + \Delta t|T &gt; t, \tilde{d}_{j}) &amp; = 1 - \exp\left(-\int_{t}^{t + \Delta t} h(u) du \right)<span class="sc">\\</span></span>
<span id="cb42-1130"><a href="#cb42-1130" aria-hidden="true" tabindex="-1"></a>&amp; = 1 - \exp\left(-\int_{t}^{t + \Delta t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right)\right) du \right) <span class="sc">\\</span></span>
<span id="cb42-1131"><a href="#cb42-1131" aria-hidden="true" tabindex="-1"></a>&amp; = 1 - \exp\left(-\Delta t \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right)\right) \right) <span class="sc">\\</span></span>
<span id="cb42-1132"><a href="#cb42-1132" aria-hidden="true" tabindex="-1"></a>&amp; = 1 - \exp\left(-\exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right) \right).</span>
<span id="cb42-1133"><a href="#cb42-1133" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-1134"><a href="#cb42-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1135"><a href="#cb42-1135" aria-hidden="true" tabindex="-1"></a>This is closely related to the classic two-parameter Bayesian Logistic</span>
<span id="cb42-1136"><a href="#cb42-1136" aria-hidden="true" tabindex="-1"></a>Regression Model (BLRM), since the conditional probability of</span>
<span id="cb42-1137"><a href="#cb42-1137" aria-hidden="true" tabindex="-1"></a>observing a DLT,</span>
<span id="cb42-1138"><a href="#cb42-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1139"><a href="#cb42-1139" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-1140"><a href="#cb42-1140" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}\Pr(T \leq t + \Delta t|T &gt; t, d_j) &amp; = \alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t),</span>
<span id="cb42-1141"><a href="#cb42-1141" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-1142"><a href="#cb42-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1143"><a href="#cb42-1143" aria-hidden="true" tabindex="-1"></a>is the same as for the BLRM in cycle one if we elapse time in cycles</span>
<span id="cb42-1144"><a href="#cb42-1144" aria-hidden="true" tabindex="-1"></a>(then $\Delta t = 1$ and the $\log(\Delta t)$ is zero), except for the</span>
<span id="cb42-1145"><a href="#cb42-1145" aria-hidden="true" tabindex="-1"></a>link function changing from $\mathrm{logit}$ to $\mathrm{cloglog}$.</span>
<span id="cb42-1146"><a href="#cb42-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1147"><a href="#cb42-1147" aria-hidden="true" tabindex="-1"></a>The cumulative DLT probability can also be derived, where $j_t$ is the</span>
<span id="cb42-1148"><a href="#cb42-1148" aria-hidden="true" tabindex="-1"></a>index of the cycle that time $t$ lies in:</span>
<span id="cb42-1149"><a href="#cb42-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1150"><a href="#cb42-1150" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-1151"><a href="#cb42-1151" aria-hidden="true" tabindex="-1"></a>\mathrm{cloglog}\Pr(T \leq t|\boldsymbol{d}) &amp; = \log\left(\sum_{j = 1}^{j_t} \exp\left(\alpha + \beta \log\left(\tilde{d}_{j}\right) + \log(\Delta t)\right)\right) = \mathrm{cloglog} F(t|\boldsymbol{d}).</span>
<span id="cb42-1152"><a href="#cb42-1152" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-1153"><a href="#cb42-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1154"><a href="#cb42-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1155"><a href="#cb42-1155" aria-hidden="true" tabindex="-1"></a>Last, but not least, the likelihood for all patients $i$ is then</span>
<span id="cb42-1156"><a href="#cb42-1156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1157"><a href="#cb42-1157" aria-hidden="true" tabindex="-1"></a>L(U|\alpha, \beta) = \prod_i \underbrace{ f(T_i)^{\delta_i} }_\textrm{DLT</span>
<span id="cb42-1158"><a href="#cb42-1158" aria-hidden="true" tabindex="-1"></a> events} \, \underbrace{S(C_i)^{1 - \delta_i}}_\textrm{Survival</span>
<span id="cb42-1159"><a href="#cb42-1159" aria-hidden="true" tabindex="-1"></a> events} \,,</span>
<span id="cb42-1160"><a href="#cb42-1160" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1161"><a href="#cb42-1161" aria-hidden="true" tabindex="-1"></a>and the log-likelihood</span>
<span id="cb42-1162"><a href="#cb42-1162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-1163"><a href="#cb42-1163" aria-hidden="true" tabindex="-1"></a>LL(U|\alpha, \beta) = \underbrace{\sum_i \log\left(f(T_i)\right) \delta_i}_\textrm{DLT</span>
<span id="cb42-1164"><a href="#cb42-1164" aria-hidden="true" tabindex="-1"></a> events} + \underbrace{\sum_i \log\left(S(C_i)\right)\left(1 - \delta_i\right)}_\textrm{Survival</span>
<span id="cb42-1165"><a href="#cb42-1165" aria-hidden="true" tabindex="-1"></a> events} \,.</span>
<span id="cb42-1166"><a href="#cb42-1166" aria-hidden="true" tabindex="-1"></a>$$</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Novartis/bamdd/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>